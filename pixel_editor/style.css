@import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap');

:root {
    --bg-app: #1e1e1e;
    --bg-panel: #252526;
    --bg-header: #333333;
    --bg-input: #3c3c3c;
    --bg-hover: #2a2d2e;
    --bg-active: #094771;
    --bg-selected: #37373d;
    --border-color: #454545;
    --text-main: #cccccc;
    --text-muted: #858585;
    --accent-color: #007acc;
    --danger-color: #ce4949;
    --success-color: #388a34;
    --grid-line: rgba(255, 255, 255, 0.05);
}

* { box-sizing: border-box; }

body { margin: 0; padding: 0; height: 100vh; background-color: var(--bg-app); color: var(--text-main); font-family: 'Inter', 'Segoe UI', sans-serif; overflow: hidden; user-select: none; font-size: 13px; }

.app-container { display: flex; flex-direction: column; height: 100%; }
.main-workspace { display: flex; flex: 1; overflow: hidden; }

.app-header { height: 35px; background-color: var(--bg-header); border-bottom: 1px solid #000; display: flex; align-items: center; justify-content: space-between; padding: 0 15px; }
.header-left { display: flex; align-items: center; gap: 8px; }
.app-icon { font-size: 18px; color: var(--accent-color); }
.app-title { font-weight: 600; font-size: 14px; color: #fff; }
.hint { font-size: 11px; color: var(--text-muted); }

.toolbar { width: 48px; background-color: var(--bg-header); border-right: 1px solid #000; display: flex; flex-direction: column; align-items: center; padding: 10px 0; gap: 10px; z-index: 50; }
.tool-group { display: flex; flex-direction: column; gap: 4px; width: 100%; align-items: center; }
.tool-separator { height: 1px; width: 20px; background: var(--border-color); margin: 2px 0; }
.tool-spacer { flex: 1; }

.tool-btn { width: 32px; height: 32px; background: transparent; border: none; color: var(--text-muted); border-radius: 4px; cursor: pointer; display: flex; justify-content: center; align-items: center; transition: all 0.1s; }
.tool-btn i { font-size: 20px; }
.tool-btn:hover { background-color: var(--bg-hover); color: #fff; }
.tool-btn.active { background-color: var(--bg-selected); color: var(--accent-color); border-left: 2px solid var(--accent-color); }

.canvas-viewport { flex: 1; background-color: #121212; position: relative; display: flex; justify-content: center; align-items: center; overflow: hidden; }
.canvas-viewport.edit-bg-mode { cursor: move; }
.canvas-viewport.edit-bg-mode #canvasContainer { opacity: 0.7; pointer-events: none; }

.canvas-bg-pattern { position: absolute; width: 100%; height: 100%; background-image: radial-gradient(#333 1px, transparent 1px); background-size: 20px 20px; opacity: 0.5; z-index: 0; pointer-events: none; }
#bgCanvas { position: absolute; top:0; left:0; width:100%; height:100%; pointer-events:none; }

.canvas-wrapper { position: relative; z-index: 10; transition: opacity 0.2s; }
.shadow-box { box-shadow: 0 0 0 1px #000, 0 10px 30px rgba(0,0,0,0.5); }

#mainCanvas { position: absolute; width: 100%; height: 100%; image-rendering: pixelated; z-index: 11; }
#gridOverlay { position: absolute; width: 100%; height: 100%; background-image: linear-gradient(to right, var(--grid-line) 1px, transparent 1px), linear-gradient(to bottom, var(--grid-line) 1px, transparent 1px); pointer-events: none; z-index: 12; }
#uiCanvas { position: absolute; width: 100%; height: 100%; z-index: 20; pointer-events: none; }

.sidebar-panels { width: 280px; background-color: var(--bg-panel); border-left: 1px solid #000; display: flex; flex-direction: column; overflow-y: auto; z-index: 50; }
.panel-section { border-bottom: 1px solid #000; padding: 10px; }
.panel-section.flex-grow { flex: 1; display: flex; flex-direction: column; min-height: 200px; }
.panel-header { font-size: 11px; font-weight: 600; text-transform: uppercase; letter-spacing: 0.5px; color: var(--text-muted); margin-bottom: 8px; display: flex; justify-content: space-between; align-items: center; }

button { font-family: inherit; }
.full-width-btn { width: 100%; background: var(--bg-input); border: 1px solid var(--border-color); color: #fff; padding: 6px; border-radius: 3px; cursor: pointer; }
.full-width-btn:hover { background: var(--bg-hover); }
.toggle-btn.active { background: var(--accent-color); border-color: var(--accent-color); }

.icon-btn-sm { background: transparent; border: none; color: #fff; cursor: pointer; padding: 2px; border-radius: 3px; }
.icon-btn-sm:hover { background: var(--bg-hover); }

.layer-list-container { flex: 1; background: var(--bg-input); border: 1px solid var(--border-color); border-radius: 4px; overflow-y: auto; }
.layer-list { padding: 0; margin: 0; list-style: none; }
.layer-item { display: flex; align-items: center; padding: 6px 8px; border-bottom: 1px solid rgba(0,0,0,0.2); cursor: pointer; font-size: 12px; }
.layer-item:hover { background: var(--bg-hover); }
.layer-item.active { background: var(--bg-active); color: #fff; }
.layer-vis { color: var(--text-muted); margin-right: 8px; font-size: 16px; width: 20px; text-align: center; }
.layer-vis:hover { color: #fff; }
.layer-vis.hidden { opacity: 0.3; }
.layer-name { flex: 1; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
.layer-del { opacity: 0; font-size: 16px; color: var(--text-muted); }
.layer-item:hover .layer-del { opacity: 1; }
.layer-del:hover { color: var(--danger-color); }

.preview-wrapper { display: flex; justify-content: center; align-items: center; background: #111; border: 1px solid var(--border-color); padding: 15px; border-radius: 4px; background-image: conic-gradient(#333 0.25turn, transparent 0.25turn 0.5turn, #333 0.5turn 0.75turn, transparent 0.75turn); background-size: 10px 10px; }
#previewCanvas { width: 100%; max-width: 128px; image-rendering: pixelated; }

.color-control { display: flex; align-items: center; gap: 10px; background: var(--bg-input); padding: 5px; border-radius: 4px; border: 1px solid var(--border-color); }
input[type="color"] { border: none; background: none; width: 40px; height: 25px; cursor: pointer; padding: 0; }
.hex-label { font-family: monospace; color: var(--text-main); }

.control-grid { display: flex; flex-direction: column; gap: 8px; }
.slider-group { display: flex; align-items: center; gap: 10px; font-size: 11px; }
input[type="range"] { flex: 1; height: 4px; background: #555; border-radius: 2px; -webkit-appearance: none; }
input[type="range"]::-webkit-slider-thumb { -webkit-appearance: none; width: 12px; height: 12px; background: #fff; border-radius: 50%; cursor: pointer; }

.row-center { display: flex; justify-content: space-between; align-items: center; }
.checkbox-label { display: flex; align-items: center; gap: 5px; font-size: 12px; cursor: pointer; }
.text-btn { background: none; border: none; color: var(--text-muted); cursor: pointer; text-decoration: underline; font-size: 11px; }
.text-btn:hover { color: #fff; }
.text-btn.danger:hover { color: var(--danger-color); }

.input-group { display: flex; gap: 5px; }
.input-group input { flex: 1; background: var(--bg-input); border: 1px solid var(--border-color); color: #fff; padding: 5px; border-radius: 3px; }
.icon-btn-primary { background: var(--accent-color); border: none; color: #fff; border-radius: 3px; width: 30px; cursor: pointer; display: flex; align-items: center; justify-content: center; }
.file-list { margin: 5px 0; padding: 0; list-style: none; background: var(--bg-input); border: 1px solid var(--border-color); border-radius: 4px; height: 100px; overflow-y: auto; }
.file-list li { padding: 6px 10px; border-bottom: 1px solid rgba(0,0,0,0.1); display: flex; justify-content: space-between; font-size: 12px; cursor: pointer; }
.file-list li:hover { background: var(--bg-hover); }

.export-actions { display: flex; gap: 5px; margin-top: 5px; }
.action-btn { flex: 1; border: none; padding: 6px; font-size: 11px; border-radius: 3px; cursor: pointer; color: #fff; text-align: center; }
.action-btn.success { background: var(--success-color); }
.action-btn.secondary { background: #6a4c9c; display: block; }

.palette-window { position: absolute; bottom: 20px; left: 70px; width: 220px; background: var(--bg-panel); border: 1px solid #000; box-shadow: 0 5px 20px rgba(0,0,0,0.5); border-radius: 4px; z-index: 200; }
.panel-box .panel-header { background: #333; padding: 5px 10px; border-radius: 3px 3px 0 0; cursor: move; }
.mode-switch { display: flex; gap: 2px; }
.mode-btn { background: #444; border: none; color: #aaa; font-size: 10px; padding: 2px 6px; cursor: pointer; }
.mode-btn.active { background: var(--accent-color); color: #fff; }
.palette-body { padding: 10px; background: #222; display: flex; justify-content: center; }
#paletteCanvas { background: #fff; cursor: crosshair; border: 1px solid #555; }
.panel-footer { display: flex; justify-content: flex-end; padding: 5px; gap: 5px; background: #333; border-radius: 0 0 3px 3px; }
.icon-btn { background: transparent; border: 1px solid #555; color: #ccc; width: 24px; height: 24px; display: flex; align-items: center; justify-content: center; border-radius: 3px; cursor: pointer; }
.icon-btn:hover { background: #444; color: #fff; }
.icon-btn.danger:hover { background: var(--danger-color); border-color: var(--danger-color); }

.zoom-panel { position: absolute; bottom: 20px; right: 20px; background: #333; padding: 4px 8px; border-radius: 20px; display: flex; gap: 8px; align-items: center; box-shadow: 0 2px 10px rgba(0,0,0,0.3); z-index: 100; }
.zoom-panel button { background: none; border: none; color: #fff; cursor: pointer; display: flex; align-items: center; }
.zoom-panel span { font-size: 12px; min-width: 40px; text-align: center; }