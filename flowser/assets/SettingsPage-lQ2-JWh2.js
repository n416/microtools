import{C as e,D as t,_ as n,d as r,f as i,k as a,m as o,o as s,p as c,r as l,t as u}from"./Header-D2_cX4r4.js";import{i as d,n as f,r as p,t as m}from"./RadioGroup-DYoSchgJ.js";import{i as h,t as g}from"./geminiApiClient-CLzk0lO9.js";import{$ as _,Lt as v,Ot as y,Q as b,Vt as x,X as S,Y as C,Z as w,_t as T,gt as E,lt as D,nt as O,rt as k,vt as A}from"./index-DfSAp0TU.js";function j(e){return T(`MuiSwitch`,e)}var M=E(`MuiSwitch`,[`root`,`edgeStart`,`edgeEnd`,`switchBase`,`colorPrimary`,`colorSecondary`,`sizeSmall`,`sizeMedium`,`checked`,`disabled`,`input`,`thumb`,`track`]),N=x(v()),P=x(y()),F=e=>{let{classes:t,edge:n,size:r,color:i,checked:a,disabled:o}=e,s={root:[`root`,n&&`edge${O(n)}`,`size${O(r)}`],switchBase:[`switchBase`,`color${O(i)}`,a&&`checked`,o&&`disabled`],thumb:[`thumb`],track:[`track`],input:[`input`]},c=D(s,j,t);return{...t,...c}},I=k(`span`,{name:`MuiSwitch`,slot:`Root`,overridesResolver:(e,t)=>{let{ownerState:n}=e;return[t.root,n.edge&&t[`edge${O(n.edge)}`],t[`size${O(n.size)}`]]}})({display:`inline-flex`,width:58,height:38,overflow:`hidden`,padding:12,boxSizing:`border-box`,position:`relative`,flexShrink:0,zIndex:0,verticalAlign:`middle`,"@media print":{colorAdjust:`exact`},variants:[{props:{edge:`start`},style:{marginLeft:-8}},{props:{edge:`end`},style:{marginRight:-8}},{props:{size:`small`},style:{width:40,height:24,padding:7,[`& .${M.thumb}`]:{width:16,height:16},[`& .${M.switchBase}`]:{padding:4,[`&.${M.checked}`]:{transform:`translateX(16px)`}}}}]}),L=k(h,{name:`MuiSwitch`,slot:`SwitchBase`,overridesResolver:(e,t)=>{let{ownerState:n}=e;return[t.switchBase,{[`& .${M.input}`]:t.input},n.color!==`default`&&t[`color${O(n.color)}`]]}})(_(({theme:e})=>({position:`absolute`,top:0,left:0,zIndex:1,color:e.vars?e.vars.palette.Switch.defaultColor:`${e.palette.mode===`light`?e.palette.common.white:e.palette.grey[300]}`,transition:e.transitions.create([`left`,`transform`],{duration:e.transitions.duration.shortest}),[`&.${M.checked}`]:{transform:`translateX(20px)`},[`&.${M.disabled}`]:{color:e.vars?e.vars.palette.Switch.defaultDisabledColor:`${e.palette.mode===`light`?e.palette.grey[100]:e.palette.grey[600]}`},[`&.${M.checked} + .${M.track}`]:{opacity:.5},[`&.${M.disabled} + .${M.track}`]:{opacity:e.vars?e.vars.opacity.switchTrackDisabled:`${e.palette.mode===`light`?.12:.2}`},[`& .${M.input}`]:{left:`-100%`,width:`300%`}})),_(({theme:e})=>({"&:hover":{backgroundColor:e.alpha((e.vars||e).palette.action.active,(e.vars||e).palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:`transparent`}},variants:[...Object.entries(e.palette).filter(w([`light`])).map(([t])=>({props:{color:t},style:{[`&.${M.checked}`]:{color:(e.vars||e).palette[t].main,"&:hover":{backgroundColor:e.alpha((e.vars||e).palette[t].main,(e.vars||e).palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:`transparent`}},[`&.${M.disabled}`]:{color:e.vars?e.vars.palette.Switch[`${t}DisabledColor`]:`${e.palette.mode===`light`?e.lighten(e.palette[t].main,.62):e.darken(e.palette[t].main,.55)}`}},[`&.${M.checked} + .${M.track}`]:{backgroundColor:(e.vars||e).palette[t].main}}}))]}))),R=k(`span`,{name:`MuiSwitch`,slot:`Track`})(_(({theme:e})=>({height:`100%`,width:`100%`,borderRadius:14/2,zIndex:-1,transition:e.transitions.create([`opacity`,`background-color`],{duration:e.transitions.duration.shortest}),backgroundColor:e.vars?e.vars.palette.common.onBackground:`${e.palette.mode===`light`?e.palette.common.black:e.palette.common.white}`,opacity:e.vars?e.vars.opacity.switchTrack:`${e.palette.mode===`light`?.38:.3}`}))),z=k(`span`,{name:`MuiSwitch`,slot:`Thumb`})(_(({theme:e})=>({boxShadow:(e.vars||e).shadows[1],backgroundColor:`currentColor`,width:20,height:20,borderRadius:`50%`}))),B=N.forwardRef(function(e,n){let r=b({props:e,name:`MuiSwitch`}),{className:i,color:a=`primary`,edge:o=!1,size:s=`medium`,sx:c,slots:l={},slotProps:u={},...d}=r,f={...r,color:a,edge:o,size:s},p=F(f),m={slots:l,slotProps:u},[h,g]=t(`root`,{className:A(p.root,i),elementType:I,externalForwardedProps:m,ownerState:f,additionalProps:{sx:c}}),[_,v]=t(`thumb`,{className:p.thumb,elementType:z,externalForwardedProps:m,ownerState:f}),y=(0,P.jsx)(_,{...v}),[x,S]=t(`track`,{className:p.track,elementType:R,externalForwardedProps:m,ownerState:f});return(0,P.jsxs)(h,{...g,children:[(0,P.jsx)(L,{type:`checkbox`,icon:y,checkedIcon:y,ref:n,ownerState:f,...d,classes:{...p,root:p.switchBase},slots:{...l.switchBase&&{root:l.switchBase},...l.input&&{input:l.input}},slotProps:{...u.switchBase&&{root:typeof u.switchBase==`function`?u.switchBase(f):u.switchBase},input:{role:`switch`},...u.input&&{input:typeof u.input==`function`?u.input(f):u.input}}}),(0,P.jsx)(x,{...S})]})});function V(){let[t,h]=(0,N.useState)(``),[_,v]=(0,N.useState)(!1),[y,b]=(0,N.useState)(`confirm`),[x,w]=(0,N.useState)([]),[T,E]=(0,N.useState)(``),[D,O]=(0,N.useState)(!1),[k,A]=(0,N.useState)(null),j=(0,N.useCallback)(async e=>{if(e){O(!0),A(null),w([]);try{let t=(await g.listAvailableModels(e)).filter(e=>e.supportedGenerationMethods.includes(`generateContent`)&&e.name.includes(`pro`)&&!e.name.includes(`vision`));w(t),A(!0)}catch(e){console.error(`API connection test failed:`,e),A(!1),alert(`APIキーの検証に失敗しました: ${e.message}`)}finally{O(!1)}}},[]);(0,N.useEffect)(()=>{try{let e=localStorage.getItem(`geminiApiKey`)||``;h(e);let t=localStorage.getItem(`securityMode`);v(t?JSON.parse(t):!1);let n=localStorage.getItem(`branchResetBehavior`)||`confirm`;b(n);let r=localStorage.getItem(`geminiModelId`)||``;E(r),e&&j(e)}catch(e){console.error(`localStorageからの設定読み込みに失敗しました:`,e),h(``),v(!1),b(`confirm`),E(``)}},[j]);let M=e=>{let t=e.target.checked;v(t),localStorage.setItem(`securityMode`,JSON.stringify(t))},F=e=>{let t=e.target.value;b(t),localStorage.setItem(`branchResetBehavior`,t)},I=()=>{localStorage.setItem(`geminiApiKey`,t),localStorage.setItem(`geminiModelId`,T),alert(`設定を保存しました。`)};return(0,P.jsxs)(C,{sx:{display:`flex`,flexDirection:`column`,height:`100vh`,bgcolor:`background.default`},children:[(0,P.jsx)(C,{sx:{p:`0 24px`},children:(0,P.jsx)(u,{isLocked:!1})}),(0,P.jsx)(C,{sx:{flexGrow:1,p:`0 24px 24px 24px`,overflow:`auto`},children:(0,P.jsxs)(a,{sx:{p:3,maxWidth:800,mx:`auto`},children:[(0,P.jsx)(e,{variant:`h5`,gutterBottom:!0,children:`ユーザー設定`}),(0,P.jsx)(o,{sx:{my:2}}),(0,P.jsxs)(C,{sx:{my:3},children:[(0,P.jsx)(e,{variant:`h6`,gutterBottom:!0,children:`セキュリティ`}),(0,P.jsx)(d,{control:(0,P.jsx)(B,{checked:_,onChange:M}),label:`セキュリティモード`}),(0,P.jsx)(e,{variant:`body2`,color:`text.secondary`,children:`有効にすると、ブラウザのタブを切り替えるなど、アプリ画面からフォーカスが外れた際に自動で顧客リストがロックされます。デフォルトはOFFです。`})]}),(0,P.jsx)(C,{sx:{my:3},children:(0,P.jsxs)(c,{component:`fieldset`,children:[(0,P.jsx)(i,{component:`legend`,sx:{typography:`h6`,color:`text.primary`,mb:1},children:`分岐リセット設定`}),(0,P.jsx)(e,{variant:`body2`,color:`text.secondary`,sx:{mb:1},children:`分岐タスクで、一度選んだ選択肢を別のものに選び直した際のサブタスクの進捗の扱いを設定します。`}),(0,P.jsxs)(m,{"aria-label":`branch-reset-behavior`,name:`branch-reset-behavior-group`,value:y,onChange:F,children:[(0,P.jsx)(d,{value:`keep`,control:(0,P.jsx)(f,{}),label:`進捗を保持する（他の選択肢の進捗はクリアされません）`}),(0,P.jsx)(d,{value:`confirm`,control:(0,P.jsx)(f,{}),label:`毎回確認する（推奨）`}),(0,P.jsx)(d,{value:`clear`,control:(0,P.jsx)(f,{}),label:`自動でリセットする（以前の進捗は自動でクリアされます）`})]})]})}),(0,P.jsxs)(C,{sx:{my:3},children:[(0,P.jsx)(e,{variant:`h6`,gutterBottom:!0,children:`API連携`}),(0,P.jsx)(l,{label:`Gemini API Key`,variant:`outlined`,fullWidth:!0,value:t,onChange:e=>h(e.target.value),sx:{mb:1},type:`password`,placeholder:`お使いのAPIキーを入力してください`}),(0,P.jsx)(e,{variant:`body2`,color:`text.secondary`,sx:{mb:2},children:`AIフロー設計機能などを利用するために必要です。キーはブラウザ内にのみ保存されます。`}),(0,P.jsxs)(C,{sx:{display:`flex`,alignItems:`center`,gap:2,mb:2},children:[(0,P.jsx)(n,{variant:`outlined`,onClick:()=>j(t),disabled:D,children:D?(0,P.jsx)(S,{size:24}):`接続テスト & モデル読込`}),k===!0&&(0,P.jsx)(e,{color:`green`,children:`✅ 接続成功`}),k===!1&&(0,P.jsx)(e,{color:`error`,children:`❌ 接続失敗`})]}),(0,P.jsxs)(c,{fullWidth:!0,children:[(0,P.jsx)(r,{id:`model-select-label`,children:`使用するAIモデル`}),(0,P.jsx)(s,{labelId:`model-select-label`,id:`model-select`,value:T,label:`使用するAIモデル`,onChange:e=>E(e.target.value),children:x.map(e=>(0,P.jsxs)(p,{value:e.name,children:[e.displayName,` (`,e.name.replace(`models/`,``),`)`]},e.name))}),(0,P.jsx)(e,{variant:`body2`,color:`text.secondary`,sx:{mt:1},children:`接続テスト後に利用可能なモデルが表示されます。AI機能で利用したいモデルを選択してください。`})]})]}),(0,P.jsx)(C,{sx:{mt:4,textAlign:`right`},children:(0,P.jsx)(n,{variant:`contained`,color:`primary`,onClick:I,children:`設定を保存`})})]})})]})}var H=V;export{H as default};