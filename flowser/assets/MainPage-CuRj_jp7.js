import{n as e,t}from"./useThemeProps-B_1UfXHJ.js";import{A as n,E as r,L as i,P as a,T as o,_ as s,a as c,b as l,c as u,d,g as f,h as p,i as m,m as h,n as g,o as _,r as v,t as y,v as b,y as x}from"./Header-3kDjJZVl.js";import{n as S,t as C}from"./Divider-DQ9rOGDa.js";import{A as w,B as T,C as E,D,E as O,M as k,N as A,O as j,S as M,V as N,a as P,c as F,i as I,j as L,k as ee,l as R,m as z,r as B,t as V,u as H,w as te,x as U}from"./index-BQjP6qG0.js";var W=N(T()),G=N(A()),ne=O(),re=e(`div`,{name:`MuiStack`,slot:`Root`});function ie(e){return t({props:e,name:`MuiStack`,defaultTheme:ne})}function ae(e,t){let n=W.Children.toArray(e).filter(Boolean);return n.reduce((e,r,i)=>(e.push(r),i<n.length-1&&e.push(W.cloneElement(t,{key:`separator-${i}`})),e),[])}var oe=e=>({row:`Left`,"row-reverse":`Right`,column:`Top`,"column-reverse":`Bottom`})[e];const se=({ownerState:e,theme:t})=>{let n={display:`flex`,flexDirection:`column`,...ee({theme:t},L({values:e.direction,breakpoints:t.breakpoints.values}),e=>({flexDirection:e}))};if(e.spacing){let r=D(t),i=Object.keys(t.breakpoints.values).reduce((t,n)=>((typeof e.spacing==`object`&&e.spacing[n]!=null||typeof e.direction==`object`&&e.direction[n]!=null)&&(t[n]=!0),t),{}),a=L({values:e.direction,base:i}),o=L({values:e.spacing,base:i});typeof a==`object`&&Object.keys(a).forEach((e,t,n)=>{a[e]||(a[e]=t>0?a[n[t-1]]:`column`)}),n=k(n,ee({theme:t},o,(t,n)=>e.useFlexGap?{gap:j(r,t)}:{"& > :not(style):not(style)":{margin:0},"& > :not(style) ~ :not(style)":{[`margin${oe(n?a[n]:e.direction)}`]:j(r,t)}}))}return n=w(t.breakpoints,n),n};function ce(e={}){let{createStyledComponent:t=re,useThemeProps:n=ie,componentName:r=`MuiStack`}=e,i=()=>z({root:[`root`]},e=>M(r,e),{}),a=t(se);return W.forwardRef(function(e,t){let r=n(e),{component:o=`div`,direction:s=`column`,spacing:c=0,divider:l,children:u,className:d,useFlexGap:f=!1,...p}=te(r),m={direction:s,spacing:c,useFlexGap:f},h=i();return(0,G.jsx)(a,{as:o,ownerState:m,ref:t,className:E(h.root,d),...p,children:l?ae(u,l):u})})}var le=i((0,G.jsx)(`path`,{d:`M19 5v14H5V5h14m0-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z`}),`CheckBoxOutlineBlank`),ue=i((0,G.jsx)(`path`,{d:`M19 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.11 0 2-.9 2-2V5c0-1.1-.89-2-2-2zm-9 14l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z`}),`CheckBox`),de=i((0,G.jsx)(`path`,{d:`M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-2 10H7v-2h10v2z`}),`IndeterminateCheckBox`);function fe(e){return M(`MuiCheckbox`,e)}var K=U(`MuiCheckbox`,[`root`,`checked`,`disabled`,`indeterminate`,`colorPrimary`,`colorSecondary`,`sizeSmall`,`sizeMedium`]),pe=e=>{let{classes:t,indeterminate:n,color:r,size:i}=e,a={root:[`root`,n&&`indeterminate`,`color${F(r)}`,`size${F(i)}`]},o=z(a,fe,t);return{...t,...o}},me=R(S,{shouldForwardProp:e=>H(e)||e===`classes`,name:`MuiCheckbox`,slot:`Root`,overridesResolver:(e,t)=>{let{ownerState:n}=e;return[t.root,n.indeterminate&&t.indeterminate,t[`size${F(n.size)}`],n.color!==`default`&&t[`color${F(n.color)}`]]}})(P(({theme:e})=>({color:(e.vars||e).palette.text.secondary,variants:[{props:{color:`default`,disableRipple:!1},style:{"&:hover":{backgroundColor:e.alpha((e.vars||e).palette.action.active,(e.vars||e).palette.action.hoverOpacity)}}},...Object.entries(e.palette).filter(B()).map(([t])=>({props:{color:t,disableRipple:!1},style:{"&:hover":{backgroundColor:e.alpha((e.vars||e).palette[t].main,(e.vars||e).palette.action.hoverOpacity)}}})),...Object.entries(e.palette).filter(B()).map(([t])=>({props:{color:t},style:{[`&.${K.checked}, &.${K.indeterminate}`]:{color:(e.vars||e).palette[t].main},[`&.${K.disabled}`]:{color:(e.vars||e).palette.action.disabled}}})),{props:{disableRipple:!1},style:{"&:hover":{"@media (hover: none)":{backgroundColor:`transparent`}}}}]}))),he=(0,G.jsx)(ue,{}),ge=(0,G.jsx)(le,{}),_e=(0,G.jsx)(de,{}),ve=W.forwardRef(function(e,t){let n=I({props:e,name:`MuiCheckbox`}),{checkedIcon:r=he,color:i=`primary`,icon:a=ge,indeterminate:s=!1,indeterminateIcon:c=_e,inputProps:l,size:u=`medium`,disableRipple:d=!1,className:f,slots:p={},slotProps:m={},...h}=n,g=s?c:a,_=s?c:r,v={...n,disableRipple:d,color:i,indeterminate:s,size:u},y=pe(v),x=m.input??l,[S,C]=b(`root`,{ref:t,elementType:me,className:E(y.root,f),shouldForwardComponentProp:!0,externalForwardedProps:{slots:p,slotProps:m,...h},ownerState:v,additionalProps:{type:`checkbox`,icon:W.cloneElement(g,{fontSize:g.props.fontSize??u}),checkedIcon:W.cloneElement(_,{fontSize:_.props.fontSize??u}),disableRipple:d,slots:p,slotProps:{input:o(typeof x==`function`?x(v):x,{"data-indeterminate":s})}}});return(0,G.jsx)(S,{...C,classes:y})});function ye(e){return M(`MuiListItem`,e)}U(`MuiListItem`,[`root`,`container`,`dense`,`alignItemsFlexStart`,`divider`,`gutters`,`padding`,`secondaryAction`]);function be(e){return M(`MuiListItemButton`,e)}var q=U(`MuiListItemButton`,[`root`,`focusVisible`,`dense`,`alignItemsFlexStart`,`disabled`,`divider`,`gutters`,`selected`]);const xe=(e,t)=>{let{ownerState:n}=e;return[t.root,n.dense&&t.dense,n.alignItems===`flex-start`&&t.alignItemsFlexStart,n.divider&&t.divider,!n.disableGutters&&t.gutters]};var Se=e=>{let{alignItems:t,classes:n,dense:r,disabled:i,disableGutters:a,divider:o,selected:s}=e,c=z({root:[`root`,r&&`dense`,!a&&`gutters`,o&&`divider`,i&&`disabled`,t===`flex-start`&&`alignItemsFlexStart`,s&&`selected`]},be,n);return{...n,...c}},Ce=R(s,{shouldForwardProp:e=>H(e)||e===`classes`,name:`MuiListItemButton`,slot:`Root`,overridesResolver:xe})(P(({theme:e})=>({display:`flex`,flexGrow:1,justifyContent:`flex-start`,alignItems:`center`,position:`relative`,textDecoration:`none`,minWidth:0,boxSizing:`border-box`,textAlign:`left`,paddingTop:8,paddingBottom:8,transition:e.transitions.create(`background-color`,{duration:e.transitions.duration.shortest}),"&:hover":{textDecoration:`none`,backgroundColor:(e.vars||e).palette.action.hover,"@media (hover: none)":{backgroundColor:`transparent`}},[`&.${q.selected}`]:{backgroundColor:e.alpha((e.vars||e).palette.primary.main,(e.vars||e).palette.action.selectedOpacity),[`&.${q.focusVisible}`]:{backgroundColor:e.alpha((e.vars||e).palette.primary.main,`${(e.vars||e).palette.action.selectedOpacity} + ${(e.vars||e).palette.action.focusOpacity}`)}},[`&.${q.selected}:hover`]:{backgroundColor:e.alpha((e.vars||e).palette.primary.main,`${(e.vars||e).palette.action.selectedOpacity} + ${(e.vars||e).palette.action.hoverOpacity}`),"@media (hover: none)":{backgroundColor:e.alpha((e.vars||e).palette.primary.main,(e.vars||e).palette.action.selectedOpacity)}},[`&.${q.focusVisible}`]:{backgroundColor:(e.vars||e).palette.action.focus},[`&.${q.disabled}`]:{opacity:(e.vars||e).palette.action.disabledOpacity},variants:[{props:({ownerState:e})=>e.divider,style:{borderBottom:`1px solid ${(e.vars||e).palette.divider}`,backgroundClip:`padding-box`}},{props:{alignItems:`flex-start`},style:{alignItems:`flex-start`}},{props:({ownerState:e})=>!e.disableGutters,style:{paddingLeft:16,paddingRight:16}},{props:({ownerState:e})=>e.dense,style:{paddingTop:4,paddingBottom:4}}]}))),J=W.forwardRef(function(e,t){let i=I({props:e,name:`MuiListItemButton`}),{alignItems:a=`center`,autoFocus:o=!1,component:s=`div`,children:l,dense:u=!1,disableGutters:d=!1,divider:f=!1,focusVisibleClassName:p,selected:m=!1,className:h,...g}=i,_=W.useContext(c),v=W.useMemo(()=>({dense:u||_.dense||!1,alignItems:a,disableGutters:d}),[a,_.dense,u,d]),y=W.useRef(null);n(()=>{o&&y.current&&y.current.focus()},[o]);let b={...i,alignItems:a,dense:v.dense,disableGutters:d,divider:f,selected:m},x=Se(b),S=r(y,t);return(0,G.jsx)(c.Provider,{value:v,children:(0,G.jsx)(Ce,{ref:S,href:g.href||g.to,component:(g.href||g.to)&&s===`div`?`button`:s,focusVisibleClassName:E(x.focusVisible,p),ownerState:b,className:E(x.root,h),...g,classes:x,children:l})})});function we(e){return M(`MuiListItemSecondaryAction`,e)}U(`MuiListItemSecondaryAction`,[`root`,`disableGutters`]);var Te=e=>{let{disableGutters:t,classes:n}=e;return z({root:[`root`,t&&`disableGutters`]},we,n)},Ee=R(`div`,{name:`MuiListItemSecondaryAction`,slot:`Root`,overridesResolver:(e,t)=>{let{ownerState:n}=e;return[t.root,n.disableGutters&&t.disableGutters]}})({position:`absolute`,right:16,top:`50%`,transform:`translateY(-50%)`,variants:[{props:({ownerState:e})=>e.disableGutters,style:{right:0}}]}),De=W.forwardRef(function(e,t){let n=I({props:e,name:`MuiListItemSecondaryAction`}),{className:r,...i}=n,a=W.useContext(c),o={...n,disableGutters:a.disableGutters},s=Te(o);return(0,G.jsx)(Ee,{className:E(s.root,r),ownerState:o,ref:t,...i})});De.muiName=`ListItemSecondaryAction`;var Oe=De;const ke=(e,t)=>{let{ownerState:n}=e;return[t.root,n.dense&&t.dense,n.alignItems===`flex-start`&&t.alignItemsFlexStart,n.divider&&t.divider,!n.disableGutters&&t.gutters,!n.disablePadding&&t.padding,n.hasSecondaryAction&&t.secondaryAction]};var Ae=e=>{let{alignItems:t,classes:n,dense:r,disableGutters:i,disablePadding:a,divider:o,hasSecondaryAction:s}=e;return z({root:[`root`,r&&`dense`,!i&&`gutters`,!a&&`padding`,o&&`divider`,t===`flex-start`&&`alignItemsFlexStart`,s&&`secondaryAction`],container:[`container`]},ye,n)};const je=R(`div`,{name:`MuiListItem`,slot:`Root`,overridesResolver:ke})(P(({theme:e})=>({display:`flex`,justifyContent:`flex-start`,alignItems:`center`,position:`relative`,textDecoration:`none`,width:`100%`,boxSizing:`border-box`,textAlign:`left`,variants:[{props:({ownerState:e})=>!e.disablePadding,style:{paddingTop:8,paddingBottom:8}},{props:({ownerState:e})=>!e.disablePadding&&e.dense,style:{paddingTop:4,paddingBottom:4}},{props:({ownerState:e})=>!e.disablePadding&&!e.disableGutters,style:{paddingLeft:16,paddingRight:16}},{props:({ownerState:e})=>!e.disablePadding&&!!e.secondaryAction,style:{paddingRight:48}},{props:({ownerState:e})=>!!e.secondaryAction,style:{[`& > .${q.root}`]:{paddingRight:48}}},{props:{alignItems:`flex-start`},style:{alignItems:`flex-start`}},{props:({ownerState:e})=>e.divider,style:{borderBottom:`1px solid ${(e.vars||e).palette.divider}`,backgroundClip:`padding-box`}},{props:({ownerState:e})=>e.button,style:{transition:e.transitions.create(`background-color`,{duration:e.transitions.duration.shortest}),"&:hover":{textDecoration:`none`,backgroundColor:(e.vars||e).palette.action.hover,"@media (hover: none)":{backgroundColor:`transparent`}}}},{props:({ownerState:e})=>e.hasSecondaryAction,style:{paddingRight:48}}]})));var Me=R(`li`,{name:`MuiListItem`,slot:`Container`})({position:`relative`}),Ne=W.forwardRef(function(e,t){let n=I({props:e,name:`MuiListItem`}),{alignItems:i=`center`,children:o,className:s,component:l,components:u={},componentsProps:d={},ContainerComponent:f=`li`,ContainerProps:{className:p,...m}={},dense:h=!1,disableGutters:g=!1,disablePadding:_=!1,divider:v=!1,secondaryAction:y,slotProps:b={},slots:S={},...C}=n,w=W.useContext(c),T=W.useMemo(()=>({dense:h||w.dense||!1,alignItems:i,disableGutters:g}),[i,w.dense,h,g]),D=W.useRef(null),O=W.Children.toArray(o),k=O.length&&a(O[O.length-1],[`ListItemSecondaryAction`]),A={...n,alignItems:i,dense:T.dense,disableGutters:g,disablePadding:_,divider:v,hasSecondaryAction:k},j=Ae(A),M=r(D,t),N=S.root||u.Root||je,P=b.root||d.root||{},F={className:E(j.root,P.className,s),...C},L=l||`li`;return k?(L=!F.component&&!l?`div`:L,f===`li`&&(L===`li`?L=`div`:F.component===`li`&&(F.component=`div`)),(0,G.jsx)(c.Provider,{value:T,children:(0,G.jsxs)(Me,{as:f,className:E(j.container,p),ref:M,ownerState:A,...m,children:[(0,G.jsx)(N,{...P,...!x(N)&&{as:L,ownerState:{...A,...P.ownerState}},...F,children:O}),O.pop()]})})):(0,G.jsx)(c.Provider,{value:T,children:(0,G.jsxs)(N,{...P,as:L,ref:M,...!x(N)&&{ownerState:{...A,...P.ownerState}},...F,children:[O,y&&(0,G.jsx)(Oe,{children:y})]})})});function Pe(e){return M(`MuiListItemIcon`,e)}U(`MuiListItemIcon`,[`root`,`alignItemsFlexStart`]);var Fe=e=>{let{alignItems:t,classes:n}=e;return z({root:[`root`,t===`flex-start`&&`alignItemsFlexStart`]},Pe,n)},Ie=R(`div`,{name:`MuiListItemIcon`,slot:`Root`,overridesResolver:(e,t)=>{let{ownerState:n}=e;return[t.root,n.alignItems===`flex-start`&&t.alignItemsFlexStart]}})(P(({theme:e})=>({minWidth:56,color:(e.vars||e).palette.action.active,flexShrink:0,display:`inline-flex`,variants:[{props:{alignItems:`flex-start`},style:{marginTop:8}}]}))),Y=W.forwardRef(function(e,t){let n=I({props:e,name:`MuiListItemIcon`}),{className:r,...i}=n,a=W.useContext(c),o={...n,alignItems:a.alignItems},s=Fe(o);return(0,G.jsx)(Ie,{className:E(s.root,r),ownerState:o,ref:t,...i})});function Le(e){return M(`MuiListItemText`,e)}var X=U(`MuiListItemText`,[`root`,`multiline`,`dense`,`inset`,`primary`,`secondary`]),Re=e=>{let{classes:t,inset:n,primary:r,secondary:i,dense:a}=e;return z({root:[`root`,n&&`inset`,a&&`dense`,r&&i&&`multiline`],primary:[`primary`],secondary:[`secondary`]},Le,t)},ze=R(`div`,{name:`MuiListItemText`,slot:`Root`,overridesResolver:(e,t)=>{let{ownerState:n}=e;return[{[`& .${X.primary}`]:t.primary},{[`& .${X.secondary}`]:t.secondary},t.root,n.inset&&t.inset,n.primary&&n.secondary&&t.multiline,n.dense&&t.dense]}})({flex:`1 1 auto`,minWidth:0,marginTop:4,marginBottom:4,[`.${p.root}:where(& .${X.primary})`]:{display:`block`},[`.${p.root}:where(& .${X.secondary})`]:{display:`block`},variants:[{props:({ownerState:e})=>e.primary&&e.secondary,style:{marginTop:6,marginBottom:6}},{props:({ownerState:e})=>e.inset,style:{paddingLeft:56}}]}),Z=W.forwardRef(function(e,t){let n=I({props:e,name:`MuiListItemText`}),{children:r,className:i,disableTypography:a=!1,inset:o=!1,primary:s,primaryTypographyProps:l,secondary:u,secondaryTypographyProps:d,slots:f={},slotProps:p={},...m}=n,{dense:g}=W.useContext(c),_=s??r,v=u,y={...n,disableTypography:a,inset:o,primary:!!_,secondary:!!v,dense:g},x=Re(y),S={slots:f,slotProps:{primary:l,secondary:d,...p}},[C,w]=b(`root`,{className:E(x.root,i),elementType:ze,externalForwardedProps:{...S,...m},ownerState:y,ref:t}),[T,D]=b(`primary`,{className:x.primary,elementType:h,externalForwardedProps:S,ownerState:y}),[O,k]=b(`secondary`,{className:x.secondary,elementType:h,externalForwardedProps:S,ownerState:y});return _!=null&&_.type!==h&&!a&&(_=(0,G.jsx)(T,{variant:g?`body2`:`body1`,component:D?.variant?void 0:`span`,...D,children:_})),v!=null&&v.type!==h&&!a&&(v=(0,G.jsx)(O,{variant:`body2`,color:`textSecondary`,...k,children:v})),(0,G.jsxs)(C,{...w,children:[_,v]})}),Be=ce({createStyledComponent:R(`div`,{name:`MuiStack`,slot:`Root`}),useThemeProps:e=>I({props:e,name:`MuiStack`})}),Ve=R(l)({padding:`16px`,height:`100%`,overflow:`auto`}),Q={critical:{label:`要対応`,color:`error`},progress:{label:`対応中`,color:`warning`},success:{label:`完了`,color:`success`},new:{label:`新規`,color:`default`}};function He({customers:e,selectedCustomerId:t,onSelectCustomer:n}){return(0,G.jsxs)(Ve,{children:[(0,G.jsx)(h,{variant:`h6`,gutterBottom:!0,children:`顧客リスト`}),(0,G.jsx)(m,{children:e.map(e=>(0,G.jsxs)(J,{selected:t===e.id,onClick:()=>n(e.id),children:[(0,G.jsx)(Z,{primary:e.name,secondary:e.company}),Q[e.status]&&(0,G.jsx)(d,{label:Q[e.status].label,color:Q[e.status].color,size:`small`})]},e.id))})]})}var Ue=He,We=i((0,G.jsx)(`path`,{d:`M7.41 15.41 12 10.83l4.59 4.58L18 14l-6-6-6 6z`}),`KeyboardArrowUp`),Ge=i((0,G.jsx)(`path`,{d:`M7.41 8.59 12 13.17l4.59-4.58L18 10l-6 6-6-6z`}),`KeyboardArrowDown`),Ke=R(l)({padding:`16px`,flexShrink:0}),$={critical:{label:`要対応`,color:`error`},progress:{label:`対応中`,color:`warning`},success:{label:`完了`,color:`success`},new:{label:`新規`,color:`default`}};function qe({customer:e,assignedFlows:t,onUnassignFlow:n,onOpenModal:r}){let[i,a]=(0,W.useState)(!1);return e?(0,G.jsxs)(Ke,{children:[(0,G.jsxs)(V,{sx:{display:`flex`,justifyContent:`space-between`,alignItems:`center`},children:[(0,G.jsx)(h,{variant:`h6`,children:`顧客詳細`}),(0,G.jsx)(f,{onClick:()=>a(!i),size:`small`,children:i?(0,G.jsx)(Ge,{}):(0,G.jsx)(We,{})})]}),!i&&(0,G.jsxs)(V,{sx:{mt:1},children:[(0,G.jsx)(h,{variant:`h5`,children:e.name}),(0,G.jsx)(h,{variant:`body1`,children:e.company}),$[e.status]&&(0,G.jsx)(d,{label:$[e.status].label,color:$[e.status].color,sx:{mt:1}}),(0,G.jsx)(C,{sx:{my:2}}),(0,G.jsx)(h,{variant:`subtitle2`,gutterBottom:!0,children:`割り当て済みフロー`}),(0,G.jsx)(V,{sx:{display:`flex`,flexWrap:`wrap`,gap:1,mb:2},children:t&&t.length>0?t.map(e=>(0,G.jsx)(d,{label:e.name,onDelete:()=>n(e.id),color:`primary`,variant:`outlined`},e.id)):(0,G.jsx)(h,{variant:`body2`,color:`text.secondary`,children:`(なし)`})}),(0,G.jsx)(u,{variant:`contained`,onClick:r,children:`業務フローを割り当て`})]})]}):(0,G.jsx)(Ke,{children:(0,G.jsx)(h,{children:`顧客を選択してください`})})}var Je=qe,Ye=i((0,G.jsx)(`path`,{d:`M2 12.5C2 9.46 4.46 7 7.5 7H18c2.21 0 4 1.79 4 4s-1.79 4-4 4H9.5C8.12 15 7 13.88 7 12.5S8.12 10 9.5 10H17v2H9.41c-.55 0-.55 1 0 1H18c1.1 0 2-.9 2-2s-.9-2-2-2H7.5C5.57 9 4 10.57 4 12.5S5.57 16 7.5 16H17v2H7.5C4.46 18 2 15.54 2 12.5`}),`Attachment`),Xe=R(l)({padding:`16px`,display:`flex`,flexDirection:`column`,flexGrow:1,minHeight:0}),Ze=R(`div`)({width:`28px`,height:`28px`,borderRadius:`50%`,border:`2px solid #e53935`,color:`#e53935`,display:`flex`,alignItems:`center`,justifyContent:`center`,fontWeight:`bold`,fontSize:`14px`,transform:`rotate(-10deg)`,fontFamily:`"Helvetica Neue", Arial, sans-serif`});function Qe({assignedFlows:e,selectedWorkflowId:t,onSelectWorkflow:n,currentWorkflow:r,onSelectTask:i,selectedTaskId:a}){return!e||e.length===0?(0,G.jsxs)(Xe,{children:[(0,G.jsx)(h,{variant:`h6`,gutterBottom:!0,children:`🤖 業務フロー`}),(0,G.jsx)(V,{sx:{display:`flex`,alignItems:`center`,justifyContent:`center`,height:`100%`},children:(0,G.jsx)(h,{variant:`body2`,color:`text.secondary`,children:`この顧客には業務フローが割り当てられていません。`})})]}):(0,G.jsxs)(Xe,{children:[(0,G.jsx)(h,{variant:`h6`,gutterBottom:!0,children:`🤖 業務フロー`}),(0,G.jsx)(V,{sx:{borderBottom:1,borderColor:`divider`,mb:1},children:(0,G.jsx)(g,{value:t,onChange:(e,t)=>{n(t)},variant:`scrollable`,scrollButtons:`auto`,children:e.map(e=>(0,G.jsx)(v,{label:e.name,value:e.id},e.id))})}),(0,G.jsx)(V,{sx:{overflow:`auto`,flexGrow:1},children:r?(0,G.jsx)(m,{dense:!0,children:r.tasks.map(e=>{let t=`checkbox-list-label-${e.id}`;return(0,G.jsx)(Ne,{disablePadding:!0,children:(0,G.jsxs)(J,{selected:a===e.id,onClick:()=>i(e.id),sx:{p:`4px 8px`},children:[(0,G.jsx)(Y,{sx:{minWidth:40,height:28,alignItems:`center`,justifyContent:`center`},children:e.completed?(0,G.jsx)(Ze,{children:`済`}):(0,G.jsx)(V,{sx:{width:28}})}),(0,G.jsx)(Z,{id:t,primary:e.text}),e.documents&&e.documents.length>0&&(0,G.jsx)(Y,{sx:{minWidth:`auto`},children:(0,G.jsx)(Ye,{fontSize:`small`,color:`action`})})]})},`${r.id}-${e.id}`)})}):(0,G.jsx)(V,{sx:{display:`flex`,alignItems:`center`,justifyContent:`center`,height:`100%`},children:(0,G.jsx)(h,{variant:`body2`,color:`text.secondary`,children:`フローを選択してください。`})})})]})}var $e=Qe,et=i((0,G.jsx)(`path`,{d:`M18 15v3H6v-3H4v3c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2v-3zm-1-4-1.41-1.41L13 12.17V4h-2v8.17L8.41 9.59 7 11l5 5z`}),`FileDownloadOutlined`),tt=R(l)({padding:`16px`,height:`100%`,display:`flex`,flexDirection:`column`});function nt({task:e,onToggleDocument:t,onToggleTask:n}){return e?(0,G.jsxs)(tt,{children:[(0,G.jsxs)(V,{children:[(0,G.jsx)(h,{variant:`h6`,children:e.text}),(0,G.jsx)(C,{sx:{my:1}}),(0,G.jsxs)(J,{onClick:()=>n&&n(e.id),sx:{borderRadius:1,p:`4px 8px`},children:[(0,G.jsx)(Y,{sx:{minWidth:40},children:(0,G.jsx)(ve,{edge:`start`,checked:!!e.completed,tabIndex:-1,disableRipple:!0})}),(0,G.jsx)(Z,{primary:`このタスクを完了済みにする`})]})]}),(0,G.jsx)(C,{sx:{my:1}}),(0,G.jsxs)(V,{sx:{overflow:`auto`,flexGrow:1},children:[(0,G.jsx)(h,{variant:`body1`,sx:{my:2,whiteSpace:`pre-wrap`},children:e.details}),e.documents&&e.documents.length>0&&(0,G.jsxs)(V,{sx:{mt:2},children:[(0,G.jsx)(h,{variant:`subtitle2`,gutterBottom:!0,children:`関連書類`}),(0,G.jsx)(m,{dense:!0,children:e.documents.map(n=>(0,G.jsx)(Ne,{disablePadding:!0,secondaryAction:(0,G.jsx)(f,{edge:`end`,href:n.url,target:`_blank`,sx:{right:`8px`},children:(0,G.jsx)(et,{})}),children:(0,G.jsxs)(J,{onClick:()=>t(e.id,n.name),sx:{pr:`48px`},children:[(0,G.jsx)(Y,{children:(0,G.jsx)(ve,{edge:`start`,checked:n.checked,tabIndex:-1,disableRipple:!0})}),(0,G.jsx)(Z,{primary:n.name})]})},n.name))})]})]})]}):(0,G.jsx)(tt,{children:(0,G.jsx)(V,{sx:{display:`flex`,alignItems:`center`,justifyContent:`center`,height:`100%`},children:(0,G.jsx)(h,{variant:`body2`,color:`text.secondary`,children:`中央のリストからタスクを選択してください。`})})})}var rt=nt,it=i((0,G.jsx)(`path`,{d:`M22 3H7c-.69 0-1.23.35-1.59.88L0 12l5.41 8.11c.36.53.9.89 1.59.89h15c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2m0 16H7.07L2.4 12l4.66-7H22zm-11.59-2L14 13.41 17.59 17 19 15.59 15.41 12 19 8.41 17.59 7 14 10.59 10.41 7 9 8.41 12.59 12 9 15.59z`}),`BackspaceOutlined`),at=i((0,G.jsx)(`path`,{d:`M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z`}),`Clear`),ot=[{id:`wf001`,name:`【標準】新車販売フロー`,description:`新車のキャンピングカーを販売する際の標準的な業務フローです。`,tasks:[{id:1,text:`顧客要望ヒアリングと車種選定`,refId:`AI`,completed:!1,details:`顧客の利用用途、予算、希望装備などを詳しくヒアリングし、最適な車種を提案します。パンフレットやデモカーを活用します。`,documents:[{name:`車種カタログ.pdf`,url:`#`,checked:!1}]},{id:2,text:`見積書作成とオプション確認`,refId:`K001`,completed:!1,details:`選択された車種をベースに、追加オプション（ソーラーパネル、FFヒーター、ナビ等）を含めた正式な見積書を作成し、提示します。`},{id:3,text:`注文書作成と契約締結`,refId:`K002`,completed:!1,details:`見積内容に合意後、注文書を作成します。契約内容を丁寧に説明し、署名・捺印をいただきます。`,documents:[{name:`売買契約書テンプレート.docx`,url:`#`,checked:!1}]},{id:4,text:`納車前整備と最終点検`,refId:`K003`,completed:!1,details:`メーカーから車両が到着後、専門スタッフがオプションの取り付け、内外装の最終チェック、清掃を行います。`},{id:5,text:`納車および操作説明`,refId:`AI`,completed:!1,details:`顧客に来店いただき、車両の最終確認を行います。各種装備の詳しい操作方法を実演しながら説明し、キーをお渡しします。`}]},{id:`wf002`,name:`【標準】中古車買取フロー`,description:`顧客からキャンピングカーを買い取る際の標準的な業務フローです。`,tasks:[{id:1,text:`査定予約の受付と車両情報確認`,refId:`AI`,completed:!0,details:`電話またはウェブサイトから査定予約を受け付けます。車種、年式、走行距離、装備などの基本情報を事前にヒアリングします。`},{id:2,text:`実車査定と査定額の提示`,refId:`K004`,completed:!1,details:`予約日に顧客に来店いただき、車両の状態（内外装、エンジン、電装系）を詳細にチェックします。市場価格と車両状態を基に、適正な査定額を算出・提示します。`,documents:[{name:`中古車査定チェックシート.xlsx`,url:`#`,checked:!0}]},{id:3,text:`必要書類の案内と準備依頼`,refId:`K005`,completed:!1,details:`契約に必要な書類（車検証、自賠責保険証、印鑑証明書など）のリストをお渡しし、準備を依頼します。`},{id:4,text:`買取契約の締結と車両引き取り`,refId:`K002`,completed:!1,details:`書類が揃い次第、買取契約書に署名・捺印をいただきます。車両の引き取り日を調整し、車両をお預かりします。`},{id:5,text:`名義変更手続きと入金処理`,refId:`K006`,completed:!1,details:`引き取った車両の名義変更手続きを速やかに行い、指定の口座へ買取金額を振り込みます。`}]},{id:`wf003`,name:`【緊急】重大クレーム対応フロー`,description:`雨漏りやエンジン不動など、顧客満足度に大きく影響する重大なクレームに対応するためのフローです。`,tasks:[{id:1,text:`第一次受付と状況ヒアリング`,refId:`AI`,completed:!1,details:`顧客からのクレーム連絡を最優先で受け付け、冷静に状況をヒアリングします。感情的にならず、事実確認に徹します。`},{id:2,text:`車両の緊急引き取りまたは出張点検`,refId:`K007`,completed:!1,details:`車両が自走不能な場合は積載車を手配します。自走可能な場合でも、迅速に車両をお預かりするか、サービスカーで現地へ向かいます。`},{id:3,text:`原因の徹底調査と特定`,refId:`K008`,completed:!1,details:`サービス部門が総出で不具合の原因を調査・特定します。必要であればメーカーにも問い合わせ、情報を収集します。`,documents:[{name:`故障探求マニュアル.pdf`,url:`#`,checked:!1}]},{id:4,text:`顧客への経過報告と対応策の提案`,refId:`AI`,completed:!1,details:`調査状況を定期的に顧客へ報告し、不安を和らげます。原因が特定でき次第、修理内容、期間、費用（保証適用の有無）について正式に提案します。`},{id:5,text:`修理・交換作業と最終テスト`,refId:`K003`,completed:!1,details:`提案内容に合意後、修理・交換作業を実施します。作業完了後、複数回の走行テストや漏水テストを行い、不具合が完全に解消されたことを確認します。`},{id:6,text:`納車および謝罪と再発防止策の説明`,refId:`AI`,completed:!1,details:`車両を納車する際、改めて謝罪するとともに、今回の原因と実施した対策、今後の再発防止策について丁寧に説明します。`}]}],st=[{id:1,name:`山田 太郎`,company:`株式会社A`,status:`critical`,assignedFlowIds:[`wf003`]},{id:2,name:`田中 次郎`,company:`株式会社B`,status:`progress`,assignedFlowIds:[`wf001`,`wf002`]},{id:3,name:`鈴木 三郎`,company:`株式会社C`,status:`success`,assignedFlowIds:[]},{id:4,name:`佐藤 四郎`,company:`株式会社D`,status:`new`,assignedFlowIds:[`wf002`]}],ct={position:`absolute`,top:`50%`,left:`50%`,transform:`translate(-50%, -50%)`,width:600,bgcolor:`background.paper`,border:`2px solid #000`,boxShadow:24,p:4},lt={position:`absolute`,top:`50%`,left:`50%`,transform:`translate(-50%, -50%)`},ut=`1234`;function dt(){let[e,t]=(0,W.useState)(()=>(JSON.parse(localStorage.getItem(`customerData`))||st).map(e=>{let t={...e};return Array.isArray(t.assignedFlowIds)||(t.assignedFlowId?t.assignedFlowIds=[t.assignedFlowId]:t.assignedFlowIds=[]),delete t.assignedFlowId,t})),[n,r]=(0,W.useState)(()=>JSON.parse(localStorage.getItem(`workflowLibrary`))||ot),[i,a]=(0,W.useState)(1),[o,s]=(0,W.useState)(null),[c,d]=(0,W.useState)(!1),[f,p]=(0,W.useState)(null),[g,v]=(0,W.useState)(()=>JSON.parse(localStorage.getItem(`isCustomerListLocked`))||!1),[b,x]=(0,W.useState)(!1),[S,C]=(0,W.useState)(!1),[w,T]=(0,W.useState)(``);(0,W.useEffect)(()=>{localStorage.setItem(`customerData`,JSON.stringify(e))},[e]),(0,W.useEffect)(()=>{localStorage.setItem(`workflowLibrary`,JSON.stringify(n))},[n]),(0,W.useEffect)(()=>{localStorage.setItem(`isCustomerListLocked`,JSON.stringify(g))},[g]);let E=(0,W.useCallback)(()=>{JSON.parse(localStorage.getItem(`securityMode`))&&document.visibilityState===`hidden`&&!g&&v(!0)},[g]);(0,W.useEffect)(()=>(document.addEventListener(`visibilitychange`,E),()=>{document.removeEventListener(`visibilitychange`,E)}),[E]);let D=e.find(e=>e.id===i),O=W.useMemo(()=>D?D.assignedFlowIds.map(e=>n.find(t=>t.id===e)).filter(Boolean):[],[D,n]),k=n.find(e=>e.id===f);(0,W.useEffect)(()=>{let t=e.find(e=>e.id===i);if(t&&t.assignedFlowIds.length>0){let e=t.assignedFlowIds;e.includes(f)||p(e[0])}else p(null)},[i,e,f]),(0,W.useEffect)(()=>{let e=n.find(e=>e.id===f);if(e&&e.tasks.length>0){let t=e.tasks.find(e=>!e.completed);s(t?{workflowId:e.id,taskId:t.id}:{workflowId:e.id,taskId:e.tasks[0].id})}else s(null)},[i,f]);let A=W.useMemo(()=>{if(!o)return null;let e=n.find(e=>e.id===o.workflowId);return e&&e.tasks.find(e=>e.id===o.taskId)||null},[o,n]),j=e=>{a(e)},M=e=>{p(e)},N=e=>{f&&s({workflowId:f,taskId:e})},P=e=>{t(t=>t.map(t=>t.id===i&&!t.assignedFlowIds.includes(e)?{...t,assignedFlowIds:[...t.assignedFlowIds,e]}:t)),p(e),d(!1)},F=e=>{t(t=>t.map(t=>t.id===i?{...t,assignedFlowIds:t.assignedFlowIds.filter(t=>t!==e)}:t))},I=e=>{r(t=>t.map(t=>t.id===f?{...t,tasks:t.tasks.map(t=>t.id===e?{...t,completed:!t.completed}:t)}:t))},L=(e,t)=>{r(n=>n.map(n=>n.id===f?{...n,tasks:n.tasks.map(n=>n.id===e&&n.documents?{...n,documents:n.documents.map(e=>e.name===t?{...e,checked:!e.checked}:e)}:n)}:n))},ee=()=>{g?(T(``),C(!0)):x(!0)},R=()=>{v(!0),x(!1)},z=e=>{T(t=>t+e)},B=()=>{T(e=>e.slice(0,-1))},H=()=>{T(``)};(0,W.useEffect)(()=>{w===ut&&(v(!1),C(!1),T(``))},[w]);let te=[{type:`num`,value:1},{type:`num`,value:2},{type:`num`,value:3},{type:`num`,value:4},{type:`num`,value:5},{type:`num`,value:6},{type:`num`,value:7},{type:`num`,value:8},{type:`num`,value:9},{type:`clear`,value:(0,G.jsx)(at,{})},{type:`num`,value:0},{type:`bs`,value:(0,G.jsx)(it,{})}];return(0,G.jsxs)(V,{sx:{display:`flex`,flexDirection:`column`,height:`100vh`,bgcolor:`background.default`},children:[(0,G.jsx)(V,{sx:{p:`0 24px`},children:(0,G.jsx)(y,{isLocked:g,onToggleLock:ee})}),(0,G.jsxs)(V,{sx:{flexGrow:1,p:`0 24px 24px 24px`,display:`flex`,gap:2,minHeight:0},children:[!g&&(0,G.jsx)(V,{sx:{flex:`0 1 320px`,minWidth:280,transition:`all 0.3s ease`},children:(0,G.jsx)(Ue,{customers:e,selectedCustomerId:i,onSelectCustomer:j})}),(0,G.jsxs)(V,{sx:{flex:`1 1 50%`,display:`flex`,flexDirection:`column`,gap:2,minHeight:`fit-content`,minWidth:400},children:[(0,G.jsx)(Je,{customer:D,assignedFlows:O,onUnassignFlow:F,onOpenModal:()=>d(!0)}),(0,G.jsx)($e,{assignedFlows:O,selectedWorkflowId:f,onSelectWorkflow:M,currentWorkflow:k,onSelectTask:N,selectedTaskId:o?.taskId})]}),(0,G.jsx)(V,{sx:{flex:`0 1 35%`,minWidth:320},children:(0,G.jsx)(rt,{task:A,onToggleDocument:L,onToggleTask:I},A?`${o.workflowId}-${o.taskId}`:`no-task-selected`)})]}),(0,G.jsx)(_,{open:c,onClose:()=>d(!1),children:(0,G.jsxs)(V,{sx:ct,children:[(0,G.jsx)(h,{variant:`h6`,component:`h2`,gutterBottom:!0,children:`業務フローを選択`}),(0,G.jsx)(m,{children:n.map(e=>{let t=D?.assignedFlowIds.includes(e.id);return(0,G.jsx)(J,{onClick:()=>P(e.id),disabled:t,children:(0,G.jsx)(Z,{primary:e.name,secondary:e.description})},e.id)})})]})}),(0,G.jsx)(_,{open:b,onClose:()=>x(!1),children:(0,G.jsxs)(V,{sx:ct,style:{width:400},children:[(0,G.jsx)(h,{variant:`h6`,component:`h2`,children:`顧客リストをロックしますか？`}),(0,G.jsx)(h,{sx:{mt:2},children:`ロックすると、パスコードを入力するまでリストは表示されません。`}),(0,G.jsxs)(V,{sx:{mt:3,display:`flex`,justifyContent:`flex-end`,gap:1},children:[(0,G.jsx)(u,{variant:`outlined`,onClick:()=>x(!1),children:`キャンセル`}),(0,G.jsx)(u,{variant:`contained`,color:`primary`,onClick:R,children:`リストをロック`})]})]})}),(0,G.jsx)(_,{open:S,onClose:()=>C(!1),children:(0,G.jsx)(V,{sx:lt,children:(0,G.jsx)(l,{sx:{p:2,borderRadius:2,boxShadow:24,border:`2px solid #000`},children:(0,G.jsxs)(Be,{spacing:2,children:[(0,G.jsx)(l,{variant:`outlined`,sx:{p:1,textAlign:`center`,letterSpacing:`0.5em`,fontSize:`1.4rem`,minHeight:`2.4rem`,overflow:`hidden`},children:w.replace(/./g,`*`)}),(0,G.jsx)(V,{sx:{display:`flex`,flexWrap:`wrap`,gap:1,width:240},children:te.map(e=>{let t=()=>{};return e.type===`num`&&(t=()=>z(e.value.toString())),e.type===`clear`&&(t=H),e.type===`bs`&&(t=B),(0,G.jsx)(V,{sx:{flexBasis:`calc(33.333% - 8px)`,flexGrow:1},children:(0,G.jsx)(u,{fullWidth:!0,variant:`outlined`,onClick:t,sx:{height:`55px`,fontSize:`1.2rem`},children:e.value})},`${e.type}-${e.value}`)})})]})})})})]})}var ft=dt;export{ft as default};