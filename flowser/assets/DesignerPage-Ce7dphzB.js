import{a as e,i as t,n,r,t as i}from"./AutoFixHigh-CeutuXMh.js";import{C as a,D as o,E as s,S as c,T as l,_ as u,d,g as f,k as p,l as m,m as h,n as g,o as _,p as v,r as y,t as b,z as x}from"./Header-CUnFWtwv.js";import{i as S,n as C,r as w,t as T}from"./RadioGroup-DmQRp0tR.js";import{t as E}from"./geminiApiClient-niiFFWIv.js";import{a as D,i as O,n as k,o as A,r as j,s as M,t as N}from"./Edit-F8EWHAlo.js";import{n as P,t as F}from"./ListItemText-D75Fq_kV.js";import{B as I,Bt as L,D as R,Dt as ee,F as te,Ft as ne,G as re,H as ie,I as ae,It as oe,J as z,K as se,Lt as ce,Q as le,R as B,Rt as ue,S as de,U as fe,V,W as pe,X as me,Y as he,Z as ge,_ as _e,_t as ve,a as ye,c as be,ct as xe,d as Se,f as Ce,g as we,gt as Te,h as Ee,ht as De,i as Oe,jt as ke,n as Ae,nt as je,pt as Me,q as Ne,r as Pe,t as Fe,tt as Ie,v as Le,y as Re,z as ze}from"./index-D9m0Yf2z.js";function Be(e){return Te(`MuiAlertTitle`,e)}De(`MuiAlertTitle`,[`root`]);var H=L(oe()),U=L(ee()),Ve=e=>{let{classes:t}=e;return xe({root:[`root`]},Be,t)},He=je(a,{name:`MuiAlertTitle`,slot:`Root`})(le(({theme:e})=>({fontWeight:e.typography.fontWeightMedium,marginTop:-2}))),Ue=H.forwardRef(function(e,t){let n=ge({props:e,name:`MuiAlertTitle`}),{className:r,...i}=n,a=n,o=Ve(a);return(0,U.jsx)(He,{gutterBottom:!0,component:`div`,ownerState:a,ref:t,className:ve(o.root,r),...i})}),We=x((0,U.jsx)(`path`,{d:`M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z`}),`Person`);function Ge(e){return Te(`MuiAvatar`,e)}De(`MuiAvatar`,[`root`,`colorDefault`,`circular`,`rounded`,`square`,`img`,`fallback`]);var Ke=e=>{let{classes:t,variant:n,colorDefault:r}=e;return xe({root:[`root`,n,r&&`colorDefault`],img:[`img`],fallback:[`fallback`]},Ge,t)},qe=je(`div`,{name:`MuiAvatar`,slot:`Root`,overridesResolver:(e,t)=>{let{ownerState:n}=e;return[t.root,t[n.variant],n.colorDefault&&t.colorDefault]}})(le(({theme:e})=>({position:`relative`,display:`flex`,alignItems:`center`,justifyContent:`center`,flexShrink:0,width:40,height:40,fontFamily:e.typography.fontFamily,fontSize:e.typography.pxToRem(20),lineHeight:1,borderRadius:`50%`,overflow:`hidden`,userSelect:`none`,variants:[{props:{variant:`rounded`},style:{borderRadius:(e.vars||e).shape.borderRadius}},{props:{variant:`square`},style:{borderRadius:0}},{props:{colorDefault:!0},style:{color:(e.vars||e).palette.background.default,...e.vars?{backgroundColor:e.vars.palette.Avatar.defaultBg}:{backgroundColor:e.palette.grey[400],...e.applyStyles(`dark`,{backgroundColor:e.palette.grey[600]})}}}]}))),Je=je(`img`,{name:`MuiAvatar`,slot:`Img`})({width:`100%`,height:`100%`,textAlign:`center`,objectFit:`cover`,color:`transparent`,textIndent:1e4}),Ye=je(We,{name:`MuiAvatar`,slot:`Fallback`})({width:`75%`,height:`75%`});function Xe({crossOrigin:e,referrerPolicy:t,src:n,srcSet:r}){let[i,a]=H.useState(!1);return H.useEffect(()=>{if(!n&&!r)return;a(!1);let i=!0,o=new Image;return o.onload=()=>{i&&a(`loaded`)},o.onerror=()=>{i&&a(`error`)},o.crossOrigin=e,o.referrerPolicy=t,o.src=n,r&&(o.srcset=r),()=>{i=!1}},[e,t,n,r]),i}var Ze=H.forwardRef(function(e,t){let n=ge({props:e,name:`MuiAvatar`}),{alt:r,children:i,className:a,component:s=`div`,slots:c={},slotProps:l={},imgProps:u,sizes:d,src:f,srcSet:p,variant:m=`circular`,...h}=n,g=null,_={...n,component:s,variant:m},v=Xe({...u,...typeof l.img==`function`?l.img(_):l.img,src:f,srcSet:p}),y=f||p,b=y&&v!==`error`;_.colorDefault=!b,delete _.ownerState;let x=Ke(_),[S,C]=o(`root`,{ref:t,className:ve(x.root,a),elementType:qe,externalForwardedProps:{slots:c,slotProps:l,component:s,...h},ownerState:_}),[w,T]=o(`img`,{className:x.img,elementType:Je,externalForwardedProps:{slots:c,slotProps:{img:{...u,...l.img}}},additionalProps:{alt:r,src:f,srcSet:p,sizes:d},ownerState:_}),[E,D]=o(`fallback`,{className:x.fallback,elementType:Ye,externalForwardedProps:{slots:c,slotProps:l},shouldForwardComponentProp:!0,ownerState:_});return g=b?(0,U.jsx)(w,{...T}):i||i===0?i:y&&r?r[0]:(0,U.jsx)(E,{...D}),(0,U.jsx)(S,{...C,children:g})});function Qe(e){return H.Children.toArray(e).filter(e=>H.isValidElement(e))}function $e(e){return Te(`MuiToggleButton`,e)}var et=De(`MuiToggleButton`,[`root`,`disabled`,`selected`,`standard`,`primary`,`secondary`,`sizeSmall`,`sizeMedium`,`sizeLarge`,`fullWidth`]),tt=H.createContext({}),nt=H.createContext(void 0);function rt(e,t){return t===void 0||e===void 0?!1:Array.isArray(t)?t.includes(e):e===t}var it=e=>{let{classes:t,fullWidth:n,selected:r,disabled:i,size:a,color:o}=e,s={root:[`root`,r&&`selected`,i&&`disabled`,n&&`fullWidth`,`size${Ie(a)}`,o]};return xe(s,$e,t)},at=je(s,{name:`MuiToggleButton`,slot:`Root`,overridesResolver:(e,t)=>{let{ownerState:n}=e;return[t.root,t[`size${Ie(n.size)}`]]}})(le(({theme:e})=>({...e.typography.button,borderRadius:(e.vars||e).shape.borderRadius,padding:11,border:`1px solid ${(e.vars||e).palette.divider}`,color:(e.vars||e).palette.action.active,[`&.${et.disabled}`]:{color:(e.vars||e).palette.action.disabled,border:`1px solid ${(e.vars||e).palette.action.disabledBackground}`},"&:hover":{textDecoration:`none`,backgroundColor:e.alpha((e.vars||e).palette.text.primary,(e.vars||e).palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:`transparent`}},variants:[{props:{color:`standard`},style:{[`&.${et.selected}`]:{color:(e.vars||e).palette.text.primary,backgroundColor:e.alpha((e.vars||e).palette.text.primary,(e.vars||e).palette.action.selectedOpacity),"&:hover":{backgroundColor:e.alpha((e.vars||e).palette.text.primary,`${(e.vars||e).palette.action.selectedOpacity} + ${(e.vars||e).palette.action.hoverOpacity}`),"@media (hover: none)":{backgroundColor:e.alpha((e.vars||e).palette.text.primary,(e.vars||e).palette.action.selectedOpacity)}}}}},...Object.entries(e.palette).filter(me()).map(([t])=>({props:{color:t},style:{[`&.${et.selected}`]:{color:(e.vars||e).palette[t].main,backgroundColor:e.alpha((e.vars||e).palette[t].main,(e.vars||e).palette.action.selectedOpacity),"&:hover":{backgroundColor:e.alpha((e.vars||e).palette[t].main,`${(e.vars||e).palette.action.selectedOpacity} + ${(e.vars||e).palette.action.hoverOpacity}`),"@media (hover: none)":{backgroundColor:e.alpha((e.vars||e).palette[t].main,(e.vars||e).palette.action.selectedOpacity)}}}}})),{props:{fullWidth:!0},style:{width:`100%`}},{props:{size:`small`},style:{padding:7,fontSize:e.typography.pxToRem(13)}},{props:{size:`large`},style:{padding:15,fontSize:e.typography.pxToRem(15)}}]}))),ot=H.forwardRef(function(e,t){let{value:n,...r}=H.useContext(tt),i=H.useContext(nt),a=Me({...r,selected:rt(e.value,n)},e),o=ge({props:a,name:`MuiToggleButton`}),{children:s,className:c,color:l=`standard`,disabled:u=!1,disableFocusRipple:d=!1,fullWidth:f=!1,onChange:p,onClick:m,selected:h,size:g=`medium`,value:_,...v}=o,y={...o,color:l,disabled:u,disableFocusRipple:d,fullWidth:f,size:g},b=it(y),x=e=>{m&&(m(e,_),e.defaultPrevented)||p&&p(e,_)},S=i||``;return(0,U.jsx)(at,{className:ve(r.className,b.root,c,S),disabled:u,focusRipple:!d,ref:t,onClick:x,onChange:p,value:_,ownerState:y,"aria-pressed":h,...v,children:s})});function st(e){return Te(`MuiToggleButtonGroup`,e)}var W=De(`MuiToggleButtonGroup`,[`root`,`selected`,`horizontal`,`vertical`,`disabled`,`grouped`,`groupedHorizontal`,`groupedVertical`,`fullWidth`,`firstButton`,`lastButton`,`middleButton`]),ct=e=>{let{classes:t,orientation:n,fullWidth:r,disabled:i}=e,a={root:[`root`,n,r&&`fullWidth`],grouped:[`grouped`,`grouped${Ie(n)}`,i&&`disabled`],firstButton:[`firstButton`],lastButton:[`lastButton`],middleButton:[`middleButton`]};return xe(a,st,t)},lt=je(`div`,{name:`MuiToggleButtonGroup`,slot:`Root`,overridesResolver:(e,t)=>{let{ownerState:n}=e;return[{[`& .${W.grouped}`]:t.grouped},{[`& .${W.grouped}`]:t[`grouped${Ie(n.orientation)}`]},{[`& .${W.firstButton}`]:t.firstButton},{[`& .${W.lastButton}`]:t.lastButton},{[`& .${W.middleButton}`]:t.middleButton},t.root,n.orientation===`vertical`&&t.vertical,n.fullWidth&&t.fullWidth]}})(le(({theme:e})=>({display:`inline-flex`,borderRadius:(e.vars||e).shape.borderRadius,variants:[{props:{orientation:`vertical`},style:{flexDirection:`column`,[`& .${W.grouped}`]:{[`&.${W.selected} + .${W.grouped}.${W.selected}`]:{borderTop:0,marginTop:0}},[`& .${W.firstButton},& .${W.middleButton}`]:{borderBottomLeftRadius:0,borderBottomRightRadius:0},[`& .${W.lastButton},& .${W.middleButton}`]:{marginTop:-1,borderTop:`1px solid transparent`,borderTopLeftRadius:0,borderTopRightRadius:0},[`& .${W.lastButton}.${et.disabled},& .${W.middleButton}.${et.disabled}`]:{borderTop:`1px solid transparent`}}},{props:{fullWidth:!0},style:{width:`100%`}},{props:{orientation:`horizontal`},style:{[`& .${W.grouped}`]:{[`&.${W.selected} + .${W.grouped}.${W.selected}`]:{borderLeft:0,marginLeft:0}},[`& .${W.firstButton},& .${W.middleButton}`]:{borderTopRightRadius:0,borderBottomRightRadius:0},[`& .${W.lastButton},& .${W.middleButton}`]:{marginLeft:-1,borderLeft:`1px solid transparent`,borderTopLeftRadius:0,borderBottomLeftRadius:0},[`& .${W.lastButton}.${et.disabled},& .${W.middleButton}.${et.disabled}`]:{borderLeft:`1px solid transparent`}}}]}))),ut=H.forwardRef(function(e,t){let n=ge({props:e,name:`MuiToggleButtonGroup`}),{children:r,className:i,color:a=`standard`,disabled:o=!1,exclusive:s=!1,fullWidth:c=!1,onChange:l,orientation:u=`horizontal`,size:d=`medium`,value:f,...p}=n,m={...n,disabled:o,fullWidth:c,orientation:u,size:d},h=ct(m),g=H.useCallback((e,t)=>{if(!l)return;let n=f&&f.indexOf(t),r;f&&n>=0?(r=f.slice(),r.splice(n,1)):r=f?f.concat(t):[t],l(e,r)},[l,f]),_=H.useCallback((e,t)=>{l&&l(e,f===t?null:t)},[l,f]),v=H.useMemo(()=>({className:h.grouped,onChange:s?_:g,value:f,size:d,fullWidth:c,color:a,disabled:o}),[h.grouped,s,_,g,f,d,c,a,o]),y=Qe(r),b=y.length,x=e=>{let t=e===0,n=e===b-1;return t&&n?``:t?h.firstButton:n?h.lastButton:h.middleButton};return(0,U.jsx)(lt,{role:`group`,className:ve(h.root,i),ref:t,ownerState:m,...p,children:(0,U.jsx)(tt.Provider,{value:v,children:y.map((e,t)=>(0,U.jsx)(nt.Provider,{value:x(t),children:e},t))})})});const dt=(0,H.createContext)({dragDropManager:void 0});function ft(e){return`Minified Redux error #`+e+`; visit https://redux.js.org/Errors?code=`+e+` for the full message or use the non-minified dev environment for full errors. `}var pt=(function(){return typeof Symbol==`function`&&Symbol.observable||`@@observable`})(),mt=function(){return Math.random().toString(36).substring(7).split(``).join(`.`)},ht={INIT:`@@redux/INIT`+mt(),REPLACE:`@@redux/REPLACE`+mt(),PROBE_UNKNOWN_ACTION:function(){return`@@redux/PROBE_UNKNOWN_ACTION`+mt()}};function gt(e){if(typeof e!=`object`||!e)return!1;for(var t=e;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}function _t(e,t,n){var r;if(typeof t==`function`&&typeof n==`function`||typeof n==`function`&&typeof arguments[3]==`function`)throw Error(ft(0));if(typeof t==`function`&&n===void 0&&(n=t,t=void 0),n!==void 0){if(typeof n!=`function`)throw Error(ft(1));return n(_t)(e,t)}if(typeof e!=`function`)throw Error(ft(2));var i=e,a=t,o=[],s=o,c=!1;function l(){s===o&&(s=o.slice())}function u(){if(c)throw Error(ft(3));return a}function d(e){if(typeof e!=`function`)throw Error(ft(4));if(c)throw Error(ft(5));var t=!0;return l(),s.push(e),function(){if(t){if(c)throw Error(ft(6));t=!1,l();var n=s.indexOf(e);s.splice(n,1),o=null}}}function f(e){if(!gt(e))throw Error(ft(7));if(e.type===void 0)throw Error(ft(8));if(c)throw Error(ft(9));try{c=!0,a=i(a,e)}finally{c=!1}for(var t=o=s,n=0;n<t.length;n++){var r=t[n];r()}return e}function p(e){if(typeof e!=`function`)throw Error(ft(10));i=e,f({type:ht.REPLACE})}function m(){var e,t=d;return e={subscribe:function(e){if(typeof e!=`object`||!e)throw Error(ft(11));function n(){e.next&&e.next(u())}return n(),{unsubscribe:t(n)}}},e[pt]=function(){return this},e}return f({type:ht.INIT}),r={dispatch:f,subscribe:d,getState:u,replaceReducer:p},r[pt]=m,r}function G(e,t,...n){if(vt()&&t===void 0)throw Error(`invariant requires an error message argument`);if(!e){let e;if(t===void 0)e=Error(`Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.`);else{let r=0;e=Error(t.replace(/%s/g,function(){return n[r++]})),e.name=`Invariant Violation`}throw e.framesToPop=1,e}}function vt(){return typeof process<`u`&&!0}function yt(e,t,n){return t.split(`.`).reduce((e,t)=>e&&e[t]?e[t]:n||null,e)}function bt(e,t){return e.filter(e=>e!==t)}function xt(e){return typeof e==`object`}function St(e,t){let n=new Map,r=e=>{n.set(e,n.has(e)?n.get(e)+1:1)};e.forEach(r),t.forEach(r);let i=[];return n.forEach((e,t)=>{e===1&&i.push(t)}),i}function Ct(e,t){return e.filter(e=>t.indexOf(e)>-1)}const wt=`dnd-core/INIT_COORDS`,Tt=`dnd-core/BEGIN_DRAG`,Et=`dnd-core/PUBLISH_DRAG_SOURCE`,Dt=`dnd-core/HOVER`,Ot=`dnd-core/DROP`,kt=`dnd-core/END_DRAG`;function At(e,t){return{type:wt,payload:{sourceClientOffset:t||null,clientOffset:e||null}}}var jt={type:wt,payload:{clientOffset:null,sourceClientOffset:null}};function Mt(e){return function(t=[],n={publishSource:!0}){let{publishSource:r=!0,clientOffset:i,getSourceClientOffset:a}=n,o=e.getMonitor(),s=e.getRegistry();e.dispatch(At(i)),Nt(t,o,s);let c=It(t,o);if(c==null){e.dispatch(jt);return}let l=null;if(i){if(!a)throw Error(`getSourceClientOffset must be defined`);Pt(a),l=a(c)}e.dispatch(At(i,l));let u=s.getSource(c).beginDrag(o,c);if(u==null)return;Ft(u),s.pinSource(c);let d=s.getSourceType(c);return{type:Tt,payload:{itemType:d,item:u,sourceId:c,clientOffset:i||null,sourceClientOffset:l||null,isSourcePublic:!!r}}}}function Nt(e,t,n){G(!t.isDragging(),`Cannot call beginDrag while dragging.`),e.forEach(function(e){G(n.getSource(e),`Expected sourceIds to be registered.`)})}function Pt(e){G(typeof e==`function`,`When clientOffset is provided, getSourceClientOffset must be a function.`)}function Ft(e){G(xt(e),`Item must be an object.`)}function It(e,t){let n=null;for(let r=e.length-1;r>=0;r--)if(t.canDragSource(e[r])){n=e[r];break}return n}function Lt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Rt(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]==null?{}:arguments[t],r=Object.keys(n);typeof Object.getOwnPropertySymbols==`function`&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){Lt(e,t,n[t])})}return e}function zt(e){return function(t={}){let n=e.getMonitor(),r=e.getRegistry();Bt(n),Ut(n).forEach((i,a)=>{let o=Vt(i,a,r,n),s={type:Ot,payload:{dropResult:Rt({},t,o)}};e.dispatch(s)})}}function Bt(e){G(e.isDragging(),`Cannot call drop while not dragging.`),G(!e.didDrop(),`Cannot call drop twice during one drag operation.`)}function Vt(e,t,n,r){let i=n.getTarget(e),a=i?i.drop(r,e):void 0;return Ht(a),a===void 0&&(a=t===0?{}:r.getDropResult()),a}function Ht(e){G(e===void 0||xt(e),`Drop result must either be an object or undefined.`)}function Ut(e){let t=e.getTargetIds().filter(e.canDropOnTarget,e);return t.reverse(),t}function Wt(e){return function(){let t=e.getMonitor(),n=e.getRegistry();Gt(t);let r=t.getSourceId();return r!=null&&(n.getSource(r,!0).endDrag(t,r),n.unpinSource()),{type:kt}}}function Gt(e){G(e.isDragging(),`Cannot call endDrag while not dragging.`)}function Kt(e,t){return t===null?e===null:Array.isArray(e)?e.some(e=>e===t):e===t}function qt(e){return function(t,{clientOffset:n}={}){Jt(t);let r=t.slice(0),i=e.getMonitor(),a=e.getRegistry(),o=i.getItemType();return Xt(r,a,o),Yt(r,i,a),Zt(r,i,a),{type:Dt,payload:{targetIds:r,clientOffset:n||null}}}}function Jt(e){G(Array.isArray(e),`Expected targetIds to be an array.`)}function Yt(e,t,n){G(t.isDragging(),`Cannot call hover while not dragging.`),G(!t.didDrop(),`Cannot call hover after drop.`);for(let t=0;t<e.length;t++){let r=e[t];G(e.lastIndexOf(r)===t,`Expected targetIds to be unique in the passed array.`);let i=n.getTarget(r);G(i,`Expected targetIds to be registered.`)}}function Xt(e,t,n){for(let r=e.length-1;r>=0;r--){let i=e[r],a=t.getTargetType(i);Kt(a,n)||e.splice(r,1)}}function Zt(e,t,n){e.forEach(function(e){n.getTarget(e).hover(t,e)})}function Qt(e){return function(){if(e.getMonitor().isDragging())return{type:Et}}}function $t(e){return{beginDrag:Mt(e),publishDragSource:Qt(e),hover:qt(e),drop:zt(e),endDrag:Wt(e)}}var en=class{receiveBackend(e){this.backend=e}getMonitor(){return this.monitor}getBackend(){return this.backend}getRegistry(){return this.monitor.registry}getActions(){let e=this,{dispatch:t}=this.store;function n(n){return(...r)=>{let i=n.apply(e,r);i!==void 0&&t(i)}}let r=$t(this);return Object.keys(r).reduce((e,t)=>{let i=r[t];return e[t]=n(i),e},{})}dispatch(e){this.store.dispatch(e)}constructor(e,t){this.isSetUp=!1,this.handleRefCountChange=()=>{let e=this.store.getState().refCount>0;this.backend&&(e&&!this.isSetUp?(this.backend.setup(),this.isSetUp=!0):!e&&this.isSetUp&&(this.backend.teardown(),this.isSetUp=!1))},this.store=e,this.monitor=t,e.subscribe(this.handleRefCountChange)}};function tn(e,t){return{x:e.x+t.x,y:e.y+t.y}}function nn(e,t){return{x:e.x-t.x,y:e.y-t.y}}function rn(e){let{clientOffset:t,initialClientOffset:n,initialSourceClientOffset:r}=e;return!t||!n||!r?null:nn(tn(t,r),n)}function an(e){let{clientOffset:t,initialClientOffset:n}=e;return!t||!n?null:nn(t,n)}const on=[],sn=[];on.__IS_NONE__=!0,sn.__IS_ALL__=!0;function cn(e,t){return e===on?!1:e===sn||t===void 0?!0:Ct(t,e).length>0}var ln=class{subscribeToStateChange(e,t={}){let{handlerIds:n}=t;G(typeof e==`function`,`listener must be a function.`),G(n===void 0||Array.isArray(n),`handlerIds, when specified, must be an array of strings.`);let r=this.store.getState().stateId;return this.store.subscribe(()=>{let t=this.store.getState(),i=t.stateId;try{i===r||i===r+1&&!cn(t.dirtyHandlerIds,n)||e()}finally{r=i}})}subscribeToOffsetChange(e){G(typeof e==`function`,`listener must be a function.`);let t=this.store.getState().dragOffset;return this.store.subscribe(()=>{let n=this.store.getState().dragOffset;n!==t&&(t=n,e())})}canDragSource(e){if(!e)return!1;let t=this.registry.getSource(e);return G(t,`Expected to find a valid source. sourceId=${e}`),this.isDragging()?!1:t.canDrag(this,e)}canDropOnTarget(e){if(!e)return!1;let t=this.registry.getTarget(e);if(G(t,`Expected to find a valid target. targetId=${e}`),!this.isDragging()||this.didDrop())return!1;let n=this.registry.getTargetType(e),r=this.getItemType();return Kt(n,r)&&t.canDrop(this,e)}isDragging(){return!!this.getItemType()}isDraggingSource(e){if(!e)return!1;let t=this.registry.getSource(e,!0);if(G(t,`Expected to find a valid source. sourceId=${e}`),!this.isDragging()||!this.isSourcePublic())return!1;let n=this.registry.getSourceType(e),r=this.getItemType();return n===r?t.isDragging(this,e):!1}isOverTarget(e,t={shallow:!1}){if(!e)return!1;let{shallow:n}=t;if(!this.isDragging())return!1;let r=this.registry.getTargetType(e),i=this.getItemType();if(i&&!Kt(r,i))return!1;let a=this.getTargetIds();if(!a.length)return!1;let o=a.indexOf(e);return n?o===a.length-1:o>-1}getItemType(){return this.store.getState().dragOperation.itemType}getItem(){return this.store.getState().dragOperation.item}getSourceId(){return this.store.getState().dragOperation.sourceId}getTargetIds(){return this.store.getState().dragOperation.targetIds}getDropResult(){return this.store.getState().dragOperation.dropResult}didDrop(){return this.store.getState().dragOperation.didDrop}isSourcePublic(){return!!this.store.getState().dragOperation.isSourcePublic}getInitialClientOffset(){return this.store.getState().dragOffset.initialClientOffset}getInitialSourceClientOffset(){return this.store.getState().dragOffset.initialSourceClientOffset}getClientOffset(){return this.store.getState().dragOffset.clientOffset}getSourceClientOffset(){return rn(this.store.getState().dragOffset)}getDifferenceFromInitialOffset(){return an(this.store.getState().dragOffset)}constructor(e,t){this.store=e,this.registry=t}},un=typeof global<`u`?global:self,dn=un.MutationObserver||un.WebKitMutationObserver;function fn(e){return function(){let t=setTimeout(r,0),n=setInterval(r,50);function r(){clearTimeout(t),clearInterval(n),e()}}}function pn(e){let t=1,n=new dn(e),r=document.createTextNode(``);return n.observe(r,{characterData:!0}),function(){t=-t,r.data=t}}const mn=typeof dn==`function`?pn:fn;var hn=class{enqueueTask(e){let{queue:t,requestFlush:n}=this;t.length||(n(),this.flushing=!0),t[t.length]=e}constructor(){this.queue=[],this.pendingErrors=[],this.flushing=!1,this.index=0,this.capacity=1024,this.flush=()=>{let{queue:e}=this;for(;this.index<e.length;){let t=this.index;if(this.index++,e[t].call(),this.index>this.capacity){for(let t=0,n=e.length-this.index;t<n;t++)e[t]=e[t+this.index];e.length-=this.index,this.index=0}}e.length=0,this.index=0,this.flushing=!1},this.registerPendingError=e=>{this.pendingErrors.push(e),this.requestErrorThrow()},this.requestFlush=mn(this.flush),this.requestErrorThrow=fn(()=>{if(this.pendingErrors.length)throw this.pendingErrors.shift()})}},gn=class{call(){try{this.task&&this.task()}catch(e){this.onError(e)}finally{this.task=null,this.release(this)}}constructor(e,t){this.onError=e,this.release=t,this.task=null}},_n=class{create(e){let t=this.freeTasks,n=t.length?t.pop():new gn(this.onError,e=>t[t.length]=e);return n.task=e,n}constructor(e){this.onError=e,this.freeTasks=[]}},vn=new hn,yn=new _n(vn.registerPendingError);function bn(e){vn.enqueueTask(yn.create(e))}const xn=`dnd-core/ADD_SOURCE`,Sn=`dnd-core/ADD_TARGET`,Cn=`dnd-core/REMOVE_SOURCE`,wn=`dnd-core/REMOVE_TARGET`;function Tn(e){return{type:xn,payload:{sourceId:e}}}function En(e){return{type:Sn,payload:{targetId:e}}}function Dn(e){return{type:Cn,payload:{sourceId:e}}}function On(e){return{type:wn,payload:{targetId:e}}}function kn(e){G(typeof e.canDrag==`function`,`Expected canDrag to be a function.`),G(typeof e.beginDrag==`function`,`Expected beginDrag to be a function.`),G(typeof e.endDrag==`function`,`Expected endDrag to be a function.`)}function An(e){G(typeof e.canDrop==`function`,`Expected canDrop to be a function.`),G(typeof e.hover==`function`,`Expected hover to be a function.`),G(typeof e.drop==`function`,`Expected beginDrag to be a function.`)}function jn(e,t){if(t&&Array.isArray(e)){e.forEach(e=>jn(e,!1));return}G(typeof e==`string`||typeof e==`symbol`,t?`Type can only be a string, a symbol, or an array of either.`:`Type can only be a string or a symbol.`)}var Mn;(function(e){e.SOURCE=`SOURCE`,e.TARGET=`TARGET`})(Mn||={});var Nn=0;function Pn(){return Nn++}function Fn(e){let t=Pn().toString();switch(e){case Mn.SOURCE:return`S${t}`;case Mn.TARGET:return`T${t}`;default:throw Error(`Unknown Handler Role: ${e}`)}}function In(e){switch(e[0]){case`S`:return Mn.SOURCE;case`T`:return Mn.TARGET;default:throw Error(`Cannot parse handler ID: ${e}`)}}function Ln(e,t){let n=e.entries(),r=!1;do{let{done:e,value:[,i]}=n.next();if(i===t)return!0;r=!!e}while(!r);return!1}var Rn=class{addSource(e,t){jn(e),kn(t);let n=this.addHandler(Mn.SOURCE,e,t);return this.store.dispatch(Tn(n)),n}addTarget(e,t){jn(e,!0),An(t);let n=this.addHandler(Mn.TARGET,e,t);return this.store.dispatch(En(n)),n}containsHandler(e){return Ln(this.dragSources,e)||Ln(this.dropTargets,e)}getSource(e,t=!1){return G(this.isSourceId(e),`Expected a valid source ID.`),t&&e===this.pinnedSourceId?this.pinnedSource:this.dragSources.get(e)}getTarget(e){return G(this.isTargetId(e),`Expected a valid target ID.`),this.dropTargets.get(e)}getSourceType(e){return G(this.isSourceId(e),`Expected a valid source ID.`),this.types.get(e)}getTargetType(e){return G(this.isTargetId(e),`Expected a valid target ID.`),this.types.get(e)}isSourceId(e){return In(e)===Mn.SOURCE}isTargetId(e){return In(e)===Mn.TARGET}removeSource(e){G(this.getSource(e),`Expected an existing source.`),this.store.dispatch(Dn(e)),bn(()=>{this.dragSources.delete(e),this.types.delete(e)})}removeTarget(e){G(this.getTarget(e),`Expected an existing target.`),this.store.dispatch(On(e)),this.dropTargets.delete(e),this.types.delete(e)}pinSource(e){let t=this.getSource(e);G(t,`Expected an existing source.`),this.pinnedSourceId=e,this.pinnedSource=t}unpinSource(){G(this.pinnedSource,`No source is pinned at the time.`),this.pinnedSourceId=null,this.pinnedSource=null}addHandler(e,t,n){let r=Fn(e);return this.types.set(r,t),e===Mn.SOURCE?this.dragSources.set(r,n):e===Mn.TARGET&&this.dropTargets.set(r,n),r}constructor(e){this.types=new Map,this.dragSources=new Map,this.dropTargets=new Map,this.pinnedSourceId=null,this.pinnedSource=null,this.store=e}};const zn=(e,t)=>e===t;function Bn(e,t){return!e&&!t?!0:!e||!t?!1:e.x===t.x&&e.y===t.y}function Vn(e,t,n=zn){if(e.length!==t.length)return!1;for(let r=0;r<e.length;++r)if(!n(e[r],t[r]))return!1;return!0}function Hn(e=on,t){switch(t.type){case Dt:break;case xn:case Sn:case wn:case Cn:return on;case Tt:case Et:case kt:case Ot:default:return sn}let{targetIds:n=[],prevTargetIds:r=[]}=t.payload,i=St(n,r);if(!(i.length>0||!Vn(n,r)))return on;let a=r[r.length-1],o=n[n.length-1];return a!==o&&(a&&i.push(a),o&&i.push(o)),i}function Un(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Wn(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]==null?{}:arguments[t],r=Object.keys(n);typeof Object.getOwnPropertySymbols==`function`&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){Un(e,t,n[t])})}return e}var Gn={initialSourceClientOffset:null,initialClientOffset:null,clientOffset:null};function Kn(e=Gn,t){let{payload:n}=t;switch(t.type){case wt:case Tt:return{initialSourceClientOffset:n.sourceClientOffset,initialClientOffset:n.clientOffset,clientOffset:n.clientOffset};case Dt:return Bn(e.clientOffset,n.clientOffset)?e:Wn({},e,{clientOffset:n.clientOffset});case kt:case Ot:return Gn;default:return e}}function qn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Jn(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]==null?{}:arguments[t],r=Object.keys(n);typeof Object.getOwnPropertySymbols==`function`&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){qn(e,t,n[t])})}return e}var Yn={itemType:null,item:null,sourceId:null,targetIds:[],dropResult:null,didDrop:!1,isSourcePublic:null};function Xn(e=Yn,t){let{payload:n}=t;switch(t.type){case Tt:return Jn({},e,{itemType:n.itemType,item:n.item,sourceId:n.sourceId,isSourcePublic:n.isSourcePublic,dropResult:null,didDrop:!1});case Et:return Jn({},e,{isSourcePublic:!0});case Dt:return Jn({},e,{targetIds:n.targetIds});case wn:return e.targetIds.indexOf(n.targetId)===-1?e:Jn({},e,{targetIds:bt(e.targetIds,n.targetId)});case Ot:return Jn({},e,{dropResult:n.dropResult,didDrop:!0,targetIds:[]});case kt:return Jn({},e,{itemType:null,item:null,sourceId:null,dropResult:null,didDrop:!1,isSourcePublic:null,targetIds:[]});default:return e}}function Zn(e=0,t){switch(t.type){case xn:case Sn:return e+1;case Cn:case wn:return e-1;default:return e}}function Qn(e=0){return e+1}function $n(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function er(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]==null?{}:arguments[t],r=Object.keys(n);typeof Object.getOwnPropertySymbols==`function`&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){$n(e,t,n[t])})}return e}function tr(e={},t){return{dirtyHandlerIds:Hn(e.dirtyHandlerIds,{type:t.type,payload:er({},t.payload,{prevTargetIds:yt(e,`dragOperation.targetIds`,[])})}),dragOffset:Kn(e.dragOffset,t),refCount:Zn(e.refCount,t),dragOperation:Xn(e.dragOperation,t),stateId:Qn(e.stateId)}}function nr(e,t=void 0,n={},r=!1){let i=rr(r),a=new ln(i,new Rn(i)),o=new en(i,a),s=e(o,t,n);return o.receiveBackend(s),o}function rr(e){let t=typeof window<`u`&&window.__REDUX_DEVTOOLS_EXTENSION__;return _t(tr,e&&t&&t({name:`dnd-core`,instanceId:`dnd-core`}))}function ir(e,t){if(e==null)return{};var n=ar(e,t),r,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)r=a[i],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function ar(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}var or=0,sr=Symbol.for(`__REACT_DND_CONTEXT_INSTANCE__`),cr=(0,H.memo)(function(e){var{children:t}=e,n=ir(e,[`children`]);let[r,i]=lr(n);return(0,H.useEffect)(()=>{if(i){let e=dr();return++or,()=>{--or===0&&(e[sr]=null)}}},[]),(0,U.jsx)(dt.Provider,{value:r,children:t})});function lr(e){if(`manager`in e)return[{dragDropManager:e.manager},!1];let t=ur(e.backend,e.context,e.options,e.debugMode),n=!e.context;return[t,n]}function ur(e,t=dr(),n,r){let i=t;return i[sr]||(i[sr]={dragDropManager:nr(e,t,n,r)}),i[sr]}function dr(){return typeof global<`u`?global:window}var fr=ce(((exports,t)=>{t.exports=function e(t,n){if(t===n)return!0;if(t&&n&&typeof t==`object`&&typeof n==`object`){if(t.constructor!==n.constructor)return!1;var r,i,a;if(Array.isArray(t)){if(r=t.length,r!=n.length)return!1;for(i=r;i--!==0;)if(!e(t[i],n[i]))return!1;return!0}if(t.constructor===RegExp)return t.source===n.source&&t.flags===n.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===n.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===n.toString();if(a=Object.keys(t),r=a.length,r!==Object.keys(n).length)return!1;for(i=r;i--!==0;)if(!Object.prototype.hasOwnProperty.call(n,a[i]))return!1;for(i=r;i--!==0;){var o=a[i];if(!e(t[o],n[o]))return!1}return!0}return t!==t&&n!==n}}));const pr=typeof window<`u`?H.useLayoutEffect:H.useEffect;var mr=L(fr());function hr(e,t,n){let[r,i]=(0,H.useState)(()=>t(e)),a=(0,H.useCallback)(()=>{let a=t(e);(0,mr.default)(r,a)||(i(a),n&&n())},[r,e,n]);return pr(a),[r,a]}function gr(e,t,n){let[r,i]=hr(e,t,n);return pr(function(){let t=e.getHandlerId();if(t!=null)return e.subscribeToStateChange(i,{handlerIds:[t]})},[e,i]),r}function _r(e,t,n){return gr(t,e||(()=>({})),()=>n.reconnect())}function vr(e,t){let n=[...t||[]];return t==null&&typeof e!=`function`&&n.push(e),(0,H.useMemo)(()=>typeof e==`function`?e():e,n)}function yr(e){return(0,H.useMemo)(()=>e.hooks.dragSource(),[e])}function br(e){return(0,H.useMemo)(()=>e.hooks.dragPreview(),[e])}var xr=!1,Sr=!1,Cr=class{receiveHandlerId(e){this.sourceId=e}getHandlerId(){return this.sourceId}canDrag(){G(!xr,`You may not call monitor.canDrag() inside your canDrag() implementation. Read more: http://react-dnd.github.io/react-dnd/docs/api/drag-source-monitor`);try{return xr=!0,this.internalMonitor.canDragSource(this.sourceId)}finally{xr=!1}}isDragging(){if(!this.sourceId)return!1;G(!Sr,`You may not call monitor.isDragging() inside your isDragging() implementation. Read more: http://react-dnd.github.io/react-dnd/docs/api/drag-source-monitor`);try{return Sr=!0,this.internalMonitor.isDraggingSource(this.sourceId)}finally{Sr=!1}}subscribeToStateChange(e,t){return this.internalMonitor.subscribeToStateChange(e,t)}isDraggingSource(e){return this.internalMonitor.isDraggingSource(e)}isOverTarget(e,t){return this.internalMonitor.isOverTarget(e,t)}getTargetIds(){return this.internalMonitor.getTargetIds()}isSourcePublic(){return this.internalMonitor.isSourcePublic()}getSourceId(){return this.internalMonitor.getSourceId()}subscribeToOffsetChange(e){return this.internalMonitor.subscribeToOffsetChange(e)}canDragSource(e){return this.internalMonitor.canDragSource(e)}canDropOnTarget(e){return this.internalMonitor.canDropOnTarget(e)}getItemType(){return this.internalMonitor.getItemType()}getItem(){return this.internalMonitor.getItem()}getDropResult(){return this.internalMonitor.getDropResult()}didDrop(){return this.internalMonitor.didDrop()}getInitialClientOffset(){return this.internalMonitor.getInitialClientOffset()}getInitialSourceClientOffset(){return this.internalMonitor.getInitialSourceClientOffset()}getSourceClientOffset(){return this.internalMonitor.getSourceClientOffset()}getClientOffset(){return this.internalMonitor.getClientOffset()}getDifferenceFromInitialOffset(){return this.internalMonitor.getDifferenceFromInitialOffset()}constructor(e){this.sourceId=null,this.internalMonitor=e.getMonitor()}},wr=!1,Tr=class{receiveHandlerId(e){this.targetId=e}getHandlerId(){return this.targetId}subscribeToStateChange(e,t){return this.internalMonitor.subscribeToStateChange(e,t)}canDrop(){if(!this.targetId)return!1;G(!wr,`You may not call monitor.canDrop() inside your canDrop() implementation. Read more: http://react-dnd.github.io/react-dnd/docs/api/drop-target-monitor`);try{return wr=!0,this.internalMonitor.canDropOnTarget(this.targetId)}finally{wr=!1}}isOver(e){return this.targetId?this.internalMonitor.isOverTarget(this.targetId,e):!1}getItemType(){return this.internalMonitor.getItemType()}getItem(){return this.internalMonitor.getItem()}getDropResult(){return this.internalMonitor.getDropResult()}didDrop(){return this.internalMonitor.didDrop()}getInitialClientOffset(){return this.internalMonitor.getInitialClientOffset()}getInitialSourceClientOffset(){return this.internalMonitor.getInitialSourceClientOffset()}getSourceClientOffset(){return this.internalMonitor.getSourceClientOffset()}getClientOffset(){return this.internalMonitor.getClientOffset()}getDifferenceFromInitialOffset(){return this.internalMonitor.getDifferenceFromInitialOffset()}constructor(e){this.targetId=null,this.internalMonitor=e.getMonitor()}};function Er(e,t,n){let r=n.getRegistry(),i=r.addTarget(e,t);return[i,()=>r.removeTarget(i)]}function Dr(e,t,n){let r=n.getRegistry(),i=r.addSource(e,t);return[i,()=>r.removeSource(i)]}function Or(e,t,n,r){let i=n?n.call(r,e,t):void 0;if(i!==void 0)return!!i;if(e===t)return!0;if(typeof e!=`object`||!e||typeof t!=`object`||!t)return!1;let a=Object.keys(e),o=Object.keys(t);if(a.length!==o.length)return!1;let s=Object.prototype.hasOwnProperty.bind(t);for(let o=0;o<a.length;o++){let c=a[o];if(!s(c))return!1;let l=e[c],u=t[c];if(i=n?n.call(r,l,u,c):void 0,i===!1||i===void 0&&l!==u)return!1}return!0}function kr(e){return typeof e==`object`&&!!e&&Object.prototype.hasOwnProperty.call(e,`current`)}function Ar(e){if(typeof e.type==`string`)return;let t=e.type.displayName||e.type.name||`the component`;throw Error(`Only native element nodes can now be passed to React DnD connectors.You can either wrap ${t} into a <div>, or turn it into a drag source or a drop target itself.`)}function jr(e){return(t=null,n=null)=>{if(!(0,H.isValidElement)(t)){let r=t;return e(r,n),r}let r=t;return Ar(r),Pr(r,n?t=>e(t,n):e)}}function Mr(e){let t={};return Object.keys(e).forEach(n=>{let r=e[n];if(n.endsWith(`Ref`))t[n]=e[n];else{let e=jr(r);t[n]=()=>e}}),t}function Nr(e,t){typeof e==`function`?e(t):e.current=t}function Pr(e,t){let n=e.ref;return G(typeof n!=`string`,`Cannot connect React DnD to an element with an existing string ref. Please convert it to use a callback ref instead, or wrap it into a <span> or <div>. Read more: https://reactjs.org/docs/refs-and-the-dom.html#callback-refs`),n?(0,H.cloneElement)(e,{ref:e=>{Nr(n,e),Nr(t,e)}}):(0,H.cloneElement)(e,{ref:t})}var Fr=class{receiveHandlerId(e){this.handlerId!==e&&(this.handlerId=e,this.reconnect())}get connectTarget(){return this.dragSource}get dragSourceOptions(){return this.dragSourceOptionsInternal}set dragSourceOptions(e){this.dragSourceOptionsInternal=e}get dragPreviewOptions(){return this.dragPreviewOptionsInternal}set dragPreviewOptions(e){this.dragPreviewOptionsInternal=e}reconnect(){let e=this.reconnectDragSource();this.reconnectDragPreview(e)}reconnectDragSource(){let e=this.dragSource,t=this.didHandlerIdChange()||this.didConnectedDragSourceChange()||this.didDragSourceOptionsChange();return t&&this.disconnectDragSource(),this.handlerId?e?(t&&(this.lastConnectedHandlerId=this.handlerId,this.lastConnectedDragSource=e,this.lastConnectedDragSourceOptions=this.dragSourceOptions,this.dragSourceUnsubscribe=this.backend.connectDragSource(this.handlerId,e,this.dragSourceOptions)),t):(this.lastConnectedDragSource=e,t):t}reconnectDragPreview(e=!1){let t=this.dragPreview,n=e||this.didHandlerIdChange()||this.didConnectedDragPreviewChange()||this.didDragPreviewOptionsChange();if(n&&this.disconnectDragPreview(),this.handlerId){if(!t){this.lastConnectedDragPreview=t;return}n&&(this.lastConnectedHandlerId=this.handlerId,this.lastConnectedDragPreview=t,this.lastConnectedDragPreviewOptions=this.dragPreviewOptions,this.dragPreviewUnsubscribe=this.backend.connectDragPreview(this.handlerId,t,this.dragPreviewOptions))}}didHandlerIdChange(){return this.lastConnectedHandlerId!==this.handlerId}didConnectedDragSourceChange(){return this.lastConnectedDragSource!==this.dragSource}didConnectedDragPreviewChange(){return this.lastConnectedDragPreview!==this.dragPreview}didDragSourceOptionsChange(){return!Or(this.lastConnectedDragSourceOptions,this.dragSourceOptions)}didDragPreviewOptionsChange(){return!Or(this.lastConnectedDragPreviewOptions,this.dragPreviewOptions)}disconnectDragSource(){this.dragSourceUnsubscribe&&=(this.dragSourceUnsubscribe(),void 0)}disconnectDragPreview(){this.dragPreviewUnsubscribe&&(this.dragPreviewUnsubscribe(),this.dragPreviewUnsubscribe=void 0,this.dragPreviewNode=null,this.dragPreviewRef=null)}get dragSource(){return this.dragSourceNode||this.dragSourceRef&&this.dragSourceRef.current}get dragPreview(){return this.dragPreviewNode||this.dragPreviewRef&&this.dragPreviewRef.current}clearDragSource(){this.dragSourceNode=null,this.dragSourceRef=null}clearDragPreview(){this.dragPreviewNode=null,this.dragPreviewRef=null}constructor(e){this.hooks=Mr({dragSource:(e,t)=>{this.clearDragSource(),this.dragSourceOptions=t||null,kr(e)?this.dragSourceRef=e:this.dragSourceNode=e,this.reconnectDragSource()},dragPreview:(e,t)=>{this.clearDragPreview(),this.dragPreviewOptions=t||null,kr(e)?this.dragPreviewRef=e:this.dragPreviewNode=e,this.reconnectDragPreview()}}),this.handlerId=null,this.dragSourceRef=null,this.dragSourceOptionsInternal=null,this.dragPreviewRef=null,this.dragPreviewOptionsInternal=null,this.lastConnectedHandlerId=null,this.lastConnectedDragSource=null,this.lastConnectedDragSourceOptions=null,this.lastConnectedDragPreview=null,this.lastConnectedDragPreviewOptions=null,this.backend=e}},Ir=class{get connectTarget(){return this.dropTarget}reconnect(){let e=this.didHandlerIdChange()||this.didDropTargetChange()||this.didOptionsChange();e&&this.disconnectDropTarget();let t=this.dropTarget;if(this.handlerId){if(!t){this.lastConnectedDropTarget=t;return}e&&(this.lastConnectedHandlerId=this.handlerId,this.lastConnectedDropTarget=t,this.lastConnectedDropTargetOptions=this.dropTargetOptions,this.unsubscribeDropTarget=this.backend.connectDropTarget(this.handlerId,t,this.dropTargetOptions))}}receiveHandlerId(e){e!==this.handlerId&&(this.handlerId=e,this.reconnect())}get dropTargetOptions(){return this.dropTargetOptionsInternal}set dropTargetOptions(e){this.dropTargetOptionsInternal=e}didHandlerIdChange(){return this.lastConnectedHandlerId!==this.handlerId}didDropTargetChange(){return this.lastConnectedDropTarget!==this.dropTarget}didOptionsChange(){return!Or(this.lastConnectedDropTargetOptions,this.dropTargetOptions)}disconnectDropTarget(){this.unsubscribeDropTarget&&=(this.unsubscribeDropTarget(),void 0)}get dropTarget(){return this.dropTargetNode||this.dropTargetRef&&this.dropTargetRef.current}clearDropTarget(){this.dropTargetRef=null,this.dropTargetNode=null}constructor(e){this.hooks=Mr({dropTarget:(e,t)=>{this.clearDropTarget(),this.dropTargetOptions=t,kr(e)?this.dropTargetRef=e:this.dropTargetNode=e,this.reconnect()}}),this.handlerId=null,this.dropTargetRef=null,this.dropTargetOptionsInternal=null,this.lastConnectedHandlerId=null,this.lastConnectedDropTarget=null,this.lastConnectedDropTargetOptions=null,this.backend=e}};function Lr(){let{dragDropManager:e}=(0,H.useContext)(dt);return G(e!=null,`Expected drag drop context`),e}function Rr(e,t){let n=Lr(),r=(0,H.useMemo)(()=>new Fr(n.getBackend()),[n]);return pr(()=>(r.dragSourceOptions=e||null,r.reconnect(),()=>r.disconnectDragSource()),[r,e]),pr(()=>(r.dragPreviewOptions=t||null,r.reconnect(),()=>r.disconnectDragPreview()),[r,t]),r}function zr(){let e=Lr();return(0,H.useMemo)(()=>new Cr(e),[e])}var Br=class{beginDrag(){let e=this.spec,t=this.monitor,n=null;return n=typeof e.item==`object`?e.item:typeof e.item==`function`?e.item(t):{},n??null}canDrag(){let e=this.spec,t=this.monitor;return typeof e.canDrag==`boolean`?e.canDrag:typeof e.canDrag==`function`?e.canDrag(t):!0}isDragging(e,t){let n=this.spec,r=this.monitor,{isDragging:i}=n;return i?i(r):t===e.getSourceId()}endDrag(){let e=this.spec,t=this.monitor,n=this.connector,{end:r}=e;r&&r(t.getItem(),t),n.reconnect()}constructor(e,t,n){this.spec=e,this.monitor=t,this.connector=n}};function Vr(e,t,n){let r=(0,H.useMemo)(()=>new Br(e,t,n),[t,n]);return(0,H.useEffect)(()=>{r.spec=e},[e]),r}function Hr(e){return(0,H.useMemo)(()=>{let t=e.type;return G(t!=null,`spec.type must be defined`),t},[e])}function Ur(e,t,n){let r=Lr(),i=Vr(e,t,n),a=Hr(e);pr(function(){if(a!=null){let[e,o]=Dr(a,i,r);return t.receiveHandlerId(e),n.receiveHandlerId(e),o}},[r,t,n,i,a])}function Wr(e,t){let n=vr(e,t);G(!n.begin,`useDrag::spec.begin was deprecated in v14. Replace spec.begin() with spec.item(). (see more here - https://react-dnd.github.io/react-dnd/docs/api/use-drag)`);let r=zr(),i=Rr(n.options,n.previewOptions);return Ur(n,r,i),[_r(n.collect,r,i),yr(i),br(i)]}function Gr(e){return(0,H.useMemo)(()=>e.hooks.dropTarget(),[e])}function Kr(e){let t=Lr(),n=(0,H.useMemo)(()=>new Ir(t.getBackend()),[t]);return pr(()=>(n.dropTargetOptions=e||null,n.reconnect(),()=>n.disconnectDropTarget()),[e]),n}function qr(){let e=Lr();return(0,H.useMemo)(()=>new Tr(e),[e])}function Jr(e){let{accept:t}=e;return(0,H.useMemo)(()=>(G(e.accept!=null,`accept must be defined`),Array.isArray(t)?t:[t]),[t])}var Yr=class{canDrop(){let e=this.spec,t=this.monitor;return e.canDrop?e.canDrop(t.getItem(),t):!0}hover(){let e=this.spec,t=this.monitor;e.hover&&e.hover(t.getItem(),t)}drop(){let e=this.spec,t=this.monitor;if(e.drop)return e.drop(t.getItem(),t)}constructor(e,t){this.spec=e,this.monitor=t}};function Xr(e,t){let n=(0,H.useMemo)(()=>new Yr(e,t),[t]);return(0,H.useEffect)(()=>{n.spec=e},[e]),n}function Zr(e,t,n){let r=Lr(),i=Xr(e,t),a=Jr(e);pr(function(){let[e,o]=Er(a,i,r);return t.receiveHandlerId(e),n.receiveHandlerId(e),o},[r,t,i,n,a.map(e=>e.toString()).join(`|`)])}function Qr(e,t){let n=vr(e,t),r=qr(),i=Kr(n.options);return Zr(n,r,i),[_r(n.collect,r,i),Gr(i)]}var $r={display:`flex`,alignItems:`center`,p:`6px 8px`,cursor:`pointer`,borderRadius:1,transition:`background-color 0.2s, border 0.2s`,border:`2px dashed transparent`};function ei({children:e,phaseId:t,subPhaseId:n=null,selected:r,isAncestor:i,onClick:a}){let o=se(),[{isOver:s,canDrop:c},l]=Qr(()=>({accept:`knowledge`,drop:e=>{o(Ce({knowledgeId:e.id,source:e.source,target:{phaseId:t,subPhaseId:n}}))},collect:e=>({isOver:e.isOver(),canDrop:e.canDrop()})}),[t,n]);return(0,U.jsx)(z,{ref:l,onClick:a,sx:{...$r,backgroundColor:r?`rgba(25, 118, 210, 0.08)`:i?`action.hover`:`transparent`,color:`text.primary`,borderColor:s?`primary.main`:c?`#ccc`:`transparent`,"&:hover":{backgroundColor:`action.hover`}},children:e})}function ti(){let e=se(),{library:t,selectedPhaseId:n,selectedSubPhaseId:r}=Ne(e=>e.knowledge);return(0,U.jsxs)(p,{sx:{p:2,height:`100%`,display:`flex`,flexDirection:`column`},children:[(0,U.jsx)(a,{variant:`h6`,gutterBottom:!0,children:`① 階層管理エリア`}),(0,U.jsx)(z,{sx:{overflow:`auto`,flexGrow:1,mt:1},children:(0,U.jsx)(z,{sx:{display:`flex`,flexDirection:`column`,gap:`2px`},children:t.map(t=>{let i=n===t.id&&!r,o=n===t.id&&!!r;return(0,U.jsxs)(H.Fragment,{children:[(0,U.jsx)(ei,{phaseId:t.id,selected:i,isAncestor:o,onClick:()=>e(we(t.id)),children:(0,U.jsx)(a,{variant:`body2`,sx:{fontWeight:n===t.id?`bold`:`normal`},children:t.name})}),t.subPhases.map(n=>(0,U.jsx)(z,{sx:{pl:4},children:(0,U.jsx)(ei,{phaseId:t.id,subPhaseId:n.id,selected:r===n.id,isAncestor:!1,onClick:()=>e(_e(n.id)),children:(0,U.jsx)(a,{variant:`body2`,children:n.name})})},n.id))]},t.id)})})})]})}var ni=ti,ri=x((0,U.jsx)(`path`,{d:`M14 2H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8zm2 16H8v-2h8zm0-4H8v-2h8zm-3-5V3.5L18.5 9z`}),`Description`);function ii({knowledge:e,phaseId:r,subPhaseId:i}){let a=se(),{selectedKnowledgeId:o}=Ne(e=>e.knowledge),[{isDragging:s},l]=Wr(()=>({type:`knowledge`,item:{id:e.id,source:{phaseId:r,subPhaseId:i}},collect:e=>({isDragging:!!e.isDragging()})}));return(0,U.jsx)(P,{ref:l,disablePadding:!0,sx:{cursor:`move`,opacity:s?.5:1,bgcolor:`background.paper`,borderRadius:1,mb:.5},children:(0,U.jsxs)(t,{selected:o===e.id,onClick:()=>a(Ee(e.id)),sx:{borderRadius:1},children:[e.type===`task`?(0,U.jsx)(ri,{sx:{mr:1}}):(0,U.jsx)(n,{sx:{mr:1}}),(0,U.jsx)(F,{primary:e.text}),(0,U.jsx)(c,{label:e.type,size:`small`})]})})}function ai({onOpenAiModal:e}){let t=se(),{library:n,selectedPhaseId:r,selectedSubPhaseId:o}=Ne(e=>e.knowledge),s=null;if(o)for(let e of n){let t=e.subPhases.find(e=>e.id===o);if(t){s=t;break}}else r&&(s=n.find(e=>e.id===r));return s?(0,U.jsxs)(p,{sx:{p:2,height:`100%`,display:`flex`,flexDirection:`column`},children:[(0,U.jsxs)(z,{sx:{display:`flex`,justifyContent:`space-between`,alignItems:`center`,mb:1},children:[(0,U.jsxs)(a,{variant:`h6`,gutterBottom:!0,sx:{mb:0},children:[`② 知識リスト: `,s.name]}),(0,U.jsx)(u,{variant:`outlined`,size:`small`,startIcon:(0,U.jsx)(i,{}),onClick:e,children:`AIでフローを生成`})]}),(0,U.jsx)(z,{sx:{overflow:`auto`,flexGrow:1},children:(0,U.jsx)(m,{dense:!0,children:(s.knowledges||[]).map(e=>(0,U.jsx)(ii,{knowledge:e,phaseId:r,subPhaseId:o},e.id))})}),(0,U.jsx)(u,{variant:`contained`,onClick:()=>{t(Le())},sx:{mt:2},children:`新しい知識を追加`})]}):(0,U.jsx)(p,{sx:{p:2,height:`100%`,display:`flex`,alignItems:`center`,justifyContent:`center`},children:(0,U.jsx)(a,{color:`text.secondary`,children:`左のリストからフェーズまたはサブフェーズを選択してください。`})})}var oi=ai,si={id:null,text:``,details:``,type:`task`,options:[]};function ci(){let e=se(),{library:t,selectedPhaseId:n,selectedSubPhaseId:r,selectedKnowledgeId:i,isAddingNewKnowledge:o}=Ne(e=>e.knowledge),[s,c]=(0,H.useState)(si),[d,f]=(0,H.useState)(``),m=(0,H.useRef)(null),h=t.flatMap(e=>[...e.knowledges||[],...e.subPhases.flatMap(e=>e.knowledges)]).find(e=>e.id===i);(0,H.useEffect)(()=>{o?c(si):h&&c(h)},[h,i,o]),(0,H.useEffect)(()=>{if(m.current&&clearTimeout(m.current),!(!o&&!i))return m.current=setTimeout(()=>{if(!s.text.trim())return;let t={phaseId:n,subPhaseId:r,knowledge:s};s.id?e(Re(t)):e(ye(t))},1500),()=>{m.current&&clearTimeout(m.current)}},[s,n,r,o,i,e]);let g=e=>{let{name:t,value:n}=e.target;c(e=>({...e,[t]:n}))},_=()=>{if(d.trim()===``)return;let e={id:`option-${ze()}`,label:d.trim()};c(t=>({...t,options:[...t.options,e]})),f(``)},v=(e,t)=>{c(n=>({...n,options:n.options.map(n=>n.id===e?{...n,label:t}:n)}))},b=e=>{c(t=>({...t,options:t.options.filter(t=>t.id!==e)}))},x=()=>{window.confirm(`この知識を削除しますか？`)&&(e(be({phaseId:n,subPhaseId:r,knowledgeId:s.id})),e(Se()))};if(!n)return(0,U.jsx)(p,{sx:{p:2,height:`100%`,display:`flex`,alignItems:`center`,justifyContent:`center`},children:(0,U.jsx)(a,{color:`text.secondary`,children:`フェーズまたはサブフェーズを選択後、知識を選択または追加してください。`})});if(!o&&!i)return(0,U.jsxs)(p,{sx:{p:2,height:`100%`,display:`flex`,alignItems:`center`,justifyContent:`center`,flexDirection:`column`,gap:1},children:[(0,U.jsx)(a,{color:`text.secondary`,children:`中央のリストから知識を選択するか、`}),(0,U.jsx)(a,{color:`text.secondary`,children:`「新しい知識を追加」ボタンを押してください。`})]});let w=o||!s.id?`③ 新しい知識の追加`:`③ 知識編集エリア`;return(0,U.jsxs)(p,{sx:{p:2,height:`100%`,display:`flex`,flexDirection:`column`},children:[(0,U.jsx)(a,{variant:`h6`,gutterBottom:!0,children:w}),(0,U.jsxs)(z,{sx:{overflow:`auto`,flexGrow:1,pt:1},children:[(0,U.jsx)(y,{label:`知識テキスト`,fullWidth:!0,multiline:!0,rows:4,name:`text`,value:s.text,onChange:g,sx:{mb:2}}),(0,U.jsx)(y,{label:`説明`,fullWidth:!0,multiline:!0,rows:3,name:`details`,value:s.details||``,onChange:g,sx:{mb:2}}),(0,U.jsxs)(T,{row:!0,name:`type`,value:s.type,onChange:g,children:[(0,U.jsx)(S,{value:`task`,control:(0,U.jsx)(C,{}),label:`Task`}),(0,U.jsx)(S,{value:`branch`,control:(0,U.jsx)(C,{}),label:`Branch`})]}),s.type===`branch`&&(0,U.jsxs)(z,{sx:{mt:2},children:[(0,U.jsx)(a,{variant:`subtitle2`,children:`選択肢編集`}),s.options.map(e=>(0,U.jsxs)(z,{sx:{display:`flex`,alignItems:`center`,mb:1},children:[(0,U.jsx)(y,{value:e.label,fullWidth:!0,variant:`outlined`,size:`small`,onChange:t=>v(e.id,t.target.value)}),(0,U.jsx)(l,{onClick:()=>b(e.id),children:(0,U.jsx)(k,{})})]},e.id)),(0,U.jsxs)(z,{sx:{display:`flex`,alignItems:`center`,mt:1},children:[(0,U.jsx)(y,{label:`新しい選択肢ラベル`,fullWidth:!0,value:d,onChange:e=>f(e.target.value),size:`small`}),(0,U.jsx)(l,{onClick:_,children:(0,U.jsx)(j,{})})]})]})]}),(0,U.jsx)(z,{sx:{mt:2,display:`flex`,justifyContent:`flex-end`},children:s.id&&(0,U.jsx)(u,{color:`error`,onClick:x,children:`削除`})})]})}var li=ci,ui=L(ne()),di=!0,fi=`Invariant failed`;function pi(e,t){if(!e){if(di)throw Error(fi);var n=typeof t==`function`?t():t,r=n?`${fi}: ${n}`:fi;throw Error(r)}}var mi=function(e){var t=e.top,n=e.right,r=e.bottom,i=e.left,a=n-i,o=r-t;return{top:t,right:n,bottom:r,left:i,width:a,height:o,x:i,y:t,center:{x:(n+i)/2,y:(r+t)/2}}},hi=function(e,t){return{top:e.top-t.top,left:e.left-t.left,bottom:e.bottom+t.bottom,right:e.right+t.right}},gi=function(e,t){return{top:e.top+t.top,left:e.left+t.left,bottom:e.bottom-t.bottom,right:e.right-t.right}},_i=function(e,t){return{top:e.top+t.y,left:e.left+t.x,bottom:e.bottom+t.y,right:e.right+t.x}},vi={top:0,right:0,bottom:0,left:0},yi=function(e){var t=e.borderBox,n=e.margin,r=n===void 0?vi:n,i=e.border,a=i===void 0?vi:i,o=e.padding,s=o===void 0?vi:o,c=mi(hi(t,r)),l=mi(gi(t,a)),u=mi(gi(l,s));return{marginBox:c,borderBox:mi(t),paddingBox:l,contentBox:u,margin:r,border:a,padding:s}},bi=function(e){var t=e.slice(0,-2);if(e.slice(-2)!==`px`)return 0;var n=Number(t);return isNaN(n)&&pi(!1),n},xi=function(){return{x:window.pageXOffset,y:window.pageYOffset}},Si=function(e,t){var n=e.borderBox,r=e.border,i=e.margin,a=e.padding,o=_i(n,t);return yi({borderBox:o,border:r,margin:i,padding:a})},Ci=function(e,t){return t===void 0&&(t=xi()),Si(e,t)},wi=function(e,t){var n={top:bi(t.marginTop),right:bi(t.marginRight),bottom:bi(t.marginBottom),left:bi(t.marginLeft)},r={top:bi(t.paddingTop),right:bi(t.paddingRight),bottom:bi(t.paddingBottom),left:bi(t.paddingLeft)},i={top:bi(t.borderTopWidth),right:bi(t.borderRightWidth),bottom:bi(t.borderBottomWidth),left:bi(t.borderLeftWidth)};return yi({borderBox:e,margin:n,padding:r,border:i})},Ti=function(e){var t=e.getBoundingClientRect(),n=window.getComputedStyle(e);return wi(t,n)},Ei=function(e){var t=[],n=null,r=function(){t=[...arguments],!n&&(n=requestAnimationFrame(function(){n=null,e.apply(void 0,t)}))};return r.cancel=function(){n&&=(cancelAnimationFrame(n),null)},r};function Di(e,t){}Di.bind(null,`warn`),Di.bind(null,`error`);function Oi(){}function ki(e,t){return{...e,...t}}function Ai(e,t,n){let r=t.map(t=>{let r=ki(n,t.options);return e.addEventListener(t.eventName,t.fn,r),function(){e.removeEventListener(t.eventName,t.fn,r)}});return function(){r.forEach(e=>{e()})}}var ji=`Invariant failed`,Mi=class extends Error{};Mi.prototype.toString=function(){return this.message};function K(e,t){throw new Mi(ji)}var Ni=class extends H.Component{constructor(...e){super(...e),this.callbacks=null,this.unbind=Oi,this.onWindowError=e=>{let t=this.getCallbacks();t.isDragging()&&t.tryAbort(),e.error instanceof Mi&&e.preventDefault()},this.getCallbacks=()=>{if(!this.callbacks)throw Error(`Unable to find AppCallbacks in <ErrorBoundary/>`);return this.callbacks},this.setCallbacks=e=>{this.callbacks=e}}componentDidMount(){this.unbind=Ai(window,[{eventName:`error`,fn:this.onWindowError}])}componentDidCatch(e){if(e instanceof Mi){this.setState({});return}throw e}componentWillUnmount(){this.unbind()}render(){return this.props.children(this.setCallbacks)}},Pi=`
  Press space bar to start a drag.
  When dragging you can use the arrow keys to move the item around and escape to cancel.
  Some screen readers may require you to be in focus mode or to use your pass through key
`,Fi=e=>e+1,Ii=e=>`
  You have lifted an item in position ${Fi(e.source.index)}
`,Li=(e,t)=>{let n=e.droppableId===t.droppableId,r=Fi(e.index),i=Fi(t.index);return n?`
      You have moved the item from position ${r}
      to position ${i}
    `:`
    You have moved the item from position ${r}
    in list ${e.droppableId}
    to list ${t.droppableId}
    in position ${i}
  `},Ri=(e,t,n)=>t.droppableId===n.droppableId?`
      The item ${e}
      has been combined with ${n.draggableId}`:`
      The item ${e}
      in list ${t.droppableId}
      has been combined with ${n.draggableId}
      in list ${n.droppableId}
    `,zi=e=>{let t=e.destination;if(t)return Li(e.source,t);let n=e.combine;return n?Ri(e.draggableId,e.source,n):`You are over an area that cannot be dropped on`},Bi=e=>`
  The item has returned to its starting position
  of ${Fi(e.index)}
`,Vi={dragHandleUsageInstructions:Pi,onDragStart:Ii,onDragUpdate:zi,onDragEnd:e=>{if(e.reason===`CANCEL`)return`
      Movement cancelled.
      ${Bi(e.source)}
    `;let t=e.destination,n=e.combine;return t?`
      You have dropped the item.
      ${Li(e.source,t)}
    `:n?`
      You have dropped the item.
      ${Ri(e.draggableId,e.source,n)}
    `:`
    The item has been dropped while not over a drop area.
    ${Bi(e.source)}
  `}};function Hi(e,t){return!!(e===t||Number.isNaN(e)&&Number.isNaN(t))}function Ui(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(!Hi(e[n],t[n]))return!1;return!0}function q(e,t){let n=(0,H.useState)(()=>({inputs:t,result:e()}))[0],r=(0,H.useRef)(!0),i=(0,H.useRef)(n),a=r.current||t&&i.current.inputs&&Ui(t,i.current.inputs)?i.current:{inputs:t,result:e()};return(0,H.useEffect)(()=>{r.current=!1,i.current=a},[a]),a.result}function J(e,t){return q(()=>e,t)}var Wi={x:0,y:0},Gi=(e,t)=>({x:e.x+t.x,y:e.y+t.y}),Ki=(e,t)=>({x:e.x-t.x,y:e.y-t.y}),qi=(e,t)=>e.x===t.x&&e.y===t.y,Ji=e=>({x:e.x===0?0:-e.x,y:e.y===0?0:-e.y}),Yi=(e,t,n=0)=>e===`x`?{x:t,y:n}:{x:n,y:t},Xi=(e,t)=>Math.sqrt((t.x-e.x)**2+(t.y-e.y)**2),Zi=(e,t)=>Math.min(...t.map(t=>Xi(e,t))),Qi=e=>t=>({x:e(t.x),y:e(t.y)}),$i=(e,t)=>{let n=mi({top:Math.max(t.top,e.top),right:Math.min(t.right,e.right),bottom:Math.min(t.bottom,e.bottom),left:Math.max(t.left,e.left)});return n.width<=0||n.height<=0?null:n},ea=(e,t)=>({top:e.top+t.y,left:e.left+t.x,bottom:e.bottom+t.y,right:e.right+t.x}),ta=e=>[{x:e.left,y:e.top},{x:e.right,y:e.top},{x:e.left,y:e.bottom},{x:e.right,y:e.bottom}],na={top:0,right:0,bottom:0,left:0},ra=(e,t)=>t?ea(e,t.scroll.diff.displacement):e,ia=(e,t,n)=>n&&n.increasedBy?{...e,[t.end]:e[t.end]+n.increasedBy[t.line]}:e,aa=(e,t)=>t&&t.shouldClipSubject?$i(t.pageMarginBox,e):mi(e),oa=({page:e,withPlaceholder:t,axis:n,frame:r})=>{let i=ra(e.marginBox,r),a=ia(i,n,t),o=aa(a,r);return{page:e,withPlaceholder:t,active:o}},sa=(e,t)=>{!e.frame&&K();let n=e.frame,r=Ki(t,n.scroll.initial),i=Ji(r),a={...n,scroll:{initial:n.scroll.initial,current:t,diff:{value:r,displacement:i},max:n.scroll.max}},o=oa({page:e.subject.page,withPlaceholder:e.subject.withPlaceholder,axis:e.axis,frame:a});return{...e,frame:a,subject:o}};function ca(e,t=Ui){let n=null;function r(...r){if(n&&n.lastThis===this&&t(r,n.lastArgs))return n.lastResult;let i=e.apply(this,r);return n={lastResult:i,lastArgs:r,lastThis:this},i}return r.clear=function(){n=null},r}var la=ca(e=>e.reduce((e,t)=>(e[t.descriptor.id]=t,e),{})),ua=ca(e=>e.reduce((e,t)=>(e[t.descriptor.id]=t,e),{})),da=ca(e=>Object.values(e)),fa=ca(e=>Object.values(e)),pa=ca((e,t)=>fa(t).filter(t=>e===t.descriptor.droppableId).sort((e,t)=>e.descriptor.index-t.descriptor.index));function ma(e){return e.at&&e.at.type===`REORDER`?e.at.destination:null}function ha(e){return e.at&&e.at.type===`COMBINE`?e.at.combine:null}var ga=ca((e,t)=>t.filter(t=>t.descriptor.id!==e.descriptor.id)),_a=({isMovingForward:e,draggable:t,destination:n,insideDestination:r,previousImpact:i})=>{if(!n.isCombineEnabled||!ma(i))return null;function a(e){let t={type:`COMBINE`,combine:{draggableId:e,droppableId:n.descriptor.id}};return{...i,at:t}}let o=i.displaced.all,s=o.length?o[0]:null;if(e)return s?a(s):null;let c=ga(t,r);if(!s){if(!c.length)return null;let e=c[c.length-1];return a(e.descriptor.id)}let l=c.findIndex(e=>e.descriptor.id===s);l===-1&&K();let u=l-1;if(u<0)return null;let d=c[u];return a(d.descriptor.id)},va=(e,t)=>e.descriptor.droppableId===t.descriptor.id,ya={point:Wi,value:0},ba={invisible:{},visible:{},all:[]},xa={displaced:ba,displacedBy:ya,at:null},Sa=(e,t)=>n=>e<=n&&n<=t,Ca=e=>{let t=Sa(e.top,e.bottom),n=Sa(e.left,e.right);return r=>{if(t(r.top)&&t(r.bottom)&&n(r.left)&&n(r.right))return!0;let i=t(r.top)||t(r.bottom),a=n(r.left)||n(r.right);if(i&&a)return!0;let o=r.top<e.top&&r.bottom>e.bottom,s=r.left<e.left&&r.right>e.right;return o&&s?!0:o&&a||s&&i}},wa=e=>{let t=Sa(e.top,e.bottom),n=Sa(e.left,e.right);return e=>t(e.top)&&t(e.bottom)&&n(e.left)&&n(e.right)},Ta={direction:`vertical`,line:`y`,crossAxisLine:`x`,start:`top`,end:`bottom`,size:`height`,crossAxisStart:`left`,crossAxisEnd:`right`,crossAxisSize:`width`},Ea={direction:`horizontal`,line:`x`,crossAxisLine:`y`,start:`left`,end:`right`,size:`width`,crossAxisStart:`top`,crossAxisEnd:`bottom`,crossAxisSize:`height`},Da=e=>t=>{let n=Sa(t.top,t.bottom),r=Sa(t.left,t.right);return t=>e===Ta?n(t.top)&&n(t.bottom):r(t.left)&&r(t.right)},Oa=(e,t)=>{let n=t.frame?t.frame.scroll.diff.displacement:Wi;return ea(e,n)},ka=(e,t,n)=>t.subject.active?n(t.subject.active)(e):!1,Aa=(e,t,n)=>n(t)(e),ja=({target:e,destination:t,viewport:n,withDroppableDisplacement:r,isVisibleThroughFrameFn:i})=>{let a=r?Oa(e,t):e;return ka(a,t,i)&&Aa(a,n,i)},Ma=e=>ja({...e,isVisibleThroughFrameFn:Ca}),Na=e=>ja({...e,isVisibleThroughFrameFn:wa}),Pa=e=>ja({...e,isVisibleThroughFrameFn:Da(e.destination.axis)}),Fa=(e,t,n)=>{if(typeof n==`boolean`)return n;if(!t)return!0;let{invisible:r,visible:i}=t;if(r[e])return!1;let a=i[e];return a?a.shouldAnimate:!0};function Ia(e,t){let n=e.page.marginBox,r={top:t.point.y,right:0,bottom:0,left:t.point.x};return mi(hi(n,r))}function La({afterDragging:e,destination:t,displacedBy:n,viewport:r,forceShouldAnimate:i,last:a}){return e.reduce(function(e,o){let s=Ia(o,n),c=o.descriptor.id;if(e.all.push(c),!Ma({target:s,destination:t,viewport:r,withDroppableDisplacement:!0}))return e.invisible[o.descriptor.id]=!0,e;let l=Fa(c,a,i),u={draggableId:c,shouldAnimate:l};return e.visible[c]=u,e},{all:[],visible:{},invisible:{}})}function Ra(e,t){if(!e.length)return 0;let n=e[e.length-1].descriptor.index;return t.inHomeList?n:n+1}function za({insideDestination:e,inHomeList:t,displacedBy:n,destination:r}){let i=Ra(e,{inHomeList:t});return{displaced:ba,displacedBy:n,at:{type:`REORDER`,destination:{droppableId:r.descriptor.id,index:i}}}}function Ba({draggable:e,insideDestination:t,destination:n,viewport:r,displacedBy:i,last:a,index:o,forceShouldAnimate:s}){let c=va(e,n);if(o==null)return za({insideDestination:t,inHomeList:c,displacedBy:i,destination:n});let l=t.find(e=>e.descriptor.index===o);if(!l)return za({insideDestination:t,inHomeList:c,displacedBy:i,destination:n});let u=ga(e,t),d=t.indexOf(l),f=u.slice(d);return{displaced:La({afterDragging:f,destination:n,displacedBy:i,last:a,viewport:r.frame,forceShouldAnimate:s}),displacedBy:i,at:{type:`REORDER`,destination:{droppableId:n.descriptor.id,index:o}}}}function Va(e,t){return!!t.effected[e]}var Ha=({isMovingForward:e,destination:t,draggables:n,combine:r,afterCritical:i})=>{if(!t.isCombineEnabled)return null;let a=r.draggableId,o=n[a].descriptor.index;return Va(a,i)?e?o:o-1:e?o+1:o},Ua=({isMovingForward:e,isInHomeList:t,insideDestination:n,location:r})=>{if(!n.length)return null;let i=r.index,a=e?i+1:i-1,o=n[0].descriptor.index,s=n[n.length-1].descriptor.index,c=t?s:s+1;return a<o||a>c?null:a},Wa=({isMovingForward:e,isInHomeList:t,draggable:n,draggables:r,destination:i,insideDestination:a,previousImpact:o,viewport:s,afterCritical:c})=>{let l=o.at;if(!l&&K(),l.type===`REORDER`){let r=Ua({isMovingForward:e,isInHomeList:t,location:l.destination,insideDestination:a});return r==null?null:Ba({draggable:n,insideDestination:a,destination:i,viewport:s,last:o.displaced,displacedBy:o.displacedBy,index:r})}let u=Ha({isMovingForward:e,destination:i,displaced:o.displaced,draggables:r,combine:l.combine,afterCritical:c});return u==null?null:Ba({draggable:n,insideDestination:a,destination:i,viewport:s,last:o.displaced,displacedBy:o.displacedBy,index:u})},Ga=({displaced:e,afterCritical:t,combineWith:n,displacedBy:r})=>{let i=!!(e.visible[n]||e.invisible[n]);return Va(n,t)?i?Wi:Ji(r.point):i?r.point:Wi},Ka=({afterCritical:e,impact:t,draggables:n})=>{let r=ha(t);!r&&K();let i=r.draggableId,a=n[i].page.borderBox.center,o=Ga({displaced:t.displaced,afterCritical:e,combineWith:i,displacedBy:t.displacedBy});return Gi(a,o)},qa=(e,t)=>t.margin[e.start]+t.borderBox[e.size]/2,Ja=(e,t)=>t.margin[e.end]+t.borderBox[e.size]/2,Ya=(e,t,n)=>t[e.crossAxisStart]+n.margin[e.crossAxisStart]+n.borderBox[e.crossAxisSize]/2,Xa=({axis:e,moveRelativeTo:t,isMoving:n})=>Yi(e.line,t.marginBox[e.end]+qa(e,n),Ya(e,t.marginBox,n)),Za=({axis:e,moveRelativeTo:t,isMoving:n})=>Yi(e.line,t.marginBox[e.start]-Ja(e,n),Ya(e,t.marginBox,n)),Qa=({axis:e,moveInto:t,isMoving:n})=>Yi(e.line,t.contentBox[e.start]+qa(e,n),Ya(e,t.contentBox,n)),$a=({impact:e,draggable:t,draggables:n,droppable:r,afterCritical:i})=>{let a=pa(r.descriptor.id,n),o=t.page,s=r.axis;if(!a.length)return Qa({axis:s,moveInto:r.page,isMoving:o});let{displaced:c,displacedBy:l}=e,u=c.all[0];if(u){let e=n[u];if(Va(u,i))return Za({axis:s,moveRelativeTo:e.page,isMoving:o});let t=Si(e.page,l.point);return Za({axis:s,moveRelativeTo:t,isMoving:o})}let d=a[a.length-1];if(d.descriptor.id===t.descriptor.id)return o.borderBox.center;if(Va(d.descriptor.id,i)){let e=Si(d.page,Ji(i.displacedBy.point));return Xa({axis:s,moveRelativeTo:e,isMoving:o})}return Xa({axis:s,moveRelativeTo:d.page,isMoving:o})},eo=(e,t)=>{let n=e.frame;return n?Gi(t,n.scroll.diff.displacement):t},to=({impact:e,draggable:t,droppable:n,draggables:r,afterCritical:i})=>{let a=t.page.borderBox.center,o=e.at;return!n||!o?a:o.type===`REORDER`?$a({impact:e,draggable:t,draggables:r,droppable:n,afterCritical:i}):Ka({impact:e,draggables:r,afterCritical:i})},no=e=>{let t=to(e),n=e.droppable;return n?eo(n,t):t},ro=(e,t)=>{let n=Ki(t,e.scroll.initial),r=Ji(n);return{frame:mi({top:t.y,bottom:t.y+e.frame.height,left:t.x,right:t.x+e.frame.width}),scroll:{initial:e.scroll.initial,max:e.scroll.max,current:t,diff:{value:n,displacement:r}}}};function io(e,t){return e.map(e=>t[e])}function ao(e,t){for(let n=0;n<t.length;n++){let r=t[n].visible[e];if(r)return r}return null}var oo=({impact:e,viewport:t,destination:n,draggables:r,maxScrollChange:i})=>{let a=ro(t,Gi(t.scroll.current,i)),o=n.frame?sa(n,Gi(n.frame.scroll.current,i)):n,s=e.displaced,c=La({afterDragging:io(s.all,r),destination:n,displacedBy:e.displacedBy,viewport:a.frame,last:s,forceShouldAnimate:!1}),l=La({afterDragging:io(s.all,r),destination:o,displacedBy:e.displacedBy,viewport:t.frame,last:s,forceShouldAnimate:!1}),u={},d={},f=[s,c,l];return s.all.forEach(e=>{let t=ao(e,f);if(t){d[e]=t;return}u[e]=!0}),{...e,displaced:{all:s.all,invisible:u,visible:d}}},so=(e,t)=>Gi(e.scroll.diff.displacement,t),co=({pageBorderBoxCenter:e,draggable:t,viewport:n})=>{let r=so(n,e),i=Ki(r,t.page.borderBox.center);return Gi(t.client.borderBox.center,i)},lo=({draggable:e,destination:t,newPageBorderBoxCenter:n,viewport:r,withDroppableDisplacement:i,onlyOnMainAxis:a=!1})=>{let o=Ki(n,e.page.borderBox.center),s={target:ea(e.page.borderBox,o),destination:t,withDroppableDisplacement:i,viewport:r};return a?Pa(s):Na(s)},uo=({isMovingForward:e,draggable:t,destination:n,draggables:r,previousImpact:i,viewport:a,previousPageBorderBoxCenter:o,previousClientSelection:s,afterCritical:c})=>{if(!n.isEnabled)return null;let l=pa(n.descriptor.id,r),u=va(t,n),d=_a({isMovingForward:e,draggable:t,destination:n,insideDestination:l,previousImpact:i})||Wa({isMovingForward:e,isInHomeList:u,draggable:t,draggables:r,destination:n,insideDestination:l,previousImpact:i,viewport:a,afterCritical:c});if(!d)return null;let f=no({impact:d,draggable:t,droppable:n,draggables:r,afterCritical:c});if(lo({draggable:t,destination:n,newPageBorderBoxCenter:f,viewport:a.frame,withDroppableDisplacement:!1,onlyOnMainAxis:!0}))return{clientSelection:co({pageBorderBoxCenter:f,draggable:t,viewport:a}),impact:d,scrollJumpRequest:null};let p=Ki(f,o),m=oo({impact:d,viewport:a,destination:n,draggables:r,maxScrollChange:p});return{clientSelection:s,impact:m,scrollJumpRequest:p}},fo=e=>{let t=e.subject.active;return!t&&K(),t},po=({isMovingForward:e,pageBorderBoxCenter:t,source:n,droppables:r,viewport:i})=>{let a=n.subject.active;if(!a)return null;let o=n.axis,s=Sa(a[o.start],a[o.end]),c=da(r).filter(e=>e!==n).filter(e=>e.isEnabled).filter(e=>!!e.subject.active).filter(e=>Ca(i.frame)(fo(e))).filter(t=>{let n=fo(t);return e?a[o.crossAxisEnd]<n[o.crossAxisEnd]:n[o.crossAxisStart]<a[o.crossAxisStart]}).filter(e=>{let t=fo(e),n=Sa(t[o.start],t[o.end]);return s(t[o.start])||s(t[o.end])||n(a[o.start])||n(a[o.end])}).sort((t,n)=>{let r=fo(t)[o.crossAxisStart],i=fo(n)[o.crossAxisStart];return e?r-i:i-r}).filter((e,t,n)=>fo(e)[o.crossAxisStart]===fo(n[0])[o.crossAxisStart]);if(!c.length)return null;if(c.length===1)return c[0];let l=c.filter(e=>Sa(fo(e)[o.start],fo(e)[o.end])(t[o.line]));return l.length===1?l[0]:l.length>1?l.sort((e,t)=>fo(e)[o.start]-fo(t)[o.start])[0]:c.sort((e,n)=>{let r=Zi(t,ta(fo(e))),i=Zi(t,ta(fo(n)));return r===i?fo(e)[o.start]-fo(n)[o.start]:r-i})[0]},mo=(e,t)=>{let n=e.page.borderBox.center;return Va(e.descriptor.id,t)?Ki(n,t.displacedBy.point):n},ho=(e,t)=>{let n=e.page.borderBox;return Va(e.descriptor.id,t)?ea(n,Ji(t.displacedBy.point)):n},go=({pageBorderBoxCenter:e,viewport:t,destination:n,insideDestination:r,afterCritical:i})=>r.filter(e=>Na({target:ho(e,i),destination:n,viewport:t.frame,withDroppableDisplacement:!0})).sort((t,r)=>{let a=Xi(e,eo(n,mo(t,i))),o=Xi(e,eo(n,mo(r,i)));return a<o?-1:o<a?1:t.descriptor.index-r.descriptor.index})[0]||null,_o=ca(function(e,t){let n=t[e.line];return{value:n,point:Yi(e.line,n)}}),vo=(e,t,n)=>{let r=e.axis;if(e.descriptor.mode===`virtual`)return Yi(r.line,t[r.line]);let i=e.subject.page.contentBox[r.size],a=pa(e.descriptor.id,n).reduce((e,t)=>e+t.client.marginBox[r.size],0)+t[r.line]-i;return a<=0?null:Yi(r.line,a)},yo=(e,t)=>({...e,scroll:{...e.scroll,max:t}}),bo=(e,t,n)=>{let r=e.frame;va(t,e)&&K(),e.subject.withPlaceholder&&K();let i=_o(e.axis,t.displaceBy).point,a=vo(e,i,n),o={placeholderSize:i,increasedBy:a,oldFrameMaxScroll:e.frame?e.frame.scroll.max:null};if(!r){let t=oa({page:e.subject.page,withPlaceholder:o,axis:e.axis,frame:e.frame});return{...e,subject:t}}let s=a?Gi(r.scroll.max,a):r.scroll.max,c=yo(r,s),l=oa({page:e.subject.page,withPlaceholder:o,axis:e.axis,frame:c});return{...e,subject:l,frame:c}},xo=e=>{let t=e.subject.withPlaceholder;!t&&K();let n=e.frame;if(!n){let t=oa({page:e.subject.page,axis:e.axis,frame:null,withPlaceholder:null});return{...e,subject:t}}let r=t.oldFrameMaxScroll;!r&&K();let i=yo(n,r),a=oa({page:e.subject.page,axis:e.axis,frame:i,withPlaceholder:null});return{...e,subject:a,frame:i}},So=({previousPageBorderBoxCenter:e,moveRelativeTo:t,insideDestination:n,draggable:r,draggables:i,destination:a,viewport:o,afterCritical:s})=>{if(!t){if(n.length)return null;let e={displaced:ba,displacedBy:ya,at:{type:`REORDER`,destination:{droppableId:a.descriptor.id,index:0}}},t=no({impact:e,draggable:r,droppable:a,draggables:i,afterCritical:s}),c=va(r,a)?a:bo(a,r,i);return lo({draggable:r,destination:c,newPageBorderBoxCenter:t,viewport:o.frame,withDroppableDisplacement:!1,onlyOnMainAxis:!0})?e:null}let c=e[a.axis.line]<=t.page.borderBox.center[a.axis.line],l=(()=>{let e=t.descriptor.index;return t.descriptor.id===r.descriptor.id||c?e:e+1})(),u=_o(a.axis,r.displaceBy);return Ba({draggable:r,insideDestination:n,destination:a,viewport:o,displacedBy:u,last:ba,index:l})},Co=({isMovingForward:e,previousPageBorderBoxCenter:t,draggable:n,isOver:r,draggables:i,droppables:a,viewport:o,afterCritical:s})=>{let c=po({isMovingForward:e,pageBorderBoxCenter:t,source:r,droppables:a,viewport:o});if(!c)return null;let l=pa(c.descriptor.id,i),u=go({pageBorderBoxCenter:t,viewport:o,destination:c,insideDestination:l,afterCritical:s}),d=So({previousPageBorderBoxCenter:t,destination:c,draggable:n,draggables:i,moveRelativeTo:u,insideDestination:l,viewport:o,afterCritical:s});if(!d)return null;let f=no({impact:d,draggable:n,droppable:c,draggables:i,afterCritical:s});return{clientSelection:co({pageBorderBoxCenter:f,draggable:n,viewport:o}),impact:d,scrollJumpRequest:null}},wo=e=>{let t=e.at;return t?t.type===`REORDER`?t.destination.droppableId:t.combine.droppableId:null},To=(e,t)=>{let n=wo(e);return n?t[n]:null},Eo=({state:e,type:t})=>{let n=To(e.impact,e.dimensions.droppables),r=!!n,i=e.dimensions.droppables[e.critical.droppable.id],a=n||i,o=a.axis.direction,s=o===`vertical`&&(t===`MOVE_UP`||t===`MOVE_DOWN`)||o===`horizontal`&&(t===`MOVE_LEFT`||t===`MOVE_RIGHT`);if(s&&!r)return null;let c=t===`MOVE_DOWN`||t===`MOVE_RIGHT`,l=e.dimensions.draggables[e.critical.draggable.id],u=e.current.page.borderBoxCenter,{draggables:d,droppables:f}=e.dimensions;return s?uo({isMovingForward:c,previousPageBorderBoxCenter:u,draggable:l,destination:a,draggables:d,viewport:e.viewport,previousClientSelection:e.current.client.selection,previousImpact:e.impact,afterCritical:e.afterCritical}):Co({isMovingForward:c,previousPageBorderBoxCenter:u,draggable:l,isOver:a,draggables:d,droppables:f,viewport:e.viewport,afterCritical:e.afterCritical})};function Do(e){return e.phase===`DRAGGING`||e.phase===`COLLECTING`}function Oo(e){let t=Sa(e.top,e.bottom),n=Sa(e.left,e.right);return function(e){return t(e.y)&&n(e.x)}}function ko(e,t){return e.left<t.right&&e.right>t.left&&e.top<t.bottom&&e.bottom>t.top}function Ao({pageBorderBox:e,draggable:t,candidates:n}){let r=t.page.borderBox.center,i=n.map(t=>{let n=t.axis,i=Yi(t.axis.line,e.center[n.line],t.page.borderBox.center[n.crossAxisLine]);return{id:t.descriptor.id,distance:Xi(r,i)}}).sort((e,t)=>t.distance-e.distance);return i[0]?i[0].id:null}function jo({pageBorderBox:e,draggable:t,droppables:n}){let r=da(n).filter(t=>{if(!t.isEnabled)return!1;let n=t.subject.active;if(!n||!ko(e,n))return!1;if(Oo(n)(e.center))return!0;let r=t.axis,i=n.center[r.crossAxisLine],a=e[r.crossAxisStart],o=e[r.crossAxisEnd],s=Sa(n[r.crossAxisStart],n[r.crossAxisEnd]),c=s(a),l=s(o);return!c&&!l?!0:c?a<i:o>i});return r.length?r.length===1?r[0].descriptor.id:Ao({pageBorderBox:e,draggable:t,candidates:r}):null}var Mo=(e,t)=>mi(ea(e,t)),No=(e,t)=>{let n=e.frame;return n?Mo(t,n.scroll.diff.value):t};function Po({displaced:e,id:t}){return!!(e.visible[t]||e.invisible[t])}function Fo({draggable:e,closest:t,inHomeList:n}){return t?n&&t.descriptor.index>e.descriptor.index?t.descriptor.index-1:t.descriptor.index:null}var Io=({pageBorderBoxWithDroppableScroll:e,draggable:t,destination:n,insideDestination:r,last:i,viewport:a,afterCritical:o})=>{let s=n.axis,c=_o(n.axis,t.displaceBy),l=c.value,u=e[s.start],d=e[s.end],f=ga(t,r).find(e=>{let t=e.descriptor.id,n=e.page.borderBox.center[s.line],r=Va(t,o),a=Po({displaced:i,id:t});return r?a?d<=n:u<n-l:a?d<=n+l:u<n})||null,p=Fo({draggable:t,closest:f,inHomeList:va(t,n)});return Ba({draggable:t,insideDestination:r,destination:n,viewport:a,last:i,displacedBy:c,index:p})},Lo=4,Ro=({draggable:e,pageBorderBoxWithDroppableScroll:t,previousImpact:n,destination:r,insideDestination:i,afterCritical:a})=>{if(!r.isCombineEnabled)return null;let o=r.axis,s=_o(r.axis,e.displaceBy),c=s.value,l=t[o.start],u=t[o.end],d=ga(e,i).find(e=>{let t=e.descriptor.id,r=e.page.borderBox,i=r[o.size]/Lo,s=Va(t,a),d=Po({displaced:n.displaced,id:t});return s?d?u>r[o.start]+i&&u<r[o.end]-i:l>r[o.start]-c+i&&l<r[o.end]-c-i:d?u>r[o.start]+c+i&&u<r[o.end]+c-i:l>r[o.start]+i&&l<r[o.end]-i});return d?{displacedBy:s,displaced:n.displaced,at:{type:`COMBINE`,combine:{draggableId:d.descriptor.id,droppableId:r.descriptor.id}}}:null},zo=({pageOffset:e,draggable:t,draggables:n,droppables:r,previousImpact:i,viewport:a,afterCritical:o})=>{let s=Mo(t.page.borderBox,e),c=jo({pageBorderBox:s,draggable:t,droppables:r});if(!c)return xa;let l=r[c],u=pa(l.descriptor.id,n),d=No(l,s);return Ro({pageBorderBoxWithDroppableScroll:d,draggable:t,previousImpact:i,destination:l,insideDestination:u,afterCritical:o})||Io({pageBorderBoxWithDroppableScroll:d,draggable:t,destination:l,insideDestination:u,last:i.displaced,viewport:a,afterCritical:o})},Bo=(e,t)=>({...e,[t.descriptor.id]:t}),Vo=({previousImpact:e,impact:t,droppables:n})=>{let r=wo(e),i=wo(t);if(!r||r===i)return n;let a=n[r];if(!a.subject.withPlaceholder)return n;let o=xo(a);return Bo(n,o)},Ho=({draggable:e,draggables:t,droppables:n,previousImpact:r,impact:i})=>{let a=Vo({previousImpact:r,impact:i,droppables:n}),o=wo(i);if(!o)return a;let s=n[o];if(va(e,s)||s.subject.withPlaceholder)return a;let c=bo(s,e,t);return Bo(a,c)},Uo=({state:e,clientSelection:t,dimensions:n,viewport:r,impact:i,scrollJumpRequest:a})=>{let o=r||e.viewport,s=n||e.dimensions,c=t||e.current.client.selection,l=Ki(c,e.initial.client.selection),u={offset:l,selection:c,borderBoxCenter:Gi(e.initial.client.borderBoxCenter,l)},d={selection:Gi(u.selection,o.scroll.current),borderBoxCenter:Gi(u.borderBoxCenter,o.scroll.current),offset:Gi(u.offset,o.scroll.diff.value)},f={client:u,page:d};if(e.phase===`COLLECTING`)return{...e,dimensions:s,viewport:o,current:f};let p=s.draggables[e.critical.draggable.id],m=i||zo({pageOffset:d.offset,draggable:p,draggables:s.draggables,droppables:s.droppables,previousImpact:e.impact,viewport:o,afterCritical:e.afterCritical}),h=Ho({draggable:p,impact:m,previousImpact:e.impact,draggables:s.draggables,droppables:s.droppables});return{...e,current:f,dimensions:{draggables:s.draggables,droppables:h},impact:m,viewport:o,scrollJumpRequest:a||null,forceShouldAnimate:a?!1:null}};function Wo(e,t){return e.map(e=>t[e])}var Go=({impact:e,viewport:t,draggables:n,destination:r,forceShouldAnimate:i})=>{let a=e.displaced,o=Wo(a.all,n),s=La({afterDragging:o,destination:r,displacedBy:e.displacedBy,viewport:t.frame,forceShouldAnimate:i,last:a});return{...e,displaced:s}},Ko=({impact:e,draggable:t,droppable:n,draggables:r,viewport:i,afterCritical:a})=>{let o=no({impact:e,draggable:t,draggables:r,droppable:n,afterCritical:a});return co({pageBorderBoxCenter:o,draggable:t,viewport:i})},qo=({state:e,dimensions:t,viewport:n})=>{e.movementMode!==`SNAP`&&K();let r=e.impact,i=n||e.viewport,a=t||e.dimensions,{draggables:o,droppables:s}=a,c=o[e.critical.draggable.id],l=wo(r);!l&&K();let u=s[l],d=Go({impact:r,viewport:i,destination:u,draggables:o}),f=Ko({impact:d,draggable:c,droppable:u,draggables:o,viewport:i,afterCritical:e.afterCritical});return Uo({impact:d,clientSelection:f,state:e,dimensions:a,viewport:i})},Jo=e=>({index:e.index,droppableId:e.droppableId}),Yo=({draggable:e,home:t,draggables:n,viewport:r})=>{let i=_o(t.axis,e.displaceBy),a=pa(t.descriptor.id,n),o=a.indexOf(e);o===-1&&K();let s=a.slice(o+1),c=s.reduce((e,t)=>(e[t.descriptor.id]=!0,e),{}),l={inVirtualList:t.descriptor.mode===`virtual`,displacedBy:i,effected:c};return{impact:{displaced:La({afterDragging:s,destination:t,displacedBy:i,last:null,viewport:r.frame,forceShouldAnimate:!1}),displacedBy:i,at:{type:`REORDER`,destination:Jo(e.descriptor)}},afterCritical:l}},Xo=(e,t)=>({draggables:e.draggables,droppables:Bo(e.droppables,t)}),Zo=({draggable:e,offset:t,initialWindowScroll:n})=>{let r=Si(e.client,t),i=Ci(r,n);return{...e,placeholder:{...e.placeholder,client:r},client:r,page:i}},Qo=e=>{let t=e.frame;return!t&&K(),t},$o=({additions:e,updatedDroppables:t,viewport:n})=>{let r=n.scroll.diff.value;return e.map(e=>{let i=e.descriptor.droppableId,a=t[i],o=Qo(a).scroll.diff.value,s=Gi(r,o);return Zo({draggable:e,offset:s,initialWindowScroll:n.scroll.initial})})},es=({state:e,published:t})=>{let n=t.modified.map(t=>{let n=e.dimensions.droppables[t.droppableId];return sa(n,t.scroll)}),r={...e.dimensions.droppables,...la(n)},i=ua($o({additions:t.additions,updatedDroppables:r,viewport:e.viewport})),a={...e.dimensions.draggables,...i};t.removals.forEach(e=>{delete a[e]});let o={droppables:r,draggables:a},s=wo(e.impact),c=s?o.droppables[s]:null,l=o.draggables[e.critical.draggable.id],u=o.droppables[e.critical.droppable.id],{impact:d,afterCritical:f}=Yo({draggable:l,home:u,draggables:a,viewport:e.viewport}),p=c&&c.isCombineEnabled?e.impact:d,m=zo({pageOffset:e.current.page.offset,draggable:o.draggables[e.critical.draggable.id],draggables:o.draggables,droppables:o.droppables,previousImpact:p,viewport:e.viewport,afterCritical:f}),h={...e,phase:`DRAGGING`,impact:m,onLiftImpact:d,dimensions:o,afterCritical:f,forceShouldAnimate:!1};return e.phase===`COLLECTING`?h:{...h,phase:`DROP_PENDING`,reason:e.reason,isWaiting:!1}},ts=e=>e.movementMode===`SNAP`,ns=(e,t,n)=>{let r=Xo(e.dimensions,t);return!ts(e)||n?Uo({state:e,dimensions:r}):qo({state:e,dimensions:r})};function rs(e){return e.isDragging&&e.movementMode===`SNAP`?{...e,scrollJumpRequest:null}:e}var os={phase:`IDLE`,completed:null,shouldFlush:!1},ss=(e=os,t)=>{if(t.type===`FLUSH`)return{...os,shouldFlush:!0};if(t.type===`INITIAL_PUBLISH`){e.phase!==`IDLE`&&K();let{critical:n,clientSelection:r,viewport:i,dimensions:a,movementMode:o}=t.payload,s=a.draggables[n.draggable.id],c=a.droppables[n.droppable.id],l={selection:r,borderBoxCenter:s.client.borderBox.center,offset:Wi},u={client:l,page:{selection:Gi(l.selection,i.scroll.initial),borderBoxCenter:Gi(l.selection,i.scroll.initial),offset:Gi(l.selection,i.scroll.diff.value)}},d=da(a.droppables).every(e=>!e.isFixedOnPage),{impact:f,afterCritical:p}=Yo({draggable:s,home:c,draggables:a.draggables,viewport:i});return{phase:`DRAGGING`,isDragging:!0,critical:n,movementMode:o,dimensions:a,initial:u,current:u,isWindowScrollAllowed:d,impact:f,afterCritical:p,onLiftImpact:f,viewport:i,scrollJumpRequest:null,forceShouldAnimate:null}}if(t.type===`COLLECTION_STARTING`)return e.phase===`COLLECTING`||e.phase===`DROP_PENDING`?e:(e.phase!==`DRAGGING`&&K(),{...e,phase:`COLLECTING`});if(t.type===`PUBLISH_WHILE_DRAGGING`)return!(e.phase===`COLLECTING`||e.phase===`DROP_PENDING`)&&K(),es({state:e,published:t.payload});if(t.type===`MOVE`){if(e.phase===`DROP_PENDING`)return e;!Do(e)&&K();let{client:n}=t.payload;return qi(n,e.current.client.selection)?e:Uo({state:e,clientSelection:n,impact:ts(e)?e.impact:null})}if(t.type===`UPDATE_DROPPABLE_SCROLL`){if(e.phase===`DROP_PENDING`||e.phase===`COLLECTING`)return rs(e);!Do(e)&&K();let{id:n,newScroll:r}=t.payload,i=e.dimensions.droppables[n];if(!i)return e;let a=sa(i,r);return ns(e,a,!1)}if(t.type===`UPDATE_DROPPABLE_IS_ENABLED`){if(e.phase===`DROP_PENDING`)return e;!Do(e)&&K();let{id:n,isEnabled:r}=t.payload,i=e.dimensions.droppables[n];!i&&K(),i.isEnabled===r&&K();let a={...i,isEnabled:r};return ns(e,a,!0)}if(t.type===`UPDATE_DROPPABLE_IS_COMBINE_ENABLED`){if(e.phase===`DROP_PENDING`)return e;!Do(e)&&K();let{id:n,isCombineEnabled:r}=t.payload,i=e.dimensions.droppables[n];!i&&K(),i.isCombineEnabled===r&&K();let a={...i,isCombineEnabled:r};return ns(e,a,!0)}if(t.type===`MOVE_BY_WINDOW_SCROLL`){if(e.phase===`DROP_PENDING`||e.phase===`DROP_ANIMATING`)return e;!Do(e)&&K(),!e.isWindowScrollAllowed&&K();let n=t.payload.newScroll;if(qi(e.viewport.scroll.current,n))return rs(e);let r=ro(e.viewport,n);return ts(e)?qo({state:e,viewport:r}):Uo({state:e,viewport:r})}if(t.type===`UPDATE_VIEWPORT_MAX_SCROLL`){if(!Do(e))return e;let n=t.payload.maxScroll;if(qi(n,e.viewport.scroll.max))return e;let r={...e.viewport,scroll:{...e.viewport.scroll,max:n}};return{...e,viewport:r}}if(t.type===`MOVE_UP`||t.type===`MOVE_DOWN`||t.type===`MOVE_LEFT`||t.type===`MOVE_RIGHT`){if(e.phase===`COLLECTING`||e.phase===`DROP_PENDING`)return e;e.phase!==`DRAGGING`&&K();let n=Eo({state:e,type:t.type});return n?Uo({state:e,impact:n.impact,clientSelection:n.clientSelection,scrollJumpRequest:n.scrollJumpRequest}):e}if(t.type===`DROP_PENDING`){let n=t.payload.reason;return e.phase!==`COLLECTING`&&K(),{...e,phase:`DROP_PENDING`,isWaiting:!0,reason:n}}if(t.type===`DROP_ANIMATE`){let{completed:n,dropDuration:r,newHomeClientOffset:i}=t.payload;return!(e.phase===`DRAGGING`||e.phase===`DROP_PENDING`)&&K(),{phase:`DROP_ANIMATING`,completed:n,dropDuration:r,newHomeClientOffset:i,dimensions:e.dimensions}}if(t.type===`DROP_COMPLETE`){let{completed:e}=t.payload;return{phase:`IDLE`,completed:e,shouldFlush:!1}}return e};function Y(e,t){return e instanceof Object&&`type`in e&&e.type===t}var cs=e=>({type:`BEFORE_INITIAL_CAPTURE`,payload:e}),ls=e=>({type:`LIFT`,payload:e}),us=e=>({type:`INITIAL_PUBLISH`,payload:e}),ds=e=>({type:`PUBLISH_WHILE_DRAGGING`,payload:e}),fs=()=>({type:`COLLECTION_STARTING`,payload:null}),ps=e=>({type:`UPDATE_DROPPABLE_SCROLL`,payload:e}),ms=e=>({type:`UPDATE_DROPPABLE_IS_ENABLED`,payload:e}),hs=e=>({type:`UPDATE_DROPPABLE_IS_COMBINE_ENABLED`,payload:e}),gs=e=>({type:`MOVE`,payload:e}),_s=e=>({type:`MOVE_BY_WINDOW_SCROLL`,payload:e}),vs=e=>({type:`UPDATE_VIEWPORT_MAX_SCROLL`,payload:e}),ys=()=>({type:`MOVE_UP`,payload:null}),bs=()=>({type:`MOVE_DOWN`,payload:null}),xs=()=>({type:`MOVE_RIGHT`,payload:null}),Ss=()=>({type:`MOVE_LEFT`,payload:null}),Cs=()=>({type:`FLUSH`,payload:null}),ws=e=>({type:`DROP_ANIMATE`,payload:e}),Ts=e=>({type:`DROP_COMPLETE`,payload:e}),Es=e=>({type:`DROP`,payload:e}),Ds=e=>({type:`DROP_PENDING`,payload:e}),Os=()=>({type:`DROP_ANIMATION_FINISHED`,payload:null}),ks=e=>({getState:t,dispatch:n})=>r=>i=>{if(!Y(i,`LIFT`)){r(i);return}let{id:a,clientSelection:o,movementMode:s}=i.payload,c=t();c.phase===`DROP_ANIMATING`&&n(Ts({completed:c.completed})),t().phase!==`IDLE`&&K(),n(Cs()),n(cs({draggableId:a,movementMode:s}));let l={draggableId:a,scrollOptions:{shouldPublishImmediately:s===`SNAP`}},{critical:u,dimensions:d,viewport:f}=e.startPublishing(l);n(us({critical:u,dimensions:d,clientSelection:o,movementMode:s,viewport:f}))},As=e=>()=>t=>n=>{Y(n,`INITIAL_PUBLISH`)&&e.dragging(),Y(n,`DROP_ANIMATE`)&&e.dropping(n.payload.completed.result.reason),(Y(n,`FLUSH`)||Y(n,`DROP_COMPLETE`))&&e.resting(),t(n)},js={outOfTheWay:`cubic-bezier(0.2, 0, 0, 1)`,drop:`cubic-bezier(.2,1,.1,1)`},Ms={opacity:{drop:0,combining:.7},scale:{drop:.75}},Ns={outOfTheWay:.2,minDropTime:.33,maxDropTime:.55},Ps=`${Ns.outOfTheWay}s ${js.outOfTheWay}`,Fs={fluid:`opacity ${Ps}`,snap:`transform ${Ps}, opacity ${Ps}`,drop:e=>{let t=`${e}s ${js.drop}`;return`transform ${t}, opacity ${t}`},outOfTheWay:`transform ${Ps}`,placeholder:`height ${Ps}, width ${Ps}, margin ${Ps}`},Is=e=>qi(e,Wi)?void 0:`translate(${e.x}px, ${e.y}px)`,Ls={moveTo:Is,drop:(e,t)=>{let n=Is(e);if(n)return t?`${n} scale(${Ms.scale.drop})`:n}},{minDropTime:Rs,maxDropTime:zs}=Ns,Bs=zs-Rs,Vs=1500,Hs=.6,Us=({current:e,destination:t,reason:n})=>{let r=Xi(e,t);if(r<=0)return Rs;if(r>=Vs)return zs;let i=r/Vs,a=Rs+Bs*i,o=n===`CANCEL`?a*Hs:a;return Number(o.toFixed(2))},Ws=({impact:e,draggable:t,dimensions:n,viewport:r,afterCritical:i})=>{let{draggables:a,droppables:o}=n,s=wo(e),c=s?o[s]:null,l=o[t.descriptor.droppableId],u=Ko({impact:e,draggable:t,draggables:a,afterCritical:i,droppable:c||l,viewport:r});return Ki(u,t.client.borderBox.center)},Gs=({draggables:e,reason:t,lastImpact:n,home:r,viewport:i,onLiftImpact:a})=>!n.at||t!==`DROP`?{impact:Go({draggables:e,impact:a,destination:r,viewport:i,forceShouldAnimate:!0}),didDropInsideDroppable:!1}:n.at.type===`REORDER`?{impact:n,didDropInsideDroppable:!0}:{impact:{...n,displaced:ba},didDropInsideDroppable:!0},Ks=({getState:e,dispatch:t})=>n=>r=>{if(!Y(r,`DROP`)){n(r);return}let i=e(),a=r.payload.reason;if(i.phase===`COLLECTING`){t(Ds({reason:a}));return}if(i.phase===`IDLE`)return;i.phase===`DROP_PENDING`&&i.isWaiting&&K(),!(i.phase===`DRAGGING`||i.phase===`DROP_PENDING`)&&K();let o=i.critical,s=i.dimensions,c=s.draggables[i.critical.draggable.id],{impact:l,didDropInsideDroppable:u}=Gs({reason:a,lastImpact:i.impact,afterCritical:i.afterCritical,onLiftImpact:i.onLiftImpact,home:i.dimensions.droppables[i.critical.droppable.id],viewport:i.viewport,draggables:i.dimensions.draggables}),d=u?ma(l):null,f=u?ha(l):null,p={index:o.draggable.index,droppableId:o.droppable.id},m={draggableId:c.descriptor.id,type:c.descriptor.type,source:p,reason:a,mode:i.movementMode,destination:d,combine:f},h=Ws({impact:l,draggable:c,dimensions:s,viewport:i.viewport,afterCritical:i.afterCritical}),g={critical:i.critical,afterCritical:i.afterCritical,result:m,impact:l};if(!(!qi(i.current.client.offset,h)||m.combine)){t(Ts({completed:g}));return}let _=Us({current:i.current.client.offset,destination:h,reason:a});t(ws({newHomeClientOffset:h,dropDuration:_,completed:g}))},qs=()=>({x:window.pageXOffset,y:window.pageYOffset});function Js(e){return{eventName:`scroll`,options:{passive:!0,capture:!1},fn:t=>{t.target!==window&&t.target!==window.document||e()}}}function Ys({onWindowScroll:e}){function t(){e(qs())}let n=Ei(t),r=Js(n),i=Oi;function a(){return i!==Oi}function o(){a()&&K(),i=Ai(window,[r])}function s(){!a()&&K(),n.cancel(),i(),i=Oi}return{start:o,stop:s,isActive:a}}var Xs=e=>Y(e,`DROP_COMPLETE`)||Y(e,`DROP_ANIMATE`)||Y(e,`FLUSH`),Zs=e=>{let t=Ys({onWindowScroll:t=>{e.dispatch(_s({newScroll:t}))}});return e=>n=>{!t.isActive()&&Y(n,`INITIAL_PUBLISH`)&&t.start(),t.isActive()&&Xs(n)&&t.stop(),e(n)}},Qs=e=>{let t=!1,n=!1,r=setTimeout(()=>{n=!0}),i=i=>{t||n||(t=!0,e(i),clearTimeout(r))};return i.wasCalled=()=>t,i},$s=()=>{let e=[],t=t=>{let n=e.findIndex(e=>e.timerId===t);n===-1&&K();let[r]=e.splice(n,1);r.callback()};return{add:n=>{let r=setTimeout(()=>t(r)),i={timerId:r,callback:n};e.push(i)},flush:()=>{if(!e.length)return;let t=[...e];e.length=0,t.forEach(e=>{clearTimeout(e.timerId),e.callback()})}}},ec=(e,t)=>e==null&&t==null?!0:e==null||t==null?!1:e.droppableId===t.droppableId&&e.index===t.index,tc=(e,t)=>e==null&&t==null?!0:e==null||t==null?!1:e.draggableId===t.draggableId&&e.droppableId===t.droppableId,nc=(e,t)=>{if(e===t)return!0;let n=e.draggable.id===t.draggable.id&&e.draggable.droppableId===t.draggable.droppableId&&e.draggable.type===t.draggable.type&&e.draggable.index===t.draggable.index,r=e.droppable.id===t.droppable.id&&e.droppable.type===t.droppable.type;return n&&r},rc=(e,t)=>{t()},ic=(e,t)=>({draggableId:e.draggable.id,type:e.droppable.type,source:{droppableId:e.droppable.id,index:e.draggable.index},mode:t});function ac(e,t,n,r){if(!e){n(r(t));return}let i=Qs(n);e(t,{announce:i}),i.wasCalled()||n(r(t))}var oc=(e,t)=>{let n=$s(),r=null,i=(t,n)=>{r&&K(),rc(`onBeforeCapture`,()=>{let r=e().onBeforeCapture;r&&r({draggableId:t,mode:n})})},a=(t,n)=>{r&&K(),rc(`onBeforeDragStart`,()=>{let r=e().onBeforeDragStart;r&&r(ic(t,n))})},o=(i,a)=>{r&&K();let o=ic(i,a);r={mode:a,lastCritical:i,lastLocation:o.source,lastCombine:null},n.add(()=>{rc(`onDragStart`,()=>ac(e().onDragStart,o,t,Vi.onDragStart))})},s=(i,a)=>{let o=ma(a),s=ha(a);!r&&K();let c=!nc(i,r.lastCritical);c&&(r.lastCritical=i);let l=!ec(r.lastLocation,o);l&&(r.lastLocation=o);let u=!tc(r.lastCombine,s);if(u&&(r.lastCombine=s),!c&&!l&&!u)return;let d={...ic(i,r.mode),combine:s,destination:o};n.add(()=>{rc(`onDragUpdate`,()=>ac(e().onDragUpdate,d,t,Vi.onDragUpdate))})},c=()=>{!r&&K(),n.flush()},l=n=>{!r&&K(),r=null,rc(`onDragEnd`,()=>ac(e().onDragEnd,n,t,Vi.onDragEnd))};return{beforeCapture:i,beforeStart:a,start:o,update:s,flush:c,drop:l,abort:()=>{if(!r)return;let e={...ic(r.lastCritical,r.mode),combine:null,destination:null,reason:`CANCEL`};l(e)}}},sc=(e,t)=>{let n=oc(e,t);return e=>t=>r=>{if(Y(r,`BEFORE_INITIAL_CAPTURE`)){n.beforeCapture(r.payload.draggableId,r.payload.movementMode);return}if(Y(r,`INITIAL_PUBLISH`)){let e=r.payload.critical;n.beforeStart(e,r.payload.movementMode),t(r),n.start(e,r.payload.movementMode);return}if(Y(r,`DROP_COMPLETE`)){let e=r.payload.completed.result;n.flush(),t(r),n.drop(e);return}if(t(r),Y(r,`FLUSH`)){n.abort();return}let i=e.getState();i.phase===`DRAGGING`&&n.update(i.critical,i.impact)}},cc=e=>t=>n=>{if(!Y(n,`DROP_ANIMATION_FINISHED`)){t(n);return}let r=e.getState();r.phase!==`DROP_ANIMATING`&&K(),e.dispatch(Ts({completed:r.completed}))},lc=e=>{let t=null,n=null;function r(){n&&=(cancelAnimationFrame(n),null),t&&=(t(),null)}return i=>a=>{if((Y(a,`FLUSH`)||Y(a,`DROP_COMPLETE`)||Y(a,`DROP_ANIMATION_FINISHED`))&&r(),i(a),!Y(a,`DROP_ANIMATE`))return;let o={eventName:`scroll`,options:{capture:!0,passive:!1,once:!0},fn:function(){e.getState().phase===`DROP_ANIMATING`&&e.dispatch(Os())}};n=requestAnimationFrame(()=>{n=null,t=Ai(window,[o])})}},uc=e=>()=>t=>n=>{(Y(n,`DROP_COMPLETE`)||Y(n,`FLUSH`)||Y(n,`DROP_ANIMATE`))&&e.stopPublishing(),t(n)},dc=e=>{let t=!1;return()=>n=>r=>{if(Y(r,`INITIAL_PUBLISH`)){t=!0,e.tryRecordFocus(r.payload.critical.draggable.id),n(r),e.tryRestoreFocusRecorded();return}if(n(r),t){if(Y(r,`FLUSH`)){t=!1,e.tryRestoreFocusRecorded();return}if(Y(r,`DROP_COMPLETE`)){t=!1;let n=r.payload.completed.result;n.combine&&e.tryShiftRecord(n.draggableId,n.combine.draggableId),e.tryRestoreFocusRecorded()}}}},fc=e=>Y(e,`DROP_COMPLETE`)||Y(e,`DROP_ANIMATE`)||Y(e,`FLUSH`),pc=e=>t=>n=>r=>{if(fc(r)){e.stop(),n(r);return}if(Y(r,`INITIAL_PUBLISH`)){n(r);let i=t.getState();i.phase!==`DRAGGING`&&K(),e.start(i);return}n(r),e.scroll(t.getState())},mc=e=>t=>n=>{if(t(n),!Y(n,`PUBLISH_WHILE_DRAGGING`))return;let r=e.getState();r.phase===`DROP_PENDING`&&(r.isWaiting||e.dispatch(Es({reason:r.reason})))},hc=ie,gc=({dimensionMarshal:e,focusMarshal:t,styleMarshal:n,getResponders:r,announce:i,autoScroller:a})=>fe(ss,hc(I(As(n),uc(e),ks(e),Ks,cc,lc,mc,pc(a),Zs,dc(t),sc(r,i)))),_c=()=>({additions:{},removals:{},modified:{}});function vc({registry:e,callbacks:t}){let n=_c(),r=null,i=()=>{r||=(t.collectionStarting(),requestAnimationFrame(()=>{r=null;let{additions:i,removals:a,modified:o}=n,s=Object.keys(i).map(t=>e.draggable.getById(t).getDimension(Wi)).sort((e,t)=>e.descriptor.index-t.descriptor.index),c=Object.keys(o).map(t=>{let n=e.droppable.getById(t).callbacks.getScrollWhileDragging();return{droppableId:t,scroll:n}}),l={additions:s,removals:Object.keys(a),modified:c};n=_c(),t.publish(l)}))};return{add:e=>{let t=e.descriptor.id;n.additions[t]=e,n.modified[e.descriptor.droppableId]=!0,n.removals[t]&&delete n.removals[t],i()},remove:e=>{let t=e.descriptor;n.removals[t.id]=!0,n.modified[t.droppableId]=!0,n.additions[t.id]&&delete n.additions[t.id],i()},stop:()=>{r&&(cancelAnimationFrame(r),r=null,n=_c())}}}var yc=({scrollHeight:e,scrollWidth:t,height:n,width:r})=>{let i=Ki({x:t,y:e},{x:r,y:n});return{x:Math.max(0,i.x),y:Math.max(0,i.y)}},bc=()=>{let e=document.documentElement;return!e&&K(),e},xc=()=>{let e=bc();return yc({scrollHeight:e.scrollHeight,scrollWidth:e.scrollWidth,width:e.clientWidth,height:e.clientHeight})},Sc=()=>{let e=qs(),t=xc(),n=e.y,r=e.x,i=bc(),a=i.clientWidth,o=i.clientHeight,s=r+a,c=n+o;return{frame:mi({top:n,left:r,right:s,bottom:c}),scroll:{initial:e,current:e,max:t,diff:{value:Wi,displacement:Wi}}}},Cc=({critical:e,scrollOptions:t,registry:n})=>{let r=Sc(),i=r.scroll.current,a=e.droppable,o=n.droppable.getAllByType(a.type).map(e=>e.callbacks.getDimensionAndWatchScroll(i,t)),s=n.draggable.getAllByType(e.draggable.type).map(e=>e.getDimension(i));return{dimensions:{draggables:ua(s),droppables:la(o)},critical:e,viewport:r}};function wc(e,t,n){return!(n.descriptor.id===t.id||n.descriptor.type!==t.type||e.droppable.getById(n.descriptor.droppableId).descriptor.mode!==`virtual`)}var Tc=(e,t)=>{let n=null,r=vc({callbacks:{publish:t.publishWhileDragging,collectionStarting:t.collectionStarting},registry:e}),i=(r,i)=>{!e.droppable.exists(r)&&K(),n&&t.updateDroppableIsEnabled({id:r,isEnabled:i})},a=(r,i)=>{n&&(!e.droppable.exists(r)&&K(),t.updateDroppableIsCombineEnabled({id:r,isCombineEnabled:i}))},o=(r,i)=>{n&&(!e.droppable.exists(r)&&K(),t.updateDroppableScroll({id:r,newScroll:i}))},s=(t,r)=>{n&&e.droppable.getById(t).callbacks.scroll(r)},c=()=>{if(!n)return;r.stop();let t=n.critical.droppable;e.droppable.getAllByType(t.type).forEach(e=>e.callbacks.dragStopped()),n.unsubscribe(),n=null},l=t=>{!n&&K();let i=n.critical.draggable;t.type===`ADDITION`&&wc(e,i,t.value)&&r.add(t.value),t.type===`REMOVAL`&&wc(e,i,t.value)&&r.remove(t.value)};return{updateDroppableIsEnabled:i,updateDroppableIsCombineEnabled:a,scrollDroppable:s,updateDroppableScroll:o,startPublishing:t=>{n&&K();let r=e.draggable.getById(t.draggableId),i=e.droppable.getById(r.descriptor.droppableId),a={draggable:r.descriptor,droppable:i.descriptor},o=e.subscribe(l);return n={critical:a,unsubscribe:o},Cc({critical:a,registry:e,scrollOptions:t.scrollOptions})},stopPublishing:c}},Ec=(e,t)=>e.phase===`IDLE`?!0:e.phase!==`DROP_ANIMATING`||e.completed.result.draggableId===t?!1:e.completed.result.reason===`DROP`,Dc=e=>{window.scrollBy(e.x,e.y)},Oc=ca(e=>da(e).filter(e=>!(!e.isEnabled||!e.frame))),kc=(e,t)=>Oc(t).find(t=>(!t.frame&&K(),Oo(t.frame.pageMarginBox)(e)))||null,Ac=({center:e,destination:t,droppables:n})=>{if(t){let e=n[t];return e.frame?e:null}return kc(e,n)},jc={startFromPercentage:.25,maxScrollAtPercentage:.05,maxPixelScroll:28,ease:e=>e**2,durationDampening:{stopDampeningAt:1200,accelerateAt:360},disabled:!1},Mc=(e,t,n=()=>jc)=>{let r=n(),i=e[t.size]*r.startFromPercentage,a=e[t.size]*r.maxScrollAtPercentage;return{startScrollingFrom:i,maxScrollValueAt:a}},Nc=({startOfRange:e,endOfRange:t,current:n})=>{let r=t-e;return r===0?0:(n-e)/r},Pc=1,Fc=(e,t,n=()=>jc)=>{let r=n();if(e>t.startScrollingFrom)return 0;if(e<=t.maxScrollValueAt)return r.maxPixelScroll;if(e===t.startScrollingFrom)return Pc;let i=1-Nc({startOfRange:t.maxScrollValueAt,endOfRange:t.startScrollingFrom,current:e}),a=r.maxPixelScroll*r.ease(i);return Math.ceil(a)},Ic=(e,t,n)=>{let r=n(),i=r.durationDampening.accelerateAt,a=r.durationDampening.stopDampeningAt,o=t,s=a,c=Date.now()-o;if(c>=a)return e;if(c<i)return Pc;let l=Nc({startOfRange:i,endOfRange:s,current:c}),u=e*r.ease(l);return Math.ceil(u)},Lc=({distanceToEdge:e,thresholds:t,dragStartTime:n,shouldUseTimeDampening:r,getAutoScrollerOptions:i})=>{let a=Fc(e,t,i);return a===0?0:r?Math.max(Ic(a,n,i),Pc):a},Rc=({container:e,distanceToEdges:t,dragStartTime:n,axis:r,shouldUseTimeDampening:i,getAutoScrollerOptions:a})=>{let o=Mc(e,r,a);return t[r.end]<t[r.start]?Lc({distanceToEdge:t[r.end],thresholds:o,dragStartTime:n,shouldUseTimeDampening:i,getAutoScrollerOptions:a}):-1*Lc({distanceToEdge:t[r.start],thresholds:o,dragStartTime:n,shouldUseTimeDampening:i,getAutoScrollerOptions:a})},zc=({container:e,subject:t,proposedScroll:n})=>{let r=t.height>e.height,i=t.width>e.width;return!i&&!r?n:i&&r?null:{x:i?0:n.x,y:r?0:n.y}},Bc=Qi(e=>e===0?0:e),Vc=({dragStartTime:e,container:t,subject:n,center:r,shouldUseTimeDampening:i,getAutoScrollerOptions:a})=>{let o={top:r.y-t.top,right:t.right-r.x,bottom:t.bottom-r.y,left:r.x-t.left},s=Rc({container:t,distanceToEdges:o,dragStartTime:e,axis:Ta,shouldUseTimeDampening:i,getAutoScrollerOptions:a}),c=Rc({container:t,distanceToEdges:o,dragStartTime:e,axis:Ea,shouldUseTimeDampening:i,getAutoScrollerOptions:a}),l=Bc({x:c,y:s});if(qi(l,Wi))return null;let u=zc({container:t,subject:n,proposedScroll:l});return u?qi(u,Wi)?null:u:null},Hc=Qi(e=>e===0?0:e>0?1:-1),Uc=(()=>{let e=(e,t)=>e<0?e:e>t?e-t:0;return({current:t,max:n,change:r})=>{let i=Gi(t,r),a={x:e(i.x,n.x),y:e(i.y,n.y)};return qi(a,Wi)?null:a}})(),Wc=({max:e,current:t,change:n})=>{let r={x:Math.max(t.x,e.x),y:Math.max(t.y,e.y)},i=Hc(n),a=Uc({max:r,current:t,change:i});return!a||i.x!==0&&a.x===0||i.y!==0&&a.y===0},Gc=(e,t)=>Wc({current:e.scroll.current,max:e.scroll.max,change:t}),Kc=(e,t)=>{if(!Gc(e,t))return null;let n=e.scroll.max,r=e.scroll.current;return Uc({current:r,max:n,change:t})},qc=(e,t)=>{let n=e.frame;return n?Wc({current:n.scroll.current,max:n.scroll.max,change:t}):!1},Jc=(e,t)=>{let n=e.frame;return!n||!qc(e,t)?null:Uc({current:n.scroll.current,max:n.scroll.max,change:t})},Yc=({viewport:e,subject:t,center:n,dragStartTime:r,shouldUseTimeDampening:i,getAutoScrollerOptions:a})=>{let o=Vc({dragStartTime:r,container:e.frame,subject:t,center:n,shouldUseTimeDampening:i,getAutoScrollerOptions:a});return o&&Gc(e,o)?o:null},Xc=({droppable:e,subject:t,center:n,dragStartTime:r,shouldUseTimeDampening:i,getAutoScrollerOptions:a})=>{let o=e.frame;if(!o)return null;let s=Vc({dragStartTime:r,container:o.pageMarginBox,subject:t,center:n,shouldUseTimeDampening:i,getAutoScrollerOptions:a});return s&&qc(e,s)?s:null},Zc=({state:e,dragStartTime:t,shouldUseTimeDampening:n,scrollWindow:r,scrollDroppable:i,getAutoScrollerOptions:a})=>{let o=e.current.page.borderBoxCenter,s=e.dimensions.draggables[e.critical.draggable.id].page.marginBox;if(e.isWindowScrollAllowed){let i=e.viewport,c=Yc({dragStartTime:t,viewport:i,subject:s,center:o,shouldUseTimeDampening:n,getAutoScrollerOptions:a});if(c){r(c);return}}let c=Ac({center:o,destination:wo(e.impact),droppables:e.dimensions.droppables});if(!c)return;let l=Xc({dragStartTime:t,droppable:c,subject:s,center:o,shouldUseTimeDampening:n,getAutoScrollerOptions:a});l&&i(c.descriptor.id,l)},Qc=({scrollWindow:e,scrollDroppable:t,getAutoScrollerOptions:n=()=>jc})=>{let r=Ei(e),i=Ei(t),a=null,o=e=>{!a&&K();let{shouldUseTimeDampening:t,dragStartTime:o}=a;Zc({state:e,scrollWindow:r,scrollDroppable:i,dragStartTime:o,shouldUseTimeDampening:t,getAutoScrollerOptions:n})};return{start:e=>{a&&K();let t=Date.now(),r=!1,i=()=>{r=!0};Zc({state:e,dragStartTime:0,shouldUseTimeDampening:!1,scrollWindow:i,scrollDroppable:i,getAutoScrollerOptions:n}),a={dragStartTime:t,shouldUseTimeDampening:r},r&&o(e)},stop:()=>{a&&=(r.cancel(),i.cancel(),null)},scroll:o}},$c=({move:e,scrollDroppable:t,scrollWindow:n})=>{let r=(t,n)=>{let r=Gi(t.current.client.selection,n);e({client:r})},i=(e,n)=>{if(!qc(e,n))return n;let r=Jc(e,n);if(!r)return t(e.descriptor.id,n),null;let i=Ki(n,r);return t(e.descriptor.id,i),Ki(n,i)},a=(e,t,r)=>{if(!e||!Gc(t,r))return r;let i=Kc(t,r);if(!i)return n(r),null;let a=Ki(r,i);return n(a),Ki(r,a)};return e=>{let t=e.scrollJumpRequest;if(!t)return;let n=wo(e.impact);!n&&K();let o=i(e.dimensions.droppables[n],t);if(!o)return;let s=e.viewport,c=a(e.isWindowScrollAllowed,s,o);c&&r(e,c)}},el=({scrollDroppable:e,scrollWindow:t,move:n,getAutoScrollerOptions:r})=>{let i=Qc({scrollWindow:t,scrollDroppable:e,getAutoScrollerOptions:r}),a=$c({move:n,scrollWindow:t,scrollDroppable:e});return{scroll:e=>{if(!(r().disabled||e.phase!==`DRAGGING`)){if(e.movementMode===`FLUID`){i.scroll(e);return}e.scrollJumpRequest&&a(e)}},start:i.start,stop:i.stop}},tl=`data-rfd`,nl=(()=>{let e=`${tl}-drag-handle`;return{base:e,draggableId:`${e}-draggable-id`,contextId:`${e}-context-id`}})(),rl=(()=>{let e=`${tl}-draggable`;return{base:e,contextId:`${e}-context-id`,id:`${e}-id`}})(),il=(()=>{let e=`${tl}-droppable`;return{base:e,contextId:`${e}-context-id`,id:`${e}-id`}})(),al={contextId:`${tl}-scroll-container-context-id`},ol=e=>t=>`[${t}="${e}"]`,sl=(e,t)=>e.map(e=>{let n=e.styles[t];return n?`${e.selector} { ${n} }`:``}).join(` `),cl=`pointer-events: none;`,ll=e=>{let t=ol(e),n=(()=>{let e=`
      cursor: -webkit-grab;
      cursor: grab;
    `;return{selector:t(nl.contextId),styles:{always:`
          -webkit-touch-callout: none;
          -webkit-tap-highlight-color: rgba(0,0,0,0);
          touch-action: manipulation;
        `,resting:e,dragging:cl,dropAnimating:e}}})(),r=(()=>{let e=`
      transition: ${Fs.outOfTheWay};
    `;return{selector:t(rl.contextId),styles:{dragging:e,dropAnimating:e,userCancel:e}}})(),i={selector:t(il.contextId),styles:{always:`overflow-anchor: none;`}},a=[r,n,i,{selector:`body`,styles:{dragging:`
        cursor: grabbing;
        cursor: -webkit-grabbing;
        user-select: none;
        -webkit-user-select: none;
        -moz-user-select: none;
        -ms-user-select: none;
        overflow-anchor: none;
      `}}];return{always:sl(a,`always`),resting:sl(a,`resting`),dragging:sl(a,`dragging`),dropAnimating:sl(a,`dropAnimating`),userCancel:sl(a,`userCancel`)}},ul=typeof window<`u`&&window.document!==void 0&&window.document.createElement!==void 0?H.useLayoutEffect:H.useEffect,dl=()=>{let e=document.querySelector(`head`);return!e&&K(),e},fl=e=>{let t=document.createElement(`style`);return e&&t.setAttribute(`nonce`,e),t.type=`text/css`,t};function pl(e,t){let n=q(()=>ll(e),[e]),r=(0,H.useRef)(null),i=(0,H.useRef)(null),a=J(ca(e=>{let t=i.current;!t&&K(),t.textContent=e}),[]),o=J(e=>{let t=r.current;!t&&K(),t.textContent=e},[]);ul(()=>{!(!r.current&&!i.current)&&K();let s=fl(t),c=fl(t);return r.current=s,i.current=c,s.setAttribute(`${tl}-always`,e),c.setAttribute(`${tl}-dynamic`,e),dl().appendChild(s),dl().appendChild(c),o(n.always),a(n.resting),()=>{let e=e=>{let t=e.current;!t&&K(),dl().removeChild(t),e.current=null};e(r),e(i)}},[t,o,a,n.always,n.resting,e]);let s=J(()=>a(n.dragging),[a,n.dragging]),c=J(e=>{if(e===`DROP`){a(n.dropAnimating);return}a(n.userCancel)},[a,n.dropAnimating,n.userCancel]),l=J(()=>{i.current&&a(n.resting)},[a,n.resting]);return q(()=>({dragging:s,dropping:c,resting:l}),[s,c,l])}function ml(e,t){return Array.from(e.querySelectorAll(t))}var hl=e=>e&&e.ownerDocument&&e.ownerDocument.defaultView?e.ownerDocument.defaultView:window;function gl(e){return e instanceof hl(e).HTMLElement}function _l(e,t){let n=`[${nl.contextId}="${e}"]`,r=ml(document,n);if(!r.length)return null;let i=r.find(e=>e.getAttribute(nl.draggableId)===t);return!i||!gl(i)?null:i}function vl(e){let t=(0,H.useRef)({}),n=(0,H.useRef)(null),r=(0,H.useRef)(null),i=(0,H.useRef)(!1),a=J(function(e,n){let r={id:e,focus:n};return t.current[e]=r,function(){let n=t.current;n[e]!==r&&delete n[e]}},[]),o=J(function(t){let n=_l(e,t);n&&n!==document.activeElement&&n.focus()},[e]),s=J(function(e,t){n.current===e&&(n.current=t)},[]),c=J(function(){r.current||i.current&&(r.current=requestAnimationFrame(()=>{r.current=null;let e=n.current;e&&o(e)}))},[o]),l=J(function(e){n.current=null;let t=document.activeElement;t&&t.getAttribute(nl.draggableId)===e&&(n.current=e)},[]);return ul(()=>(i.current=!0,function(){i.current=!1;let e=r.current;e&&cancelAnimationFrame(e)}),[]),q(()=>({register:a,tryRecordFocus:l,tryRestoreFocusRecorded:c,tryShiftRecord:s}),[a,l,c,s])}function yl(){let e={draggables:{},droppables:{}},t=[];function n(e){return t.push(e),function(){let n=t.indexOf(e);n!==-1&&t.splice(n,1)}}function r(e){t.length&&t.forEach(t=>t(e))}function i(t){return e.draggables[t]||null}function a(e){let t=i(e);return!t&&K(),t}let o={register:t=>{e.draggables[t.descriptor.id]=t,r({type:`ADDITION`,value:t})},update:(t,n)=>{let r=e.draggables[n.descriptor.id];r&&r.uniqueId===t.uniqueId&&(delete e.draggables[n.descriptor.id],e.draggables[t.descriptor.id]=t)},unregister:t=>{let n=t.descriptor.id,a=i(n);a&&t.uniqueId===a.uniqueId&&(delete e.draggables[n],e.droppables[t.descriptor.droppableId]&&r({type:`REMOVAL`,value:t}))},getById:a,findById:i,exists:e=>!!i(e),getAllByType:t=>Object.values(e.draggables).filter(e=>e.descriptor.type===t)};function s(t){return e.droppables[t]||null}function c(e){let t=s(e);return!t&&K(),t}let l={register:t=>{e.droppables[t.descriptor.id]=t},unregister:t=>{let n=s(t.descriptor.id);n&&t.uniqueId===n.uniqueId&&delete e.droppables[t.descriptor.id]},getById:c,findById:s,exists:e=>!!s(e),getAllByType:t=>Object.values(e.droppables).filter(e=>e.descriptor.type===t)};function u(){e.draggables={},e.droppables={},t.length=0}return{draggable:o,droppable:l,subscribe:n,clean:u}}function bl(){let e=q(yl,[]);return(0,H.useEffect)(()=>function(){e.clean()},[e]),e}var xl=H.createContext(null),Sl=()=>{let e=document.body;return!e&&K(),e},Cl={position:`absolute`,width:`1px`,height:`1px`,margin:`-1px`,border:`0`,padding:`0`,overflow:`hidden`,clip:`rect(0 0 0 0)`,"clip-path":`inset(100%)`},wl=e=>`rfd-announcement-${e}`;function Tl(e){let t=q(()=>wl(e),[e]),n=(0,H.useRef)(null);return(0,H.useEffect)(function(){let e=document.createElement(`div`);return n.current=e,e.id=t,e.setAttribute(`aria-live`,`assertive`),e.setAttribute(`aria-atomic`,`true`),ke(e.style,Cl),Sl().appendChild(e),function(){setTimeout(function(){let t=Sl();t.contains(e)&&t.removeChild(e),e===n.current&&(n.current=null)})}},[t]),J(e=>{let t=n.current;if(t){t.textContent=e;return}},[])}var El={separator:`::`};function Dl(e,t=El){let n=H.useId();return q(()=>`${e}${t.separator}${n}`,[t.separator,e,n])}function Ol({contextId:e,uniqueId:t}){return`rfd-hidden-text-${e}-${t}`}function kl({contextId:e,text:t}){let n=Dl(`hidden-text`,{separator:`-`}),r=q(()=>Ol({contextId:e,uniqueId:n}),[n,e]);return(0,H.useEffect)(function(){let e=document.createElement(`div`);return e.id=r,e.textContent=t,e.style.display=`none`,Sl().appendChild(e),function(){let t=Sl();t.contains(e)&&t.removeChild(e)}},[r,t]),r}var Al=H.createContext(null);function jl(e){let t=(0,H.useRef)(e);return(0,H.useEffect)(()=>{t.current=e}),t}function Ml(){let e=null;function t(){return!!e}function n(t){return t===e}function r(t){e&&K();let n={abandon:t};return e=n,n}function i(){!e&&K(),e=null}function a(){e&&(e.abandon(),i())}return{isClaimed:t,isActive:n,claim:r,release:i,tryAbandon:a}}function Nl(e){return e.phase===`IDLE`||e.phase===`DROP_ANIMATING`?!1:e.isDragging}var Pl=9,Fl=13,Il=27,Ll=32,Rl=33,zl=34,Bl=35,Vl=36,Hl=37,Ul=38,Wl=39,Gl=40,Kl={[Fl]:!0,[Pl]:!0},ql=e=>{Kl[e.keyCode]&&e.preventDefault()},Jl=(()=>{let e=`visibilitychange`;return typeof document>`u`?e:[e,`ms${e}`,`webkit${e}`,`moz${e}`,`o${e}`].find(e=>`on${e}`in document)||e})(),Yl=0,Xl=5;function Zl(e,t){return Math.abs(t.x-e.x)>=Xl||Math.abs(t.y-e.y)>=Xl}var Ql={type:`IDLE`};function $l({cancel:e,completed:t,getPhase:n,setPhase:r}){return[{eventName:`mousemove`,fn:e=>{let{button:t,clientX:i,clientY:a}=e;if(t!==Yl)return;let o={x:i,y:a},s=n();if(s.type===`DRAGGING`){e.preventDefault(),s.actions.move(o);return}s.type!==`PENDING`&&K();let c=s.point;if(!Zl(c,o))return;e.preventDefault();let l=s.actions.fluidLift(o);r({type:`DRAGGING`,actions:l})}},{eventName:`mouseup`,fn:r=>{let i=n();if(i.type!==`DRAGGING`){e();return}r.preventDefault(),i.actions.drop({shouldBlockNextClick:!0}),t()}},{eventName:`mousedown`,fn:t=>{n().type===`DRAGGING`&&t.preventDefault(),e()}},{eventName:`keydown`,fn:t=>{if(n().type===`PENDING`){e();return}if(t.keyCode===Il){t.preventDefault(),e();return}ql(t)}},{eventName:`resize`,fn:e},{eventName:`scroll`,options:{passive:!0,capture:!1},fn:()=>{n().type===`PENDING`&&e()}},{eventName:`webkitmouseforcedown`,fn:t=>{let r=n();if(r.type===`IDLE`&&K(),r.actions.shouldRespectForcePress()){e();return}t.preventDefault()}},{eventName:Jl,fn:e}]}function eu(e){let t=(0,H.useRef)(Ql),n=(0,H.useRef)(Oi),r=q(()=>({eventName:`mousedown`,fn:function(t){if(t.defaultPrevented||t.button!==Yl||t.ctrlKey||t.metaKey||t.shiftKey||t.altKey)return;let r=e.findClosestDraggableId(t);if(!r)return;let i=e.tryGetLock(r,o,{sourceEvent:t});if(!i)return;t.preventDefault();let a={x:t.clientX,y:t.clientY};n.current(),l(i,a)}}),[e]),i=q(()=>({eventName:`webkitmouseforcewillbegin`,fn:t=>{if(t.defaultPrevented)return;let n=e.findClosestDraggableId(t);if(!n)return;let r=e.findOptionsForDraggable(n);r&&(r.shouldRespectForcePress||e.canGetLock(n)&&t.preventDefault())}}),[e]),a=J(function(){n.current=Ai(window,[i,r],{passive:!1,capture:!0})},[i,r]),o=J(()=>{t.current.type!==`IDLE`&&(t.current=Ql,n.current(),a())},[a]),s=J(()=>{let e=t.current;o(),e.type===`DRAGGING`&&e.actions.cancel({shouldBlockNextClick:!0}),e.type===`PENDING`&&e.actions.abort()},[o]),c=J(function(){let e={capture:!0,passive:!1},r=$l({cancel:s,completed:o,getPhase:()=>t.current,setPhase:e=>{t.current=e}});n.current=Ai(window,r,e)},[s,o]),l=J(function(e,n){t.current.type!==`IDLE`&&K(),t.current={type:`PENDING`,point:n,actions:e},c()},[c]);ul(function(){return a(),function(){n.current()}},[a])}function tu(){}var nu={[zl]:!0,[Rl]:!0,[Vl]:!0,[Bl]:!0};function ru(e,t){function n(){t(),e.cancel()}function r(){t(),e.drop()}return[{eventName:`keydown`,fn:t=>{if(t.keyCode===Il){t.preventDefault(),n();return}if(t.keyCode===Ll){t.preventDefault(),r();return}if(t.keyCode===Gl){t.preventDefault(),e.moveDown();return}if(t.keyCode===Ul){t.preventDefault(),e.moveUp();return}if(t.keyCode===Wl){t.preventDefault(),e.moveRight();return}if(t.keyCode===Hl){t.preventDefault(),e.moveLeft();return}if(nu[t.keyCode]){t.preventDefault();return}ql(t)}},{eventName:`mousedown`,fn:n},{eventName:`mouseup`,fn:n},{eventName:`click`,fn:n},{eventName:`touchstart`,fn:n},{eventName:`resize`,fn:n},{eventName:`wheel`,fn:n,options:{passive:!0}},{eventName:Jl,fn:n}]}function iu(e){let t=(0,H.useRef)(tu),n=q(()=>({eventName:`keydown`,fn:function(n){if(n.defaultPrevented||n.keyCode!==Ll)return;let i=e.findClosestDraggableId(n);if(!i)return;let a=e.tryGetLock(i,c,{sourceEvent:n});if(!a)return;n.preventDefault();let o=!0,s=a.snapLift();t.current();function c(){!o&&K(),o=!1,t.current(),r()}t.current=Ai(window,ru(s,c),{capture:!0,passive:!1})}}),[e]),r=J(function(){t.current=Ai(window,[n],{passive:!1,capture:!0})},[n]);ul(function(){return r(),function(){t.current()}},[r])}var au={type:`IDLE`},ou=120,su=.15;function cu({cancel:e,getPhase:t}){return[{eventName:`orientationchange`,fn:e},{eventName:`resize`,fn:e},{eventName:`contextmenu`,fn:e=>{e.preventDefault()}},{eventName:`keydown`,fn:n=>{if(t().type!==`DRAGGING`){e();return}n.keyCode===Il&&n.preventDefault(),e()}},{eventName:Jl,fn:e}]}function lu({cancel:e,completed:t,getPhase:n}){return[{eventName:`touchmove`,options:{capture:!1},fn:t=>{let r=n();if(r.type!==`DRAGGING`){e();return}r.hasMoved=!0;let{clientX:i,clientY:a}=t.touches[0],o={x:i,y:a};t.preventDefault(),r.actions.move(o)}},{eventName:`touchend`,fn:r=>{let i=n();if(i.type!==`DRAGGING`){e();return}r.preventDefault(),i.actions.drop({shouldBlockNextClick:!0}),t()}},{eventName:`touchcancel`,fn:t=>{if(n().type!==`DRAGGING`){e();return}t.preventDefault(),e()}},{eventName:`touchforcechange`,fn:t=>{let r=n();r.type===`IDLE`&&K();let i=t.touches[0];if(!i||!(i.force>=su))return;let a=r.actions.shouldRespectForcePress();if(r.type===`PENDING`){a&&e();return}if(a){if(r.hasMoved){t.preventDefault();return}e();return}t.preventDefault()}},{eventName:Jl,fn:e}]}function uu(e){let t=(0,H.useRef)(au),n=(0,H.useRef)(Oi),r=J(function(){return t.current},[]),i=J(function(e){t.current=e},[]),a=q(()=>({eventName:`touchstart`,fn:function(t){if(t.defaultPrevented)return;let r=e.findClosestDraggableId(t);if(!r)return;let i=e.tryGetLock(r,s,{sourceEvent:t});if(!i)return;let{clientX:a,clientY:o}=t.touches[0],c={x:a,y:o};n.current(),d(i,c)}}),[e]),o=J(function(){n.current=Ai(window,[a],{capture:!0,passive:!1})},[a]),s=J(()=>{let e=t.current;e.type!==`IDLE`&&(e.type===`PENDING`&&clearTimeout(e.longPressTimerId),i(au),n.current(),o())},[o,i]),c=J(()=>{let e=t.current;s(),e.type===`DRAGGING`&&e.actions.cancel({shouldBlockNextClick:!0}),e.type===`PENDING`&&e.actions.abort()},[s]),l=J(function(){let e={capture:!0,passive:!1},t={cancel:c,completed:s,getPhase:r},i=Ai(window,lu(t),e),a=Ai(window,cu(t),e);n.current=function(){i(),a()}},[c,r,s]),u=J(function(){let e=r();e.type!==`PENDING`&&K();let t=e.actions.fluidLift(e.point);i({type:`DRAGGING`,actions:t,hasMoved:!1})},[r,i]),d=J(function(e,t){r().type!==`IDLE`&&K();let n=setTimeout(u,ou);i({type:`PENDING`,point:t,actions:e,longPressTimerId:n}),l()},[l,r,i,u]);ul(function(){return o(),function(){n.current();let e=r();e.type===`PENDING`&&(clearTimeout(e.longPressTimerId),i(au))}},[r,o,i]),ul(function(){return Ai(window,[{eventName:`touchmove`,fn:()=>{},options:{capture:!1,passive:!1}}])},[])}var du=[`input`,`button`,`textarea`,`select`,`option`,`optgroup`,`video`,`audio`];function fu(e,t){if(t==null)return!1;if(du.includes(t.tagName.toLowerCase()))return!0;let n=t.getAttribute(`contenteditable`);return n===`true`||n===``?!0:t===e?!1:fu(e,t.parentElement)}function pu(e,t){let n=t.target;return gl(n)?fu(e,n):!1}var mu=e=>mi(e.getBoundingClientRect()).center;function hu(e){return e instanceof hl(e).Element}var gu=(()=>{let e=`matches`;return typeof document>`u`?e:[e,`msMatchesSelector`,`webkitMatchesSelector`].find(e=>e in Element.prototype)||e})();function _u(e,t){return e==null?null:e[gu](t)?e:_u(e.parentElement,t)}function vu(e,t){return e.closest?e.closest(t):_u(e,t)}function yu(e){return`[${nl.contextId}="${e}"]`}function bu(e,t){let n=t.target;if(!hu(n))return null;let r=yu(e),i=vu(n,r);return!i||!gl(i)?null:i}function xu(e,t){let n=bu(e,t);return n?n.getAttribute(nl.draggableId):null}function Su(e,t){let n=`[${rl.contextId}="${e}"]`,r=ml(document,n).find(e=>e.getAttribute(rl.id)===t);return!r||!gl(r)?null:r}function Cu(e){e.preventDefault()}function wu({expected:e,phase:t,isLockActive:n,shouldWarn:r}){return!(!n()||e!==t)}function Tu({lockAPI:e,store:t,registry:n,draggableId:r}){if(e.isClaimed())return!1;let i=n.draggable.findById(r);return!(!i||!i.options.isEnabled||!Ec(t.getState(),r))}function Eu({lockAPI:e,contextId:t,store:n,registry:r,draggableId:i,forceSensorStop:a,sourceEvent:o}){if(!Tu({lockAPI:e,store:n,registry:r,draggableId:i}))return null;let s=r.draggable.getById(i),c=Su(t,s.descriptor.id);if(!c||o&&!s.options.canDragInteractiveElements&&pu(c,o))return null;let l=e.claim(a||Oi),u=`PRE_DRAG`;function d(){return s.options.shouldRespectForcePress}function f(){return e.isActive(l)}function p(e,t){wu({expected:e,phase:u,isLockActive:f,shouldWarn:!0})&&n.dispatch(t())}let m=p.bind(null,`DRAGGING`);function h(t){function r(){e.release(),u=`COMPLETED`}u!==`PRE_DRAG`&&(r(),K()),n.dispatch(ls(t.liftActionArgs)),u=`DRAGGING`;function i(e,i={shouldBlockNextClick:!1}){if(t.cleanup(),i.shouldBlockNextClick){let e=Ai(window,[{eventName:`click`,fn:Cu,options:{once:!0,passive:!1,capture:!0}}]);setTimeout(e)}r(),n.dispatch(Es({reason:e}))}return{isActive:()=>wu({expected:`DRAGGING`,phase:u,isLockActive:f,shouldWarn:!1}),shouldRespectForcePress:d,drop:e=>i(`DROP`,e),cancel:e=>i(`CANCEL`,e),...t.actions}}function g(e){let t=Ei(e=>{m(()=>gs({client:e}))});return{...h({liftActionArgs:{id:i,clientSelection:e,movementMode:`FLUID`},cleanup:()=>t.cancel(),actions:{move:t}}),move:t}}function _(){return h({liftActionArgs:{id:i,clientSelection:mu(c),movementMode:`SNAP`},cleanup:Oi,actions:{moveUp:()=>m(ys),moveRight:()=>m(xs),moveDown:()=>m(bs),moveLeft:()=>m(Ss)}})}function v(){wu({expected:`PRE_DRAG`,phase:u,isLockActive:f,shouldWarn:!0})&&e.release()}return{isActive:()=>wu({expected:`PRE_DRAG`,phase:u,isLockActive:f,shouldWarn:!1}),shouldRespectForcePress:d,fluidLift:g,snapLift:_,abort:v}}var Du=[eu,iu,uu];function Ou({contextId:e,store:t,registry:n,customSensors:r,enableDefaultSensors:i}){let a=[...i?Du:[],...r||[]],o=(0,H.useState)(()=>Ml())[0],s=J(function(e,t){Nl(e)&&!Nl(t)&&o.tryAbandon()},[o]);ul(function(){let e=t.getState();return t.subscribe(()=>{let n=t.getState();s(e,n),e=n})},[o,t,s]),ul(()=>o.tryAbandon,[o.tryAbandon]);let c=J(e=>Tu({lockAPI:o,registry:n,store:t,draggableId:e}),[o,n,t]),l=J((r,i,a)=>Eu({lockAPI:o,registry:n,contextId:e,store:t,draggableId:r,forceSensorStop:i||null,sourceEvent:a&&a.sourceEvent?a.sourceEvent:null}),[e,o,n,t]),u=J(t=>xu(e,t),[e]),d=J(e=>{let t=n.draggable.findById(e);return t?t.options:null},[n.draggable]),f=J(function(){o.isClaimed()&&(o.tryAbandon(),t.getState().phase!==`IDLE`&&t.dispatch(Cs()))},[o,t]),p=J(()=>o.isClaimed(),[o]),m=q(()=>({canGetLock:c,tryGetLock:l,findClosestDraggableId:u,findOptionsForDraggable:d,tryReleaseLock:f,isLockClaimed:p}),[c,l,u,d,f,p]);for(let e=0;e<a.length;e++)a[e](m)}var ku=e=>({onBeforeCapture:t=>{(0,ui.flushSync)(()=>{e.onBeforeCapture&&e.onBeforeCapture(t)})},onBeforeDragStart:e.onBeforeDragStart,onDragStart:e.onDragStart,onDragEnd:e.onDragEnd,onDragUpdate:e.onDragUpdate}),Au=e=>({...jc,...e.autoScrollerOptions,durationDampening:{...jc.durationDampening,...e.autoScrollerOptions}});function ju(e){return!e.current&&K(),e.current}function Mu(e){let{contextId:t,setCallbacks:n,sensors:r,nonce:i,dragHandleUsageInstructions:a}=e,o=(0,H.useRef)(null),s=jl(e),c=J(()=>ku(s.current),[s]),l=J(()=>Au(s.current),[s]),u=Tl(t),d=kl({contextId:t,text:a}),f=pl(t,i),p=J(e=>{ju(o).dispatch(e)},[]),m=q(()=>V({publishWhileDragging:ds,updateDroppableScroll:ps,updateDroppableIsEnabled:ms,updateDroppableIsCombineEnabled:hs,collectionStarting:fs},p),[p]),h=bl(),g=q(()=>Tc(h,m),[h,m]),_=q(()=>el({scrollWindow:Dc,scrollDroppable:g.scrollDroppable,getAutoScrollerOptions:l,...V({move:gs},p)}),[g.scrollDroppable,p,l]),v=vl(t),y=q(()=>gc({announce:u,autoScroller:_,dimensionMarshal:g,focusMarshal:v,getResponders:c,styleMarshal:f}),[u,_,g,v,c,f]);o.current=y;let b=J(()=>{let e=ju(o);e.getState().phase!==`IDLE`&&e.dispatch(Cs())},[]),x=J(()=>{let e=ju(o).getState();return e.phase===`DROP_ANIMATING`?!0:e.phase===`IDLE`?!1:e.isDragging},[]),S=q(()=>({isDragging:x,tryAbort:b}),[x,b]);n(S);let C=J(e=>Ec(ju(o).getState(),e),[]),w=J(()=>Do(ju(o).getState()),[]),T=q(()=>({marshal:g,focus:v,contextId:t,canLift:C,isMovementAllowed:w,dragHandleUsageInstructionsId:d,registry:h}),[t,g,d,v,C,w,h]);return Ou({contextId:t,store:y,registry:h,customSensors:r||null,enableDefaultSensors:e.enableDefaultSensors!==!1}),(0,H.useEffect)(()=>b,[b]),H.createElement(Al.Provider,{value:T},H.createElement(pe,{context:xl,store:y},e.children))}function Nu(){return H.useId()}function Pu(e){let t=Nu(),n=e.dragHandleUsageInstructions||Vi.dragHandleUsageInstructions;return H.createElement(Ni,null,r=>H.createElement(Mu,{nonce:e.nonce,contextId:t,setCallbacks:r,dragHandleUsageInstructions:n,enableDefaultSensors:e.enableDefaultSensors,sensors:e.sensors,onBeforeCapture:e.onBeforeCapture,onBeforeDragStart:e.onBeforeDragStart,onDragStart:e.onDragStart,onDragUpdate:e.onDragUpdate,onDragEnd:e.onDragEnd,autoScrollerOptions:e.autoScrollerOptions},e.children))}var Fu={dragging:5e3,dropAnimating:4500},Iu=(e,t)=>t?Fs.drop(t.duration):e?Fs.snap:Fs.fluid,Lu=(e,t)=>{if(e)return t?Ms.opacity.drop:Ms.opacity.combining},Ru=e=>e.forceShouldAnimate==null?e.mode===`SNAP`:e.forceShouldAnimate;function zu(e){let t=e.dimension.client,{offset:n,combineWith:r,dropping:i}=e,a=!!r,o=Ru(e),s=!!i,c=s?Ls.drop(n,a):Ls.moveTo(n);return{position:`fixed`,top:t.marginBox.top,left:t.marginBox.left,boxSizing:`border-box`,width:t.borderBox.width,height:t.borderBox.height,transition:Iu(o,i),transform:c,opacity:Lu(a,s),zIndex:s?Fu.dropAnimating:Fu.dragging,pointerEvents:`none`}}function Bu(e){return{transform:Ls.moveTo(e.offset),transition:e.shouldAnimateDisplacement?void 0:`none`}}function Vu(e){return e.type===`DRAGGING`?zu(e):Bu(e)}function Hu(e,t,n=Wi){let r=window.getComputedStyle(t),i=t.getBoundingClientRect(),a=wi(i,r),o=Ci(a,n),s={client:a,tagName:t.tagName.toLowerCase(),display:r.display},c={x:a.marginBox.width,y:a.marginBox.height};return{descriptor:e,placeholder:s,displaceBy:c,client:a,page:o}}function Uu(e){let t=Dl(`draggable`),{descriptor:n,registry:r,getDraggableRef:i,canDragInteractiveElements:a,shouldRespectForcePress:o,isEnabled:s}=e,c=q(()=>({canDragInteractiveElements:a,shouldRespectForcePress:o,isEnabled:s}),[a,s,o]),l=J(e=>{let t=i();return!t&&K(),Hu(n,t,e)},[n,i]),u=q(()=>({uniqueId:t,descriptor:n,options:c,getDimension:l}),[n,l,c,t]),d=(0,H.useRef)(u),f=(0,H.useRef)(!0);ul(()=>(r.draggable.register(d.current),()=>r.draggable.unregister(d.current)),[r.draggable]),ul(()=>{if(f.current){f.current=!1;return}let e=d.current;d.current=u,r.draggable.update(u,e)},[u,r.draggable])}var Wu=H.createContext(null);function Gu(e){let t=(0,H.useContext)(e);return!t&&K(),t}function Ku(e){e.preventDefault()}var qu=e=>{let t=(0,H.useRef)(null),n=J((e=null)=>{t.current=e},[]),r=J(()=>t.current,[]),{contextId:i,dragHandleUsageInstructionsId:a,registry:o}=Gu(Al),{type:s,droppableId:c}=Gu(Wu),l=q(()=>({id:e.draggableId,index:e.index,type:s,droppableId:c}),[e.draggableId,e.index,s,c]),{children:u,draggableId:d,isEnabled:f,shouldRespectForcePress:p,canDragInteractiveElements:m,isClone:h,mapped:g,dropAnimationFinished:_}=e;if(!h){let e=q(()=>({descriptor:l,registry:o,getDraggableRef:r,canDragInteractiveElements:m,shouldRespectForcePress:p,isEnabled:f}),[l,o,r,m,p,f]);Uu(e)}let v=q(()=>f?{tabIndex:0,role:`button`,"aria-describedby":a,"data-rfd-drag-handle-draggable-id":d,"data-rfd-drag-handle-context-id":i,draggable:!1,onDragStart:Ku}:null,[i,a,d,f]),y=J(e=>{g.type===`DRAGGING`&&g.dropping&&e.propertyName===`transform`&&(0,ui.flushSync)(_)},[_,g]),b=q(()=>{let e=Vu(g),t=g.type===`DRAGGING`&&g.dropping?y:void 0;return{innerRef:n,draggableProps:{"data-rfd-draggable-context-id":i,"data-rfd-draggable-id":d,style:e,onTransitionEnd:t},dragHandleProps:v}},[i,v,d,g,y,n]),x=q(()=>({draggableId:l.id,type:l.type,source:{index:l.index,droppableId:l.droppableId}}),[l.droppableId,l.id,l.index,l.type]);return H.createElement(H.Fragment,null,u(b,g.snapshot,x))},Ju=(e,t)=>e===t,Yu=e=>{let{combine:t,destination:n}=e;return n?n.droppableId:t?t.droppableId:null},Xu=e=>e.combine?e.combine.draggableId:null,Zu=e=>e.at&&e.at.type===`COMBINE`?e.at.combine.draggableId:null;function Qu(){let e=ca((e,t)=>({x:e,y:t})),t=ca((e,t,n=null,r=null,i=null)=>({isDragging:!0,isClone:t,isDropAnimating:!!i,dropAnimation:i,mode:e,draggingOver:n,combineWith:r,combineTargetFor:null})),n=ca((e,n,r,i,a=null,o=null,s=null)=>({mapped:{type:`DRAGGING`,dropping:null,draggingOver:a,combineWith:o,mode:n,offset:e,dimension:r,forceShouldAnimate:s,snapshot:t(n,i,a,o,null)}}));return(r,i)=>{if(Nl(r)){if(r.critical.draggable.id!==i.draggableId)return null;let t=r.current.client.offset,a=r.dimensions.draggables[i.draggableId],o=wo(r.impact),s=Zu(r.impact),c=r.forceShouldAnimate;return n(e(t.x,t.y),r.movementMode,a,i.isClone,o,s,c)}if(r.phase===`DROP_ANIMATING`){let e=r.completed;if(e.result.draggableId!==i.draggableId)return null;let n=i.isClone,a=r.dimensions.draggables[i.draggableId],o=e.result,s=o.mode,c=Yu(o),l=Xu(o),u={duration:r.dropDuration,curve:js.drop,moveTo:r.newHomeClientOffset,opacity:l?Ms.opacity.drop:null,scale:l?Ms.scale.drop:null};return{mapped:{type:`DRAGGING`,offset:r.newHomeClientOffset,dimension:a,dropping:u,draggingOver:c,combineWith:l,mode:s,forceShouldAnimate:null,snapshot:t(s,n,c,l,u)}}}return null}}function $u(e=null){return{isDragging:!1,isDropAnimating:!1,isClone:!1,dropAnimation:null,mode:null,draggingOver:null,combineTargetFor:e,combineWith:null}}var ed={mapped:{type:`SECONDARY`,offset:Wi,combineTargetFor:null,shouldAnimateDisplacement:!0,snapshot:$u(null)}};function td(){let e=ca((e,t)=>({x:e,y:t})),t=ca($u),n=ca((e,n=null,r)=>({mapped:{type:`SECONDARY`,offset:e,combineTargetFor:n,shouldAnimateDisplacement:r,snapshot:t(n)}})),r=e=>e?n(Wi,e,!0):null,i=(t,i,a,o)=>{let s=a.displaced.visible[t],c=!!(o.inVirtualList&&o.effected[t]),l=ha(a),u=l&&l.draggableId===t?i:null;if(!s){if(!c)return r(u);if(a.displaced.invisible[t])return null;let i=Ji(o.displacedBy.point),s=e(i.x,i.y);return n(s,u,!0)}if(c)return r(u);let d=a.displacedBy.point,f=e(d.x,d.y);return n(f,u,s.shouldAnimate)};return(e,t)=>{if(Nl(e))return e.critical.draggable.id===t.draggableId?null:i(t.draggableId,e.critical.draggable.id,e.impact,e.afterCritical);if(e.phase===`DROP_ANIMATING`){let n=e.completed;return n.result.draggableId===t.draggableId?null:i(t.draggableId,n.result.draggableId,n.impact,n.afterCritical)}return null}}var nd=re(()=>{let e=Qu(),t=td();return(n,r)=>e(n,r)||t(n,r)||ed},{dropAnimationFinished:Os},null,{context:xl,areStatePropsEqual:Ju})(qu);function rd(e){return Gu(Wu).isUsingCloneFor===e.draggableId&&!e.isClone?null:H.createElement(nd,e)}function id(e){let t=typeof e.isDragDisabled==`boolean`?!e.isDragDisabled:!0,n=!!e.disableInteractiveElementBlocking,r=!!e.shouldRespectForcePress;return H.createElement(rd,ke({},e,{isClone:!1,isEnabled:t,canDragInteractiveElements:n,shouldRespectForcePress:r}))}var ad=e=>t=>e===t,od=ad(`scroll`),sd=ad(`auto`),cd=(e,t)=>t(e.overflowX)||t(e.overflowY),ld=e=>{let t=window.getComputedStyle(e),n={overflowX:t.overflowX,overflowY:t.overflowY};return cd(n,od)||cd(n,sd)},ud=()=>!1,dd=e=>e==null?null:e===document.body?ud()?e:null:e===document.documentElement?null:ld(e)?e:dd(e.parentElement),fd=e=>({x:e.scrollLeft,y:e.scrollTop}),pd=e=>e?window.getComputedStyle(e).position===`fixed`?!0:pd(e.parentElement):!1,md=e=>{let t=dd(e),n=pd(e);return{closestScrollable:t,isFixedOnPage:n}},hd=({descriptor:e,isEnabled:t,isCombineEnabled:n,isFixedOnPage:r,direction:i,client:a,page:o,closest:s})=>{let c=(()=>{if(!s)return null;let{scrollSize:e,client:t}=s,n=yc({scrollHeight:e.scrollHeight,scrollWidth:e.scrollWidth,height:t.paddingBox.height,width:t.paddingBox.width});return{pageMarginBox:s.page.marginBox,frameClient:t,scrollSize:e,shouldClipSubject:s.shouldClipSubject,scroll:{initial:s.scroll,current:s.scroll,max:n,diff:{value:Wi,displacement:Wi}}}})(),l=i===`vertical`?Ta:Ea,u=oa({page:o,withPlaceholder:null,axis:l,frame:c});return{descriptor:e,isCombineEnabled:n,isFixedOnPage:r,axis:l,isEnabled:t,client:a,page:o,frame:c,subject:u}},gd=(e,t)=>{let n=Ti(e);if(!t||e!==t)return n;let r=n.paddingBox.top-t.scrollTop,i=n.paddingBox.left-t.scrollLeft,a=r+t.scrollHeight,o=i+t.scrollWidth,s=hi({top:r,right:o,bottom:a,left:i},n.border);return yi({borderBox:s,margin:n.margin,border:n.border,padding:n.padding})},_d=({ref:e,descriptor:t,env:n,windowScroll:r,direction:i,isDropDisabled:a,isCombineEnabled:o,shouldClipSubject:s})=>{let c=n.closestScrollable,l=gd(e,c),u=Ci(l,r),d=(()=>{if(!c)return null;let e=Ti(c),t={scrollHeight:c.scrollHeight,scrollWidth:c.scrollWidth};return{client:e,page:Ci(e,r),scroll:fd(c),scrollSize:t,shouldClipSubject:s}})();return hd({descriptor:t,isEnabled:!a,isCombineEnabled:o,isFixedOnPage:n.isFixedOnPage,direction:i,client:l,page:u,closest:d})},vd={passive:!1},yd={passive:!0},bd=e=>e.shouldPublishImmediately?vd:yd,xd=e=>e&&e.env.closestScrollable||null;function Sd(e){let t=(0,H.useRef)(null),n=Gu(Al),r=Dl(`droppable`),{registry:i,marshal:a}=n,o=jl(e),s=q(()=>({id:e.droppableId,type:e.type,mode:e.mode}),[e.droppableId,e.mode,e.type]),c=(0,H.useRef)(s),l=q(()=>ca((e,n)=>{!t.current&&K();let r={x:e,y:n};a.updateDroppableScroll(s.id,r)}),[s.id,a]),u=J(()=>{let e=t.current;return!e||!e.env.closestScrollable?Wi:fd(e.env.closestScrollable)},[]),d=J(()=>{let e=u();l(e.x,e.y)},[u,l]),f=q(()=>Ei(d),[d]),p=J(()=>{let e=t.current,n=xd(e);if(!(e&&n)&&K(),e.scrollOptions.shouldPublishImmediately){d();return}f()},[f,d]),m=J((e,r)=>{t.current&&K();let i=o.current,a=i.getDroppableRef();!a&&K();let c=md(a),l={ref:a,descriptor:s,env:c,scrollOptions:r};t.current=l;let u=_d({ref:a,descriptor:s,env:c,windowScroll:e,direction:i.direction,isDropDisabled:i.isDropDisabled,isCombineEnabled:i.isCombineEnabled,shouldClipSubject:!i.ignoreContainerClipping}),d=c.closestScrollable;return d&&(d.setAttribute(al.contextId,n.contextId),d.addEventListener(`scroll`,p,bd(l.scrollOptions))),u},[n.contextId,s,p,o]),h=J(()=>{let e=t.current,n=xd(e);return!(e&&n)&&K(),fd(n)},[]),g=J(()=>{let e=t.current;!e&&K();let n=xd(e);t.current=null,n&&(f.cancel(),n.removeAttribute(al.contextId),n.removeEventListener(`scroll`,p,bd(e.scrollOptions)))},[p,f]),_=J(e=>{let n=t.current;!n&&K();let r=xd(n);!r&&K(),r.scrollTop+=e.y,r.scrollLeft+=e.x},[]),v=q(()=>({getDimensionAndWatchScroll:m,getScrollWhileDragging:h,dragStopped:g,scroll:_}),[g,m,h,_]),y=q(()=>({uniqueId:r,descriptor:s,callbacks:v}),[v,s,r]);ul(()=>(c.current=y.descriptor,i.droppable.register(y),()=>{t.current&&g(),i.droppable.unregister(y)}),[v,s,g,y,a,i.droppable]),ul(()=>{t.current&&a.updateDroppableIsEnabled(c.current.id,!e.isDropDisabled)},[e.isDropDisabled,a]),ul(()=>{t.current&&a.updateDroppableIsCombineEnabled(c.current.id,e.isCombineEnabled)},[e.isCombineEnabled,a])}function Cd(){}var wd={width:0,height:0,margin:na},Td=({isAnimatingOpenOnMount:e,placeholder:t,animate:n})=>e||n===`close`?wd:{height:t.client.borderBox.height,width:t.client.borderBox.width,margin:t.client.margin},Ed=({isAnimatingOpenOnMount:e,placeholder:t,animate:n})=>{let r=Td({isAnimatingOpenOnMount:e,placeholder:t,animate:n});return{display:t.display,boxSizing:`border-box`,width:r.width,height:r.height,marginTop:r.margin.top,marginRight:r.margin.right,marginBottom:r.margin.bottom,marginLeft:r.margin.left,flexShrink:`0`,flexGrow:`0`,pointerEvents:`none`,transition:n===`none`?null:Fs.placeholder}},Dd=H.memo(e=>{let t=(0,H.useRef)(null),n=J(()=>{t.current&&=(clearTimeout(t.current),null)},[]),{animate:r,onTransitionEnd:i,onClose:a,contextId:o}=e,[s,c]=(0,H.useState)(e.animate===`open`);(0,H.useEffect)(()=>s?r===`open`?t.current?Cd:(t.current=setTimeout(()=>{t.current=null,c(!1)}),n):(n(),c(!1),Cd):Cd,[r,s,n]);let l=J(e=>{e.propertyName===`height`&&(i(),r===`close`&&a())},[r,a,i]),u=Ed({isAnimatingOpenOnMount:s,animate:e.animate,placeholder:e.placeholder});return H.createElement(e.placeholder.tagName,{style:u,"data-rfd-placeholder-context-id":o,onTransitionEnd:l,ref:e.innerRef})}),Od=class extends H.PureComponent{constructor(...e){super(...e),this.state={isVisible:!!this.props.on,data:this.props.on,animate:this.props.shouldAnimate&&this.props.on?`open`:`none`},this.onClose=()=>{this.state.animate===`close`&&this.setState({isVisible:!1})}}static getDerivedStateFromProps(e,t){return e.shouldAnimate?e.on?{isVisible:!0,data:e.on,animate:`open`}:t.isVisible?{isVisible:!0,data:t.data,animate:`close`}:{isVisible:!1,animate:`close`,data:null}:{isVisible:!!e.on,data:e.on,animate:`none`}}render(){if(!this.state.isVisible)return null;let e={onClose:this.onClose,data:this.state.data,animate:this.state.animate};return this.props.children(e)}},kd=e=>{let t=(0,H.useContext)(Al);!t&&K();let{contextId:n,isMovementAllowed:r}=t,i=(0,H.useRef)(null),a=(0,H.useRef)(null),{children:o,droppableId:s,type:c,mode:l,direction:u,ignoreContainerClipping:d,isDropDisabled:f,isCombineEnabled:p,snapshot:m,useClone:h,updateViewportMaxScroll:g,getContainerForClone:_}=e,v=J(()=>i.current,[]),y=J((e=null)=>{i.current=e},[]);J(()=>a.current,[]);let b=J((e=null)=>{a.current=e},[]),x=J(()=>{r()&&g({maxScroll:xc()})},[r,g]);Sd({droppableId:s,type:c,mode:l,direction:u,isDropDisabled:f,isCombineEnabled:p,ignoreContainerClipping:d,getDroppableRef:v});let S=q(()=>H.createElement(Od,{on:e.placeholder,shouldAnimate:e.shouldAnimatePlaceholder},({onClose:e,data:t,animate:r})=>H.createElement(Dd,{placeholder:t,onClose:e,innerRef:b,animate:r,contextId:n,onTransitionEnd:x})),[n,x,e.placeholder,e.shouldAnimatePlaceholder,b]),C=q(()=>({innerRef:y,placeholder:S,droppableProps:{"data-rfd-droppable-id":s,"data-rfd-droppable-context-id":n}}),[n,s,S,y]),w=h?h.dragging.draggableId:null,T=q(()=>({droppableId:s,type:c,isUsingCloneFor:w}),[s,w,c]);function E(){if(!h)return null;let{dragging:e,render:t}=h,n=H.createElement(rd,{draggableId:e.draggableId,index:e.source.index,isClone:!0,isEnabled:!0,shouldRespectForcePress:!1,canDragInteractiveElements:!0},(n,r)=>t(n,r,e));return ui.createPortal(n,_())}return H.createElement(Wu.Provider,{value:T},o(C,m),E())};function Ad(){return!document.body&&K(),document.body}var jd={mode:`standard`,type:`DEFAULT`,direction:`vertical`,isDropDisabled:!1,isCombineEnabled:!1,ignoreContainerClipping:!1,renderClone:null,getContainerForClone:Ad},Md=e=>{let t={...e},n;for(n in jd)e[n]===void 0&&(t={...t,[n]:jd[n]});return t},Nd=(e,t)=>e===t.droppable.type,Pd=(e,t)=>t.draggables[e.draggable.id],Fd=re(()=>{let e={placeholder:null,shouldAnimatePlaceholder:!0,snapshot:{isDraggingOver:!1,draggingOverWith:null,draggingFromThisWith:null,isUsingPlaceholder:!1},useClone:null},t={...e,shouldAnimatePlaceholder:!1},n=ca(e=>({draggableId:e.id,type:e.type,source:{index:e.index,droppableId:e.droppableId}})),r=ca((r,i,a,o,s,c)=>{let l=s.descriptor.id;if(s.descriptor.droppableId===r){let e=c?{render:c,dragging:n(s.descriptor)}:null,t={isDraggingOver:a,draggingOverWith:a?l:null,draggingFromThisWith:l,isUsingPlaceholder:!0};return{placeholder:s.placeholder,shouldAnimatePlaceholder:!1,snapshot:t,useClone:e}}if(!i)return t;if(!o)return e;let u={isDraggingOver:a,draggingOverWith:l,draggingFromThisWith:null,isUsingPlaceholder:!0};return{placeholder:s.placeholder,shouldAnimatePlaceholder:!0,snapshot:u,useClone:null}});return(n,i)=>{let a=Md(i),o=a.droppableId,s=a.type,c=!a.isDropDisabled,l=a.renderClone;if(Nl(n)){let e=n.critical;if(!Nd(s,e))return t;let i=Pd(e,n.dimensions),a=wo(n.impact)===o;return r(o,c,a,a,i,l)}if(n.phase===`DROP_ANIMATING`){let e=n.completed;if(!Nd(s,e.critical))return t;let i=Pd(e.critical,n.dimensions);return r(o,c,Yu(e.result)===o,wo(e.impact)===o,i,l)}if(n.phase===`IDLE`&&n.completed&&!n.shouldFlush){let r=n.completed;if(!Nd(s,r.critical))return t;let i=wo(r.impact)===o,a=!!(r.impact.at&&r.impact.at.type===`COMBINE`),c=r.critical.droppable.id===o;return i?a?e:t:c?e:t}return t}},{updateViewportMaxScroll:vs},(e,t,n)=>({...Md(n),...e,...t}),{context:xl,areStatePropsEqual:Ju})(kd),Id=x((0,U.jsx)(`path`,{d:`M11 18c0 1.1-.9 2-2 2s-2-.9-2-2 .9-2 2-2 2 .9 2 2m-2-8c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2m0-6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2m6 4c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2m0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2m0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2`}),`DragIndicator`),Ld={position:`absolute`,top:`50%`,left:`50%`,transform:`translate(-50%, -50%)`,width:`90%`,maxWidth:`800px`,bgcolor:`background.paper`,border:`2px solid #000`,boxShadow:24,p:4,display:`flex`,flexDirection:`column`,maxHeight:`90vh`};function Rd({open:e,onClose:t}){let n=se(),{library:r}=Ne(e=>e.knowledge),{isApiCommunicating:i}=Ne(e=>e.case),[o,s]=(0,H.useState)(``),[c,d]=(0,H.useState)(``),[p,h]=(0,H.useState)([]);(0,H.useEffect)(()=>{e||(s(``),d(``),h([]))},[e]);let g=async()=>{if(!o.trim()||!c.trim()){alert(`フロー名とプロンプトの両方を入力してください。`);return}n(R(!0)),h([]);let e=`あなたは優秀な業務コンサルタントです。あなたは以下の「知識ライブラリ」に含まれる知識項目だけを使い、ユーザーの要望に沿った業務フローを提案するタスクを実行します。

# 知識ライブラリ
${JSON.stringify(r,null,2)}

# ユーザーの要望
${c}

# 厳格なルール
- **必ず知識ライブラリに存在する知識項目のみを組み合わせて**フローを構築してください。ライブラリに存在しないタスクを創作してはいけません。
- 生成する各タスクには、元となった知識ライブラリの知識ID（例: 'k-001'）を\`refId\`プロパティとして必ず含めてください。
- ユーザーの要望に最も合致すると思われる知識項目を選択し、適切な順序で並べてください。
- 出力は指定されたJSON形式の配列のみとし、それ以外のテキストは一切含めないでください。

# 出力JSONフォーマット
[
  {
    "id": "ユニークなIDを新たに生成",
    "text": "知識ライブラリのtextを引用",
    "details": "知識ライブラリのdetailsを引用",
    "refId": "元になった知識のID (例: 'k-001')",
    "type": "知識ライブラリのtypeを引用",
    "options": "知識ライブラリのoptionsが存在すれば引用"
  }
]
`;try{let t=new E;if(!t.isAvailable)throw alert(`Gemini APIキーまたはモデルIDが設定されていません。設定ページをご確認ください。`),Error(`API not available`);let n=(await t.generateContent(e)).replace(/```json/g,``).replace(/```/g,``).trim(),r=JSON.parse(n).map(e=>({...e,id:B(),completed:!1,memo:``}));h(r)}catch(e){console.error(`AI-based flow generation failed:`,e),alert(`フローの自動生成に失敗しました: ${e.message}`)}finally{n(R(!1))}},_=()=>{if(!o.trim()||p.length===0){alert(`フロー名を入力し、タスクを1つ以上生成してください。`);return}let e={id:`flow-${B()}`,name:o,description:`AIが「${c}」という指示を基に生成しました。`,tasks:p};n(de(e)),alert(`新しいフロー「${o}」を保存しました。`),t()},v=(e,t)=>{let n=[...p];n[e].text=t,h(n)},b=()=>{let e={id:B(),text:`新しいタスク`,details:``,completed:!1,memo:``};h([...p,e])},x=e=>{let t=p.filter((t,n)=>n!==e);h(t)};return(0,U.jsx)(f,{open:e,onClose:t,children:(0,U.jsxs)(z,{sx:Ld,children:[(0,U.jsx)(a,{variant:`h6`,component:`h2`,gutterBottom:!0,children:`AIによるフロー自動生成`}),(0,U.jsxs)(z,{sx:{display:`flex`,flexDirection:`column`,gap:2,mb:2},children:[(0,U.jsx)(y,{label:`フロー名`,variant:`outlined`,fullWidth:!0,value:o,onChange:e=>s(e.target.value)}),(0,U.jsx)(y,{label:`プロンプト (どのようなフローを生成したいですか？)`,variant:`outlined`,fullWidth:!0,multiline:!0,rows:4,value:c,onChange:e=>d(e.target.value),placeholder:`例: 新車販売の基本的な流れ, クレーム対応の詳細な手順`})]}),(0,U.jsxs)(z,{sx:{mb:2},children:[(0,U.jsx)(u,{variant:`contained`,onClick:g,disabled:i,children:i?(0,U.jsx)(he,{size:24}):`生成開始`}),(0,U.jsx)(u,{onClick:t,sx:{ml:1},children:`キャンセル`})]}),(0,U.jsx)(a,{variant:`subtitle1`,gutterBottom:!0,children:`生成結果表示エリア`}),(0,U.jsxs)(z,{sx:{flexGrow:1,overflow:`auto`,border:`1px solid #ccc`,p:1,borderRadius:1,minHeight:`200px`},children:[i&&(0,U.jsx)(z,{sx:{display:`flex`,justifyContent:`center`,alignItems:`center`,height:`100%`},children:(0,U.jsx)(he,{})}),!i&&p.length===0&&(0,U.jsx)(z,{sx:{display:`flex`,justifyContent:`center`,alignItems:`center`,height:`100%`},children:(0,U.jsx)(a,{color:`text.secondary`,children:`ここに生成されたタスクリストが表示されます`})}),!i&&p.length>0&&(0,U.jsx)(Pu,{onDragEnd:e=>{if(!e.destination)return;let t=Array.from(p),[n]=t.splice(e.source.index,1);t.splice(e.destination.index,0,n),h(t)},children:(0,U.jsx)(Fd,{droppableId:`tasks`,children:e=>(0,U.jsxs)(m,{...e.droppableProps,ref:e.innerRef,dense:!0,children:[p.map((e,t)=>(0,U.jsx)(id,{draggableId:String(e.id),index:t,children:n=>(0,U.jsxs)(P,{ref:n.innerRef,...n.draggableProps,secondaryAction:(0,U.jsx)(l,{edge:`end`,onClick:()=>x(t),children:(0,U.jsx)(k,{})}),children:[(0,U.jsx)(z,{...n.dragHandleProps,sx:{display:`flex`,alignItems:`center`,cursor:`grab`,mr:1.5},children:(0,U.jsx)(Id,{})}),(0,U.jsx)(y,{variant:`standard`,fullWidth:!0,value:e.text,onChange:e=>v(t,e.target.value)})]})},e.id)),e.placeholder]})})})]}),(0,U.jsx)(u,{onClick:b,sx:{mt:1},children:`項目を追加`}),(0,U.jsx)(z,{sx:{mt:`auto`,pt:2,display:`flex`,justifyContent:`flex-end`},children:(0,U.jsx)(u,{variant:`contained`,color:`primary`,onClick:_,disabled:i||p.length===0,children:`フローとして保存`})})]})})}var zd=Rd;function Bd(e){let t=null;return()=>(t??=e(),t)}function Vd(e,t){return e.filter(e=>e!==t)}function Hd(e,t){let n=new Set,r=e=>n.add(e);e.forEach(r),t.forEach(r);let i=[];return n.forEach(e=>i.push(e)),i}var Ud=class{enter(e){let t=this.entered.length;return this.entered=Hd(this.entered.filter(t=>this.isNodeInDocument(t)&&(!t.contains||t.contains(e))),[e]),t===0&&this.entered.length>0}leave(e){let t=this.entered.length;return this.entered=Vd(this.entered.filter(this.isNodeInDocument),e),t>0&&this.entered.length===0}reset(){this.entered=[]}constructor(e){this.entered=[],this.isNodeInDocument=e}},Wd=class{initializeExposedProperties(){Object.keys(this.config.exposeProperties).forEach(e=>{Object.defineProperty(this.item,e,{configurable:!0,enumerable:!0,get(){return console.warn(`Browser doesn't allow reading "${e}" until the drop event.`),null}})})}loadDataTransfer(e){if(e){let t={};Object.keys(this.config.exposeProperties).forEach(n=>{let r=this.config.exposeProperties[n];r!=null&&(t[n]={value:r(e,this.config.matchesTypes),configurable:!0,enumerable:!0})}),Object.defineProperties(this.item,t)}}canDrag(){return!0}beginDrag(){return this.item}isDragging(e,t){return t===e.getSourceId()}endDrag(){}constructor(e){this.config=e,this.item={},this.initializeExposedProperties()}},Gd=ue({FILE:()=>Kd,HTML:()=>Yd,TEXT:()=>Jd,URL:()=>qd});const Kd=`__NATIVE_FILE__`,qd=`__NATIVE_URL__`,Jd=`__NATIVE_TEXT__`,Yd=`__NATIVE_HTML__`;function Xd(e,t,n){return t.reduce((t,n)=>t||e.getData(n),``)??n}const Zd={[Kd]:{exposeProperties:{files:e=>Array.prototype.slice.call(e.files),items:e=>e.items,dataTransfer:e=>e},matchesTypes:[`Files`]},[Yd]:{exposeProperties:{html:(e,t)=>Xd(e,t,``),dataTransfer:e=>e},matchesTypes:[`Html`,`text/html`]},[qd]:{exposeProperties:{urls:(e,t)=>Xd(e,t,``).split(`
`),dataTransfer:e=>e},matchesTypes:[`Url`,`text/uri-list`]},[Jd]:{exposeProperties:{text:(e,t)=>Xd(e,t,``),dataTransfer:e=>e},matchesTypes:[`Text`,`text/plain`]}};function Qd(e,t){let n=Zd[e];if(!n)throw Error(`native type ${e} has no configuration`);let r=new Wd(n);return r.loadDataTransfer(t),r}function $d(e){if(!e)return null;let t=Array.prototype.slice.call(e.types||[]);return Object.keys(Zd).filter(e=>{let n=Zd[e];return n?.matchesTypes?n.matchesTypes.some(e=>t.indexOf(e)>-1):!1})[0]||null}const ef=Bd(()=>/firefox/i.test(navigator.userAgent)),tf=Bd(()=>!!window.safari);var nf=class{interpolate(e){let{xs:t,ys:n,c1s:r,c2s:i,c3s:a}=this,o=t.length-1;if(e===t[o])return n[o];let s=0,c=a.length-1,l;for(;s<=c;){l=Math.floor(.5*(s+c));let r=t[l];if(r<e)s=l+1;else if(r>e)c=l-1;else return n[l]}o=Math.max(0,c);let u=e-t[o],d=u*u;return n[o]+r[o]*u+i[o]*d+a[o]*u*d}constructor(e,t){let{length:n}=e,r=[];for(let e=0;e<n;e++)r.push(e);r.sort((t,n)=>e[t]<e[n]?-1:1);let i=[],a=[],o=[],s,c;for(let r=0;r<n-1;r++)s=e[r+1]-e[r],c=t[r+1]-t[r],a.push(s),i.push(c),o.push(c/s);let l=[o[0]];for(let e=0;e<a.length-1;e++){let t=o[e],n=o[e+1];if(t*n<=0)l.push(0);else{s=a[e];let r=a[e+1],i=s+r;l.push(3*i/((i+r)/t+(i+s)/n))}}l.push(o[o.length-1]);let u=[],d=[],f;for(let e=0;e<l.length-1;e++){f=o[e];let t=l[e],n=1/a[e],r=t+l[e+1]-f-f;u.push((f-t-r)*n),d.push(r*n*n)}this.xs=e,this.ys=t,this.c1s=l,this.c2s=u,this.c3s=d}},rf=1;function af(e){let t=e.nodeType===rf?e:e.parentElement;if(!t)return null;let{top:n,left:r}=t.getBoundingClientRect();return{x:r,y:n}}function sf(e){return{x:e.clientX,y:e.clientY}}function cf(e){return e.nodeName===`IMG`&&(ef()||!document.documentElement?.contains(e))}function lf(e,t,n,r){let i=e?t.width:n,a=e?t.height:r;return tf()&&e&&(a/=window.devicePixelRatio,i/=window.devicePixelRatio),{dragPreviewWidth:i,dragPreviewHeight:a}}function uf(e,t,n,r,i){let a=cf(t),o=af(a?e:t),s={x:n.x-o.x,y:n.y-o.y},{offsetWidth:c,offsetHeight:l}=e,{anchorX:u,anchorY:d}=r,{dragPreviewWidth:f,dragPreviewHeight:p}=lf(a,t,c,l),m=()=>{let e=new nf([0,.5,1],[s.y,s.y/l*p,s.y+p-l]).interpolate(d);return tf()&&a&&(e+=(window.devicePixelRatio-1)*p),e},h=()=>new nf([0,.5,1],[s.x,s.x/c*f,s.x+f-c]).interpolate(u),{offsetX:g,offsetY:_}=i,v=g===0||g,y=_===0||_;return{x:v?g:h(),y:y?_:m()}}var df=class{get window(){if(this.globalContext)return this.globalContext;if(typeof window<`u`)return window}get document(){if(this.globalContext?.document)return this.globalContext.document;if(this.window)return this.window.document}get rootElement(){return this.optionsArgs?.rootElement||this.window}constructor(e,t){this.ownerDocument=null,this.globalContext=e,this.optionsArgs=t}};function ff(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function pf(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]==null?{}:arguments[t],r=Object.keys(n);typeof Object.getOwnPropertySymbols==`function`&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){ff(e,t,n[t])})}return e}var mf=class{profile(){return{sourcePreviewNodes:this.sourcePreviewNodes.size,sourcePreviewNodeOptions:this.sourcePreviewNodeOptions.size,sourceNodeOptions:this.sourceNodeOptions.size,sourceNodes:this.sourceNodes.size,dragStartSourceIds:this.dragStartSourceIds?.length||0,dropTargetIds:this.dropTargetIds.length,dragEnterTargetIds:this.dragEnterTargetIds.length,dragOverTargetIds:this.dragOverTargetIds?.length||0}}get window(){return this.options.window}get document(){return this.options.document}get rootElement(){return this.options.rootElement}setup(){let e=this.rootElement;if(e!==void 0){if(e.__isReactDndBackendSetUp)throw Error(`Cannot have two HTML5 backends at the same time.`);e.__isReactDndBackendSetUp=!0,this.addEventListeners(e)}}teardown(){let e=this.rootElement;if(e!==void 0&&(e.__isReactDndBackendSetUp=!1,this.removeEventListeners(this.rootElement),this.clearCurrentDragSourceNode(),this.asyncEndDragFrameId)){var t;(t=this.window)==null||t.cancelAnimationFrame(this.asyncEndDragFrameId)}}connectDragPreview(e,t,n){return this.sourcePreviewNodeOptions.set(e,n),this.sourcePreviewNodes.set(e,t),()=>{this.sourcePreviewNodes.delete(e),this.sourcePreviewNodeOptions.delete(e)}}connectDragSource(e,t,n){this.sourceNodes.set(e,t),this.sourceNodeOptions.set(e,n);let r=t=>this.handleDragStart(t,e),i=e=>this.handleSelectStart(e);return t.setAttribute(`draggable`,`true`),t.addEventListener(`dragstart`,r),t.addEventListener(`selectstart`,i),()=>{this.sourceNodes.delete(e),this.sourceNodeOptions.delete(e),t.removeEventListener(`dragstart`,r),t.removeEventListener(`selectstart`,i),t.setAttribute(`draggable`,`false`)}}connectDropTarget(e,t){let n=t=>this.handleDragEnter(t,e),r=t=>this.handleDragOver(t,e),i=t=>this.handleDrop(t,e);return t.addEventListener(`dragenter`,n),t.addEventListener(`dragover`,r),t.addEventListener(`drop`,i),()=>{t.removeEventListener(`dragenter`,n),t.removeEventListener(`dragover`,r),t.removeEventListener(`drop`,i)}}addEventListeners(e){e.addEventListener&&(e.addEventListener(`dragstart`,this.handleTopDragStart),e.addEventListener(`dragstart`,this.handleTopDragStartCapture,!0),e.addEventListener(`dragend`,this.handleTopDragEndCapture,!0),e.addEventListener(`dragenter`,this.handleTopDragEnter),e.addEventListener(`dragenter`,this.handleTopDragEnterCapture,!0),e.addEventListener(`dragleave`,this.handleTopDragLeaveCapture,!0),e.addEventListener(`dragover`,this.handleTopDragOver),e.addEventListener(`dragover`,this.handleTopDragOverCapture,!0),e.addEventListener(`drop`,this.handleTopDrop),e.addEventListener(`drop`,this.handleTopDropCapture,!0))}removeEventListeners(e){e.removeEventListener&&(e.removeEventListener(`dragstart`,this.handleTopDragStart),e.removeEventListener(`dragstart`,this.handleTopDragStartCapture,!0),e.removeEventListener(`dragend`,this.handleTopDragEndCapture,!0),e.removeEventListener(`dragenter`,this.handleTopDragEnter),e.removeEventListener(`dragenter`,this.handleTopDragEnterCapture,!0),e.removeEventListener(`dragleave`,this.handleTopDragLeaveCapture,!0),e.removeEventListener(`dragover`,this.handleTopDragOver),e.removeEventListener(`dragover`,this.handleTopDragOverCapture,!0),e.removeEventListener(`drop`,this.handleTopDrop),e.removeEventListener(`drop`,this.handleTopDropCapture,!0))}getCurrentSourceNodeOptions(){let e=this.monitor.getSourceId(),t=this.sourceNodeOptions.get(e);return pf({dropEffect:this.altKeyPressed?`copy`:`move`},t||{})}getCurrentDropEffect(){return this.isDraggingNativeItem()?`copy`:this.getCurrentSourceNodeOptions().dropEffect}getCurrentSourcePreviewNodeOptions(){let e=this.monitor.getSourceId(),t=this.sourcePreviewNodeOptions.get(e);return pf({anchorX:.5,anchorY:.5,captureDraggingState:!1},t||{})}isDraggingNativeItem(){let e=this.monitor.getItemType();return Object.keys(Gd).some(t=>Gd[t]===e)}beginDragNativeItem(e,t){this.clearCurrentDragSourceNode(),this.currentNativeSource=Qd(e,t),this.currentNativeHandle=this.registry.addSource(e,this.currentNativeSource),this.actions.beginDrag([this.currentNativeHandle])}setCurrentDragSourceNode(e){this.clearCurrentDragSourceNode(),this.currentDragSourceNode=e,this.mouseMoveTimeoutTimer=setTimeout(()=>this.rootElement?.addEventListener(`mousemove`,this.endDragIfSourceWasRemovedFromDOM,!0),1e3)}clearCurrentDragSourceNode(){if(this.currentDragSourceNode){if(this.currentDragSourceNode=null,this.rootElement){var e;(e=this.window)==null||e.clearTimeout(this.mouseMoveTimeoutTimer||void 0),this.rootElement.removeEventListener(`mousemove`,this.endDragIfSourceWasRemovedFromDOM,!0)}return this.mouseMoveTimeoutTimer=null,!0}return!1}handleDragStart(e,t){e.defaultPrevented||(this.dragStartSourceIds||=[],this.dragStartSourceIds.unshift(t))}handleDragEnter(e,t){this.dragEnterTargetIds.unshift(t)}handleDragOver(e,t){this.dragOverTargetIds===null&&(this.dragOverTargetIds=[]),this.dragOverTargetIds.unshift(t)}handleDrop(e,t){this.dropTargetIds.unshift(t)}constructor(e,t,n){this.sourcePreviewNodes=new Map,this.sourcePreviewNodeOptions=new Map,this.sourceNodes=new Map,this.sourceNodeOptions=new Map,this.dragStartSourceIds=null,this.dropTargetIds=[],this.dragEnterTargetIds=[],this.currentNativeSource=null,this.currentNativeHandle=null,this.currentDragSourceNode=null,this.altKeyPressed=!1,this.mouseMoveTimeoutTimer=null,this.asyncEndDragFrameId=null,this.dragOverTargetIds=null,this.lastClientOffset=null,this.hoverRafId=null,this.getSourceClientOffset=e=>{let t=this.sourceNodes.get(e);return t&&af(t)||null},this.endDragNativeItem=()=>{this.isDraggingNativeItem()&&(this.actions.endDrag(),this.currentNativeHandle&&this.registry.removeSource(this.currentNativeHandle),this.currentNativeHandle=null,this.currentNativeSource=null)},this.isNodeInDocument=e=>!!(e&&this.document&&this.document.body&&this.document.body.contains(e)),this.endDragIfSourceWasRemovedFromDOM=()=>{let e=this.currentDragSourceNode;e==null||this.isNodeInDocument(e)||(this.clearCurrentDragSourceNode()&&this.monitor.isDragging()&&this.actions.endDrag(),this.cancelHover())},this.scheduleHover=e=>{this.hoverRafId===null&&typeof requestAnimationFrame<`u`&&(this.hoverRafId=requestAnimationFrame(()=>{this.monitor.isDragging()&&this.actions.hover(e||[],{clientOffset:this.lastClientOffset}),this.hoverRafId=null}))},this.cancelHover=()=>{this.hoverRafId!==null&&typeof cancelAnimationFrame<`u`&&(cancelAnimationFrame(this.hoverRafId),this.hoverRafId=null)},this.handleTopDragStartCapture=()=>{this.clearCurrentDragSourceNode(),this.dragStartSourceIds=[]},this.handleTopDragStart=e=>{if(e.defaultPrevented)return;let{dragStartSourceIds:t}=this;this.dragStartSourceIds=null;let n=sf(e);this.monitor.isDragging()&&(this.actions.endDrag(),this.cancelHover()),this.actions.beginDrag(t||[],{publishSource:!1,getSourceClientOffset:this.getSourceClientOffset,clientOffset:n});let{dataTransfer:r}=e,i=$d(r);if(this.monitor.isDragging()){if(r&&typeof r.setDragImage==`function`){let e=this.monitor.getSourceId(),t=this.sourceNodes.get(e),i=this.sourcePreviewNodes.get(e)||t;if(i){let{anchorX:e,anchorY:a,offsetX:o,offsetY:s}=this.getCurrentSourcePreviewNodeOptions(),c=uf(t,i,n,{anchorX:e,anchorY:a},{offsetX:o,offsetY:s});r.setDragImage(i,c.x,c.y)}}try{r?.setData(`application/json`,{})}catch{}this.setCurrentDragSourceNode(e.target);let{captureDraggingState:t}=this.getCurrentSourcePreviewNodeOptions();t?this.actions.publishDragSource():setTimeout(()=>this.actions.publishDragSource(),0)}else if(i)this.beginDragNativeItem(i);else if(r&&!r.types&&(e.target&&!e.target.hasAttribute||!e.target.hasAttribute(`draggable`)))return;else e.preventDefault()},this.handleTopDragEndCapture=()=>{this.clearCurrentDragSourceNode()&&this.monitor.isDragging()&&this.actions.endDrag(),this.cancelHover()},this.handleTopDragEnterCapture=e=>{if(this.dragEnterTargetIds=[],this.isDraggingNativeItem()){var t;(t=this.currentNativeSource)==null||t.loadDataTransfer(e.dataTransfer)}if(!this.enterLeaveCounter.enter(e.target)||this.monitor.isDragging())return;let{dataTransfer:n}=e,r=$d(n);r&&this.beginDragNativeItem(r,n)},this.handleTopDragEnter=e=>{let{dragEnterTargetIds:t}=this;this.dragEnterTargetIds=[],this.monitor.isDragging()&&(this.altKeyPressed=e.altKey,t.length>0&&this.actions.hover(t,{clientOffset:sf(e)}),t.some(e=>this.monitor.canDropOnTarget(e))&&(e.preventDefault(),e.dataTransfer&&(e.dataTransfer.dropEffect=this.getCurrentDropEffect())))},this.handleTopDragOverCapture=e=>{if(this.dragOverTargetIds=[],this.isDraggingNativeItem()){var t;(t=this.currentNativeSource)==null||t.loadDataTransfer(e.dataTransfer)}},this.handleTopDragOver=e=>{let{dragOverTargetIds:t}=this;if(this.dragOverTargetIds=[],!this.monitor.isDragging()){e.preventDefault(),e.dataTransfer&&(e.dataTransfer.dropEffect=`none`);return}this.altKeyPressed=e.altKey,this.lastClientOffset=sf(e),this.scheduleHover(t),(t||[]).some(e=>this.monitor.canDropOnTarget(e))?(e.preventDefault(),e.dataTransfer&&(e.dataTransfer.dropEffect=this.getCurrentDropEffect())):this.isDraggingNativeItem()?e.preventDefault():(e.preventDefault(),e.dataTransfer&&(e.dataTransfer.dropEffect=`none`))},this.handleTopDragLeaveCapture=e=>{this.isDraggingNativeItem()&&e.preventDefault(),this.enterLeaveCounter.leave(e.target)&&(this.isDraggingNativeItem()&&setTimeout(()=>this.endDragNativeItem(),0),this.cancelHover())},this.handleTopDropCapture=e=>{if(this.dropTargetIds=[],this.isDraggingNativeItem()){var t;e.preventDefault(),(t=this.currentNativeSource)==null||t.loadDataTransfer(e.dataTransfer)}else $d(e.dataTransfer)&&e.preventDefault();this.enterLeaveCounter.reset()},this.handleTopDrop=e=>{let{dropTargetIds:t}=this;this.dropTargetIds=[],this.actions.hover(t,{clientOffset:sf(e)}),this.actions.drop({dropEffect:this.getCurrentDropEffect()}),this.isDraggingNativeItem()?this.endDragNativeItem():this.monitor.isDragging()&&this.actions.endDrag(),this.cancelHover()},this.handleSelectStart=e=>{let t=e.target;typeof t.dragDrop==`function`&&(t.tagName===`INPUT`||t.tagName===`SELECT`||t.tagName===`TEXTAREA`||t.isContentEditable||(e.preventDefault(),t.dragDrop()))},this.options=new df(t,n),this.actions=e.getActions(),this.monitor=e.getMonitor(),this.registry=e.getRegistry(),this.enterLeaveCounter=new Ud(this.isNodeInDocument)}};const hf=function(e,t,n){return new mf(e,t,n)};var gf=x((0,U.jsx)(`path`,{d:`M3 10h11v2H3zm0-2h11V6H3zm0 8h7v-2H3zm15.01-3.13.71-.71c.39-.39 1.02-.39 1.41 0l.71.71c.39.39.39 1.02 0 1.41l-.71.71zm-.71.71-5.3 5.3V21h2.12l5.3-5.3z`}),`EditNote`),_f=x([(0,U.jsx)(`path`,{d:`M3 6H1v13c0 1.1.9 2 2 2h17v-2H3z`},`0`),(0,U.jsx)(`path`,{d:`M21 4h-7l-2-2H7c-1.1 0-1.99.9-1.99 2L5 15c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2`},`1`)],`FolderCopy`),vf=x((0,U.jsx)(`path`,{d:`m5.2494 8.0688 2.83-2.8269 14.1343 14.15-2.83 2.8269zm4.2363-4.2415 2.828-2.8289 5.6577 5.656-2.828 2.8289zM.9989 12.3147l2.8284-2.8285 5.6569 5.6569-2.8285 2.8284zM1 21h12v2H1z`}),`Gavel`),yf=x((0,U.jsx)(`path`,{d:`M13 7h-2v4H7v2h4v4h2v-4h4v-2h-4zm-1-5C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8`}),`AddCircleOutline`),bf=x((0,U.jsx)(`path`,{d:`M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6zM8 9h8v10H8zm7.5-5-1-1h-5l-1 1H5v2h14V4z`}),`DeleteOutline`),xf={type:`direct`,prompt:``,nextFlowId:``,branches:[{id:ze(),label:``,nextFlowId:``}]};function Sf(){let e=se(),{flowLibrary:n}=Ne(e=>e.case),[r,i]=(0,H.useState)(null),[o,s]=(0,H.useState)(!1),[c,f]=(0,H.useState)(xf),g=n.find(e=>e.id===r);(0,H.useEffect)(()=>{g?g.joint?(f({...xf,...g.joint,branches:g.joint.branches?.length>0?g.joint.branches:xf.branches}),s(!0)):(f(xf),s(!1)):(i(null),s(!1),f(xf))},[r,g]);let b=()=>{let t={type:c.type};c.type===`direct`?t.nextFlowId=c.nextFlowId:(t.prompt=c.prompt,t.branches=c.branches),e(ae({flowId:r,joint:t}))},x=()=>{e(ae({flowId:r,joint:null}))},E=()=>{f(e=>({...e,branches:[...e.branches,{id:ze(),label:``,nextFlowId:``}]}))},D=e=>{f(t=>({...t,branches:t.branches.filter(t=>t.id!==e)}))},O=(e,t,n)=>{f(r=>({...r,branches:r.branches.map(r=>r.id===e?{...r,[t]:n}:r)}))},k=n.filter(e=>e.id!==r);return(0,U.jsxs)(z,{sx:{display:`flex`,gap:2,height:`100%`,minHeight:0},children:[(0,U.jsxs)(p,{sx:{flex:`0 1 320px`,minWidth:280,p:2,overflow:`auto`},children:[(0,U.jsx)(a,{variant:`h6`,gutterBottom:!0,children:`フロー選択`}),(0,U.jsx)(m,{children:n.map(e=>(0,U.jsx)(t,{selected:r===e.id,onClick:()=>i(e.id),children:(0,U.jsx)(F,{primary:e.name,secondary:e.joint?`[${e.joint.type===`direct`?`直結`:`分岐`}]`:``})},e.id))})]}),(0,U.jsx)(p,{sx:{flex:`1 1 auto`,p:3,overflow:`auto`},children:g?(0,U.jsxs)(U.Fragment,{children:[(0,U.jsxs)(a,{variant:`h6`,gutterBottom:!0,children:[`「`,g.name,`」のジョイント設定`]}),(0,U.jsx)(a,{variant:`body2`,color:`text.secondary`,sx:{mb:2},children:`このフローが完了した後の、次のアクションを定義します。`}),(0,U.jsx)(h,{sx:{my:2}}),(()=>o?(0,U.jsxs)(z,{children:[(0,U.jsx)(v,{component:`fieldset`,sx:{mb:2},children:(0,U.jsxs)(T,{row:!0,value:c.type,onChange:e=>f({...xf,type:e.target.value}),children:[(0,U.jsx)(S,{value:`direct`,control:(0,U.jsx)(C,{}),label:`直結型`}),(0,U.jsx)(S,{value:`branching`,control:(0,U.jsx)(C,{}),label:`分岐型`})]})}),c.type===`direct`&&(0,U.jsxs)(v,{fullWidth:!0,children:[(0,U.jsx)(d,{id:`next-flow-select-label`,children:`次に開始するフロー`}),(0,U.jsx)(_,{labelId:`next-flow-select-label`,value:c.nextFlowId,label:`次に開始するフロー`,onChange:e=>f(t=>({...t,nextFlowId:e.target.value})),children:k.map(e=>(0,U.jsx)(w,{value:e.id,children:e.name},e.id))})]}),c.type===`branching`&&(0,U.jsxs)(z,{sx:{display:`flex`,flexDirection:`column`,gap:2},children:[(0,U.jsx)(y,{label:`担当者への問いかけ (Prompt)`,fullWidth:!0,value:c.prompt,onChange:e=>f(t=>({...t,prompt:e.target.value}))}),(0,U.jsx)(a,{variant:`subtitle2`,children:`分岐先のリスト`}),c.branches.map((e,t)=>(0,U.jsxs)(p,{variant:`outlined`,sx:{p:2,display:`flex`,alignItems:`center`,gap:2},children:[(0,U.jsx)(y,{label:`分岐名 ${t+1}`,value:e.label,onChange:t=>O(e.id,`label`,t.target.value),sx:{flexGrow:1}}),(0,U.jsxs)(v,{sx:{minWidth:200},children:[(0,U.jsx)(d,{id:`branch-flow-select-label-${e.id}`,children:`接続先フロー`}),(0,U.jsx)(_,{labelId:`branch-flow-select-label-${e.id}`,value:e.nextFlowId,label:`接続先フロー`,onChange:t=>O(e.id,`nextFlowId`,t.target.value),children:k.map(e=>(0,U.jsx)(w,{value:e.id,children:e.name},e.id))})]}),(0,U.jsx)(l,{onClick:()=>D(e.id),disabled:c.branches.length<=1,children:(0,U.jsx)(bf,{})})]},e.id)),(0,U.jsx)(u,{startIcon:(0,U.jsx)(yf,{}),onClick:E,children:`分岐先を追加`})]}),(0,U.jsxs)(z,{sx:{mt:3,display:`flex`,justifyContent:`space-between`},children:[(0,U.jsx)(u,{color:`error`,onClick:x,children:`このジョイントを削除`}),(0,U.jsx)(u,{variant:`contained`,onClick:b,children:`保存`})]})]}):(0,U.jsx)(z,{sx:{textAlign:`center`},children:(0,U.jsx)(u,{variant:`contained`,onClick:()=>s(!0),children:`ジョイントを設定する`})}))()]}):(0,U.jsx)(z,{sx:{display:`flex`,alignItems:`center`,justifyContent:`center`,height:`100%`},children:(0,U.jsx)(a,{color:`text.secondary`,children:`左のリストからフローを選択してください。`})})})]})}var Cf=Sf;function wf(){let e=se(),{categories:t,selectedCategoryId:n}=Ne(e=>e.flowCategory),[r,i]=(0,H.useState)({open:!1,mode:`add`,category:null}),[o,s]=(0,H.useState)(``),[{isOver:c,canDrop:l},d]=Qr(()=>({accept:`flow`,drop:(e,t)=>{t.didDrop()},collect:e=>({isOver:e.isOver(),canDrop:e.canDrop()})}),[]),f=(e,t=null)=>{i({open:!0,mode:e,category:t}),s(t?t.name:``)},h=()=>{i({open:!1,mode:`add`,category:null}),s(``)},g=()=>{o.trim()&&(r.mode===`add`?e(Fe({name:o})):e(Oe({id:r.category.id,name:o})),h())},_=t=>{t!==`cat-uncategorized`&&window.confirm(`このカテゴリを削除しますか？関連するフローは「未分類」に移動します。`)&&e(Ae(t))};return(0,U.jsxs)(p,{ref:d,sx:{p:2,height:`100%`,display:`flex`,flexDirection:`column`},children:[(0,U.jsxs)(z,{sx:{display:`flex`,justifyContent:`space-between`,alignItems:`center`,mb:1},children:[(0,U.jsx)(a,{variant:`h6`,children:`カテゴリ管理`}),(0,U.jsx)(u,{startIcon:(0,U.jsx)(j,{}),onClick:()=>f(`add`),size:`small`,children:`追加`})]}),(0,U.jsx)(z,{sx:{overflow:`auto`,flexGrow:1},children:(0,U.jsx)(m,{dense:!0,children:t.map(t=>(0,U.jsx)(Tf,{category:t,isSelected:n===t.id,onSelect:()=>e(Pe(t.id)),onEdit:()=>f(`edit`,t),onDelete:()=>_(t.id)},t.id))})}),(0,U.jsxs)(M,{open:r.open,onClose:h,children:[(0,U.jsx)(O,{children:r.mode===`add`?`カテゴリ追加`:`カテゴリ名変更`}),(0,U.jsx)(D,{children:(0,U.jsx)(y,{autoFocus:!0,margin:`dense`,label:`カテゴリ名`,type:`text`,fullWidth:!0,variant:`standard`,value:o,onChange:e=>s(e.target.value)})}),(0,U.jsxs)(A,{children:[(0,U.jsx)(u,{onClick:h,children:`キャンセル`}),(0,U.jsx)(u,{onClick:g,children:`保存`})]})]})]})}function Tf({category:e,isSelected:n,onSelect:r,onEdit:i,onDelete:a}){let o=se(),[{isOver:s,canDrop:c},u]=Qr(()=>({accept:`flow`,drop:t=>{o(te({flowId:t.id,newCategoryId:e.id}))},collect:e=>({isOver:e.isOver(),canDrop:e.canDrop()})}),[e.id]);return(0,U.jsx)(P,{disablePadding:!0,sx:{mb:.5},children:(0,U.jsxs)(t,{ref:u,selected:n,onClick:r,sx:{borderRadius:1,border:c?s?`2px dashed #1976d2`:`2px dashed #ccc`:`none`,backgroundColor:s&&c?`action.hover`:void 0,display:`flex`,justifyContent:`space-between`},children:[(0,U.jsx)(F,{primary:e.name}),e.id!==`cat-uncategorized`&&(0,U.jsxs)(z,{children:[(0,U.jsx)(l,{size:`small`,onClick:e=>{e.stopPropagation(),i()},children:(0,U.jsx)(N,{fontSize:`small`})}),(0,U.jsx)(l,{size:`small`,onClick:e=>{e.stopPropagation(),a()},children:(0,U.jsx)(k,{fontSize:`small`})})]})]})})}var Ef=wf,Df=x((0,U.jsx)(`path`,{d:`M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2m-5 14H7v-2h7zm3-4H7v-2h10zm0-4H7V7h10z`}),`Article`);function Of({flow:e}){let[{isDragging:t},n]=Wr(()=>({type:`flow`,item:{id:e.id},collect:e=>({isDragging:!!e.isDragging()})}));return(0,U.jsxs)(P,{ref:n,sx:{cursor:`move`,opacity:t?.5:1,border:`1px solid #ddd`,borderRadius:1,mb:1,bgcolor:`background.paper`},children:[(0,U.jsx)(Df,{sx:{mr:1.5},color:`action`}),(0,U.jsx)(F,{primary:e.name,secondary:e.description})]})}function kf({onStartAiDesign:e}){let{flowLibrary:t}=Ne(e=>e.case),{categories:n,selectedCategoryId:r}=Ne(e=>e.flowCategory),o=t.filter(e=>e.categoryId===r),s=n.find(e=>e.id===r);return s?(0,U.jsxs)(p,{sx:{p:2,height:`100%`,display:`flex`,flexDirection:`column`},children:[(0,U.jsxs)(z,{sx:{display:`flex`,justifyContent:`space-between`,alignItems:`center`,mb:1},children:[(0,U.jsxs)(a,{variant:`h6`,children:[`フローリスト: `,s.name]}),(0,U.jsx)(u,{variant:`outlined`,size:`small`,startIcon:(0,U.jsx)(i,{}),onClick:e,children:`AIで新しいフローを設計`})]}),(0,U.jsx)(z,{sx:{overflow:`auto`,flexGrow:1,p:1,bgcolor:`action.hover`,borderRadius:1},children:o.length>0?(0,U.jsx)(m,{children:o.map(e=>(0,U.jsx)(Of,{flow:e},e.id))}):(0,U.jsx)(z,{sx:{display:`flex`,alignItems:`center`,justifyContent:`center`,height:`100%`},children:(0,U.jsx)(a,{color:`text.secondary`,children:`このカテゴリにはフローがありません。`})})})]}):(0,U.jsx)(p,{sx:{p:2,height:`100%`,display:`flex`,alignItems:`center`,justifyContent:`center`},children:(0,U.jsx)(a,{color:`text.secondary`,children:`カテゴリを選択してください。`})})}var Af=kf;function jf({onStartAiDesign:e}){return(0,U.jsxs)(z,{sx:{height:`100%`,display:`flex`,flexDirection:`column`,gap:2},children:[(0,U.jsx)(z,{sx:{flex:`0 1 40%`,minHeight:200},children:(0,U.jsx)(Ef,{})}),(0,U.jsx)(z,{sx:{flex:`1 1 60%`},children:(0,U.jsx)(Af,{onStartAiDesign:e})})]})}var Mf=jf,Nf=x((0,U.jsx)(`path`,{d:`M20 9V7c0-1.1-.9-2-2-2h-3c0-1.66-1.34-3-3-3S9 3.34 9 5H6c-1.1 0-2 .9-2 2v2c-1.66 0-3 1.34-3 3s1.34 3 3 3v4c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2v-4c1.66 0 3-1.34 3-3s-1.34-3-3-3M7.5 11.5c0-.83.67-1.5 1.5-1.5s1.5.67 1.5 1.5S9.83 13 9 13s-1.5-.67-1.5-1.5M16 17H8v-2h8zm-1-4c-.83 0-1.5-.67-1.5-1.5S14.17 10 15 10s1.5.67 1.5 1.5S15.83 13 15 13`}),`SmartToy`),Pf=x([(0,U.jsx)(`path`,{d:`M12 5.99 19.53 19H4.47zM12 2 1 21h22z`},`0`),(0,U.jsx)(`path`,{d:`M13 16h-2v2h2zm0-6h-2v5h2z`},`1`)],`WarningAmber`),Ff=je(p)(({theme:e})=>({display:`flex`,flexDirection:`column`,height:`100%`,padding:e.spacing(2)})),If=je(z)({flexGrow:1,overflowY:`auto`,padding:`8px`}),Lf=je(z)(({theme:e,sender:t})=>({display:`flex`,flexDirection:`row`,alignItems:`flex-start`,marginBottom:e.spacing(2),justifyContent:t===`user`?`flex-end`:`flex-start`})),Rf=je(p)(({theme:e,sender:t})=>({padding:e.spacing(1,2),borderRadius:`20px`,maxWidth:`85%`,backgroundColor:t===`user`?e.palette.primary.main:e.palette.background.paper,color:t===`user`?e.palette.primary.contrastText:e.palette.text.primary,border:t===`ai`?`1px solid ${e.palette.divider}`:`none`}));function zf({chatHistory:t,onSendMessage:n,onOptionSelect:i,isWaitingForUserInput:o,isWaitingForAiResponse:s}){let[l,d]=H.useState(``),f=(0,H.useRef)(null);(0,H.useEffect)(()=>{f.current?.scrollIntoView({behavior:`smooth`})},[t,s]);let p=()=>{l.trim()&&(n(l),d(``))};return(0,U.jsxs)(Ff,{children:[(0,U.jsx)(a,{variant:`h6`,gutterBottom:!0,children:`AIフロー設計`}),(0,U.jsxs)(If,{children:[t.map((t,i)=>{let s=t.text.startsWith(`[WARNING]`),l=s?t.text.replace(`[WARNING]`,``).trim():t.text;return(0,U.jsxs)(Lf,{sender:t.sender,children:[(0,U.jsx)(Ze,{sx:{mr:1,bgcolor:t.sender===`ai`?`secondary.main`:`primary.main`},children:t.sender===`ai`?(0,U.jsx)(Nf,{}):(0,U.jsx)(g,{})}),(0,U.jsxs)(z,{children:[s?(0,U.jsxs)(e,{severity:`warning`,icon:(0,U.jsx)(Pf,{fontSize:`inherit`}),sx:{borderRadius:`20px`,maxWidth:`85%`,bgcolor:`#fff4e5`},children:[(0,U.jsx)(Ue,{sx:{fontWeight:`bold`},children:`フェーズ逸脱警告`}),l]}):(0,U.jsx)(Rf,{sender:t.sender,children:(0,U.jsx)(a,{variant:`body2`,sx:{whiteSpace:`pre-wrap`},children:l})}),t.options&&t.options.length>0&&(0,U.jsx)(r,{direction:`row`,spacing:1,sx:{mt:1,flexWrap:`wrap`,justifyContent:`flex-start`,ml:1},children:t.options.filter(e=>e&&e.label&&e.label.trim()!==``).map(e=>(0,U.jsx)(c,{label:e.label,onClick:()=>n(e.label),color:`info`,clickable:o,disabled:!o,variant:`outlined`},e.value||e.label))})]})]},i)}),s&&(0,U.jsxs)(Lf,{sender:`ai`,children:[(0,U.jsx)(Ze,{sx:{mr:1,bgcolor:`secondary.main`},children:(0,U.jsx)(Nf,{})}),(0,U.jsx)(z,{children:(0,U.jsx)(Rf,{sender:`ai`,children:(0,U.jsx)(he,{size:20})})})]}),(0,U.jsx)(`div`,{ref:f})]}),(0,U.jsxs)(z,{sx:{display:`flex`,pt:2},children:[(0,U.jsx)(y,{fullWidth:!0,variant:`outlined`,placeholder:`メッセージを入力...`,value:l,onChange:e=>d(e.target.value),onKeyPress:e=>{e.key===`Enter`&&!e.shiftKey&&(e.preventDefault(),p())},disabled:!o}),(0,U.jsx)(u,{variant:`contained`,onClick:p,sx:{ml:1},disabled:!o,children:`送信`})]})]})}var Bf=zf;function Vf(e){if(typeof e==`string`||typeof e==`number`)return``+e;let t=``;if(Array.isArray(e))for(let n=0,r;n<e.length;n++)(r=Vf(e[n]))!==``&&(t+=(t&&` `)+r);else for(let n in e)e[n]&&(t+=(t&&` `)+n);return t}var Hf=ce((exports=>{var t=oe();function n(e,t){return e===t&&(e!==0||1/e==1/t)||e!==e&&t!==t}var r=typeof Object.is==`function`?Object.is:n,i=t.useState,a=t.useEffect,o=t.useLayoutEffect,s=t.useDebugValue;function c(e,t){var n=t(),r=i({inst:{value:n,getSnapshot:t}}),c=r[0].inst,u=r[1];return o(function(){c.value=n,c.getSnapshot=t,l(c)&&u({inst:c})},[e,n,t]),a(function(){return l(c)&&u({inst:c}),e(function(){l(c)&&u({inst:c})})},[e]),s(n),n}function l(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!r(e,n)}catch{return!0}}function u(e,t){return t()}var d=typeof window>`u`||window.document===void 0||window.document.createElement===void 0?u:c;exports.useSyncExternalStore=t.useSyncExternalStore===void 0?d:t.useSyncExternalStore})),Uf=ce(((exports,t)=>{t.exports=Hf()})),Wf=ce((exports=>{var t=oe(),n=Uf();function r(e,t){return e===t&&(e!==0||1/e==1/t)||e!==e&&t!==t}var i=typeof Object.is==`function`?Object.is:r,a=n.useSyncExternalStore,o=t.useRef,s=t.useEffect,c=t.useMemo,l=t.useDebugValue;exports.useSyncExternalStoreWithSelector=function(e,t,n,r,u){var d=o(null);if(d.current===null){var f={hasValue:!1,value:null};d.current=f}else f=d.current;d=c(function(){function e(e){if(!a){if(a=!0,o=e,e=r(e),u!==void 0&&f.hasValue){var t=f.value;if(u(t,e))return s=t}return s=e}if(t=s,i(o,e))return t;var n=r(e);return u!==void 0&&u(t,n)?(o=e,t):(o=e,s=n)}var a=!1,o,s,c=n===void 0?null:n;return[function(){return e(t())},c===null?void 0:function(){return e(c())}]},[t,n,r,u]);var p=a(e,d[0],d[1]);return s(function(){f.hasValue=!0,f.value=p},[p]),l(p),p}})),Gf=ce(((exports,t)=>{t.exports=Wf()})),Kf=e=>{let t,n=new Set,r=(e,r)=>{let i=typeof e==`function`?e(t):e;if(!Object.is(i,t)){let e=t;t=r??(typeof i!=`object`||!i)?i:Object.assign({},t,i),n.forEach(n=>n(t,e))}},i=()=>t,a={setState:r,getState:i,getInitialState:()=>o,subscribe:e=>(n.add(e),()=>n.delete(e)),destroy:()=>{n.clear()}},o=t=e(r,i,a);return a},qf=e=>e?Kf(e):Kf,Jf=L(Gf(),1),{useDebugValue:Yf}=H.default,{useSyncExternalStoreWithSelector:Xf}=Jf.default,Zf=e=>e;function Qf(e,t=Zf,n){let r=Xf(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,n);return Yf(r),r}var $f=(e,t)=>{let n=qf(e),r=(e,r=t)=>Qf(n,e,r);return Object.assign(r,n),r},ep=(e,t)=>e?$f(e,t):$f;function tp(e,t){if(Object.is(e,t))return!0;if(typeof e!=`object`||!e||typeof t!=`object`||!t)return!1;if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(let[n,r]of e)if(!Object.is(r,t.get(n)))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(let n of e)if(!t.has(n))return!1;return!0}let n=Object.keys(e);if(n.length!==Object.keys(t).length)return!1;for(let r of n)if(!Object.prototype.hasOwnProperty.call(t,r)||!Object.is(e[r],t[r]))return!1;return!0}var np={value:()=>{}};function rp(){for(var e=0,t=arguments.length,n={},r;e<t;++e){if(!(r=arguments[e]+``)||r in n||/[\s.]/.test(r))throw Error(`illegal type: `+r);n[r]=[]}return new ip(n)}function ip(e){this._=e}function ap(e,t){return e.trim().split(/^|\s+/).map(function(e){var n=``,r=e.indexOf(`.`);if(r>=0&&(n=e.slice(r+1),e=e.slice(0,r)),e&&!t.hasOwnProperty(e))throw Error(`unknown type: `+e);return{type:e,name:n}})}ip.prototype=rp.prototype={constructor:ip,on:function(e,t){var n=this._,r=ap(e+``,n),i,a=-1,o=r.length;if(arguments.length<2){for(;++a<o;)if((i=(e=r[a]).type)&&(i=op(n[i],e.name)))return i;return}if(t!=null&&typeof t!=`function`)throw Error(`invalid callback: `+t);for(;++a<o;)if(i=(e=r[a]).type)n[i]=sp(n[i],e.name,t);else if(t==null)for(i in n)n[i]=sp(n[i],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new ip(e)},call:function(e,t){if((i=arguments.length-2)>0)for(var n=Array(i),r=0,i,a;r<i;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(e))throw Error(`unknown type: `+e);for(a=this._[e],r=0,i=a.length;r<i;++r)a[r].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw Error(`unknown type: `+e);for(var r=this._[e],i=0,a=r.length;i<a;++i)r[i].value.apply(t,n)}};function op(e,t){for(var n=0,r=e.length,i;n<r;++n)if((i=e[n]).name===t)return i.value}function sp(e,t,n){for(var r=0,i=e.length;r<i;++r)if(e[r].name===t){e[r]=np,e=e.slice(0,r).concat(e.slice(r+1));break}return n!=null&&e.push({name:t,value:n}),e}var cp=rp,lp={svg:`http://www.w3.org/2000/svg`,xhtml:`http://www.w3.org/1999/xhtml`,xlink:`http://www.w3.org/1999/xlink`,xml:`http://www.w3.org/XML/1998/namespace`,xmlns:`http://www.w3.org/2000/xmlns/`};function up(e){var t=e+=``,n=t.indexOf(`:`);return n>=0&&(t=e.slice(0,n))!==`xmlns`&&(e=e.slice(n+1)),lp.hasOwnProperty(t)?{space:lp[t],local:e}:e}function dp(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===`http://www.w3.org/1999/xhtml`&&t.documentElement.namespaceURI===`http://www.w3.org/1999/xhtml`?t.createElement(e):t.createElementNS(n,e)}}function fp(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function pp(e){var t=up(e);return(t.local?fp:dp)(t)}function mp(){}function hp(e){return e==null?mp:function(){return this.querySelector(e)}}function gp(e){typeof e!=`function`&&(e=hp(e));for(var t=this._groups,n=t.length,r=Array(n),i=0;i<n;++i)for(var a=t[i],o=a.length,s=r[i]=Array(o),c,l,u=0;u<o;++u)(c=a[u])&&(l=e.call(c,c.__data__,u,a))&&(`__data__`in c&&(l.__data__=c.__data__),s[u]=l);return new ih(r,this._parents)}function _p(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function vp(){return[]}function yp(e){return e==null?vp:function(){return this.querySelectorAll(e)}}function bp(e){return function(){return _p(e.apply(this,arguments))}}function xp(e){e=typeof e==`function`?bp(e):yp(e);for(var t=this._groups,n=t.length,r=[],i=[],a=0;a<n;++a)for(var o=t[a],s=o.length,c,l=0;l<s;++l)(c=o[l])&&(r.push(e.call(c,c.__data__,l,o)),i.push(c));return new ih(r,i)}function Sp(e){return function(){return this.matches(e)}}function Cp(e){return function(t){return t.matches(e)}}var wp=Array.prototype.find;function Tp(e){return function(){return wp.call(this.children,e)}}function Ep(){return this.firstElementChild}function Dp(e){return this.select(e==null?Ep:Tp(typeof e==`function`?e:Cp(e)))}var Op=Array.prototype.filter;function kp(){return Array.from(this.children)}function Ap(e){return function(){return Op.call(this.children,e)}}function jp(e){return this.selectAll(e==null?kp:Ap(typeof e==`function`?e:Cp(e)))}function Mp(e){typeof e!=`function`&&(e=Sp(e));for(var t=this._groups,n=t.length,r=Array(n),i=0;i<n;++i)for(var a=t[i],o=a.length,s=r[i]=[],c,l=0;l<o;++l)(c=a[l])&&e.call(c,c.__data__,l,a)&&s.push(c);return new ih(r,this._parents)}function Np(e){return Array(e.length)}function Pp(){return new ih(this._enter||this._groups.map(Np),this._parents)}function Fp(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}Fp.prototype={constructor:Fp,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function Ip(e){return function(){return e}}function Lp(e,t,n,r,i,a){for(var o=0,s,c=t.length,l=a.length;o<l;++o)(s=t[o])?(s.__data__=a[o],r[o]=s):n[o]=new Fp(e,a[o]);for(;o<c;++o)(s=t[o])&&(i[o]=s)}function Rp(e,t,n,r,i,a,o){var s,c,l=new Map,u=t.length,d=a.length,f=Array(u),p;for(s=0;s<u;++s)(c=t[s])&&(f[s]=p=o.call(c,c.__data__,s,t)+``,l.has(p)?i[s]=c:l.set(p,c));for(s=0;s<d;++s)p=o.call(e,a[s],s,a)+``,(c=l.get(p))?(r[s]=c,c.__data__=a[s],l.delete(p)):n[s]=new Fp(e,a[s]);for(s=0;s<u;++s)(c=t[s])&&l.get(f[s])===c&&(i[s]=c)}function zp(e){return e.__data__}function Bp(e,t){if(!arguments.length)return Array.from(this,zp);var n=t?Rp:Lp,r=this._parents,i=this._groups;typeof e!=`function`&&(e=Ip(e));for(var a=i.length,o=Array(a),s=Array(a),c=Array(a),l=0;l<a;++l){var u=r[l],d=i[l],f=d.length,p=Vp(e.call(u,u&&u.__data__,l,r)),m=p.length,h=s[l]=Array(m),g=o[l]=Array(m),_=c[l]=Array(f);n(u,d,h,g,_,p,t);for(var v=0,y=0,b,x;v<m;++v)if(b=h[v]){for(v>=y&&(y=v+1);!(x=g[y])&&++y<m;);b._next=x||null}}return o=new ih(o,r),o._enter=s,o._exit=c,o}function Vp(e){return typeof e==`object`&&`length`in e?e:Array.from(e)}function Hp(){return new ih(this._exit||this._groups.map(Np),this._parents)}function Up(e,t,n){var r=this.enter(),i=this,a=this.exit();return typeof e==`function`?(r=e(r),r&&=r.selection()):r=r.append(e+``),t!=null&&(i=t(i),i&&=i.selection()),n==null?a.remove():n(a),r&&i?r.merge(i).order():i}function Wp(e){for(var t=e.selection?e.selection():e,n=this._groups,r=t._groups,i=n.length,a=r.length,o=Math.min(i,a),s=Array(i),c=0;c<o;++c)for(var l=n[c],u=r[c],d=l.length,f=s[c]=Array(d),p,m=0;m<d;++m)(p=l[m]||u[m])&&(f[m]=p);for(;c<i;++c)s[c]=n[c];return new ih(s,this._parents)}function Gp(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var r=e[t],i=r.length-1,a=r[i],o;--i>=0;)(o=r[i])&&(a&&o.compareDocumentPosition(a)^4&&a.parentNode.insertBefore(o,a),a=o);return this}function Kp(e){e||=qp;function t(t,n){return t&&n?e(t.__data__,n.__data__):!t-!n}for(var n=this._groups,r=n.length,i=Array(r),a=0;a<r;++a){for(var o=n[a],s=o.length,c=i[a]=Array(s),l,u=0;u<s;++u)(l=o[u])&&(c[u]=l);c.sort(t)}return new ih(i,this._parents).order()}function qp(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function Jp(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function Yp(){return Array.from(this)}function Xp(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],i=0,a=r.length;i<a;++i){var o=r[i];if(o)return o}return null}function Zp(){let e=0;for(let t of this)++e;return e}function Qp(){return!this.node()}function $p(e){for(var t=this._groups,n=0,r=t.length;n<r;++n)for(var i=t[n],a=0,o=i.length,s;a<o;++a)(s=i[a])&&e.call(s,s.__data__,a,i);return this}function em(e){return function(){this.removeAttribute(e)}}function tm(e){return function(){this.removeAttributeNS(e.space,e.local)}}function nm(e,t){return function(){this.setAttribute(e,t)}}function rm(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function im(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttribute(e):this.setAttribute(e,n)}}function am(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function om(e,t){var n=up(e);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((t==null?n.local?tm:em:typeof t==`function`?n.local?am:im:n.local?rm:nm)(n,t))}function sm(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function cm(e){return function(){this.style.removeProperty(e)}}function lm(e,t,n){return function(){this.style.setProperty(e,t,n)}}function um(e,t,n){return function(){var r=t.apply(this,arguments);r==null?this.style.removeProperty(e):this.style.setProperty(e,r,n)}}function dm(e,t,n){return arguments.length>1?this.each((t==null?cm:typeof t==`function`?um:lm)(e,t,n??``)):fm(this.node(),e)}function fm(e,t){return e.style.getPropertyValue(t)||sm(e).getComputedStyle(e,null).getPropertyValue(t)}function pm(e){return function(){delete this[e]}}function mm(e,t){return function(){this[e]=t}}function hm(e,t){return function(){var n=t.apply(this,arguments);n==null?delete this[e]:this[e]=n}}function gm(e,t){return arguments.length>1?this.each((t==null?pm:typeof t==`function`?hm:mm)(e,t)):this.node()[e]}function _m(e){return e.trim().split(/^|\s+/)}function vm(e){return e.classList||new ym(e)}function ym(e){this._node=e,this._names=_m(e.getAttribute(`class`)||``)}ym.prototype={add:function(e){this._names.indexOf(e)<0&&(this._names.push(e),this._node.setAttribute(`class`,this._names.join(` `)))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute(`class`,this._names.join(` `)))},contains:function(e){return this._names.indexOf(e)>=0}};function bm(e,t){for(var n=vm(e),r=-1,i=t.length;++r<i;)n.add(t[r])}function xm(e,t){for(var n=vm(e),r=-1,i=t.length;++r<i;)n.remove(t[r])}function Sm(e){return function(){bm(this,e)}}function Cm(e){return function(){xm(this,e)}}function wm(e,t){return function(){(t.apply(this,arguments)?bm:xm)(this,e)}}function Tm(e,t){var n=_m(e+``);if(arguments.length<2){for(var r=vm(this.node()),i=-1,a=n.length;++i<a;)if(!r.contains(n[i]))return!1;return!0}return this.each((typeof t==`function`?wm:t?Sm:Cm)(n,t))}function Em(){this.textContent=``}function Dm(e){return function(){this.textContent=e}}function Om(e){return function(){this.textContent=e.apply(this,arguments)??``}}function km(e){return arguments.length?this.each(e==null?Em:(typeof e==`function`?Om:Dm)(e)):this.node().textContent}function Am(){this.innerHTML=``}function jm(e){return function(){this.innerHTML=e}}function Mm(e){return function(){this.innerHTML=e.apply(this,arguments)??``}}function Nm(e){return arguments.length?this.each(e==null?Am:(typeof e==`function`?Mm:jm)(e)):this.node().innerHTML}function Pm(){this.nextSibling&&this.parentNode.appendChild(this)}function Fm(){return this.each(Pm)}function Im(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Lm(){return this.each(Im)}function Rm(e){var t=typeof e==`function`?e:pp(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function zm(){return null}function Bm(e,t){var n=typeof e==`function`?e:pp(e),r=t==null?zm:typeof t==`function`?t:hp(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function Vm(){var e=this.parentNode;e&&e.removeChild(this)}function Hm(){return this.each(Vm)}function Um(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function Wm(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function Gm(e){return this.select(e?Wm:Um)}function Km(e){return arguments.length?this.property(`__data__`,e):this.node().__data__}function qm(e){return function(t){e.call(this,t,this.__data__)}}function Jm(e){return e.trim().split(/^|\s+/).map(function(e){var t=``,n=e.indexOf(`.`);return n>=0&&(t=e.slice(n+1),e=e.slice(0,n)),{type:e,name:t}})}function Ym(e){return function(){var t=this.__on;if(t){for(var n=0,r=-1,i=t.length,a;n<i;++n)a=t[n],(!e.type||a.type===e.type)&&a.name===e.name?this.removeEventListener(a.type,a.listener,a.options):t[++r]=a;++r?t.length=r:delete this.__on}}}function Xm(e,t,n){return function(){var r=this.__on,i,a=qm(t);if(r){for(var o=0,s=r.length;o<s;++o)if((i=r[o]).type===e.type&&i.name===e.name){this.removeEventListener(i.type,i.listener,i.options),this.addEventListener(i.type,i.listener=a,i.options=n),i.value=t;return}}this.addEventListener(e.type,a,n),i={type:e.type,name:e.name,value:t,listener:a,options:n},r?r.push(i):this.__on=[i]}}function Zm(e,t,n){var r=Jm(e+``),i,a=r.length,o;if(arguments.length<2){var s=this.node().__on;if(s){for(var c=0,l=s.length,u;c<l;++c)for(i=0,u=s[c];i<a;++i)if((o=r[i]).type===u.type&&o.name===u.name)return u.value}return}for(s=t?Xm:Ym,i=0;i<a;++i)this.each(s(r[i],t,n));return this}function Qm(e,t,n){var r=sm(e),i=r.CustomEvent;typeof i==`function`?i=new i(t,n):(i=r.document.createEvent(`Event`),n?(i.initEvent(t,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(t,!1,!1)),e.dispatchEvent(i)}function $m(e,t){return function(){return Qm(this,e,t)}}function eh(e,t){return function(){return Qm(this,e,t.apply(this,arguments))}}function th(e,t){return this.each((typeof t==`function`?eh:$m)(e,t))}function*nh(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],i=0,a=r.length,o;i<a;++i)(o=r[i])&&(yield o)}var rh=[null];function ih(e,t){this._groups=e,this._parents=t}function ah(){return new ih([[document.documentElement]],rh)}function oh(){return this}ih.prototype=ah.prototype={constructor:ih,select:gp,selectAll:xp,selectChild:Dp,selectChildren:jp,filter:Mp,data:Bp,enter:Pp,exit:Hp,join:Up,merge:Wp,selection:oh,order:Gp,sort:Kp,call:Jp,nodes:Yp,node:Xp,size:Zp,empty:Qp,each:$p,attr:om,style:dm,property:gm,classed:Tm,text:km,html:Nm,raise:Fm,lower:Lm,append:Rm,insert:Bm,remove:Hm,clone:Gm,datum:Km,on:Zm,dispatch:th,[Symbol.iterator]:nh};var sh=ah;function ch(e){return typeof e==`string`?new ih([[document.querySelector(e)]],[document.documentElement]):new ih([[e]],rh)}function lh(e){let t;for(;t=e.sourceEvent;)e=t;return e}function uh(e,t){if(e=lh(e),t===void 0&&(t=e.currentTarget),t){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=e.clientX,r.y=e.clientY,r=r.matrixTransform(t.getScreenCTM().inverse()),[r.x,r.y]}if(t.getBoundingClientRect){var i=t.getBoundingClientRect();return[e.clientX-i.left-t.clientLeft,e.clientY-i.top-t.clientTop]}}return[e.pageX,e.pageY]}const dh={passive:!1},fh={capture:!0,passive:!1};function ph(e){e.stopImmediatePropagation()}function mh(e){e.preventDefault(),e.stopImmediatePropagation()}function hh(e){var t=e.document.documentElement,n=ch(e).on(`dragstart.drag`,mh,fh);`onselectstart`in t?n.on(`selectstart.drag`,mh,fh):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect=`none`)}function gh(e,t){var n=e.document.documentElement,r=ch(e).on(`dragstart.drag`,null);t&&(r.on(`click.drag`,mh,fh),setTimeout(function(){r.on(`click.drag`,null)},0)),`onselectstart`in n?r.on(`selectstart.drag`,null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}var _h=e=>()=>e;function vh(e,{sourceEvent:t,subject:n,target:r,identifier:i,active:a,x:o,y:s,dx:c,dy:l,dispatch:u}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},identifier:{value:i,enumerable:!0,configurable:!0},active:{value:a,enumerable:!0,configurable:!0},x:{value:o,enumerable:!0,configurable:!0},y:{value:s,enumerable:!0,configurable:!0},dx:{value:c,enumerable:!0,configurable:!0},dy:{value:l,enumerable:!0,configurable:!0},_:{value:u}})}vh.prototype.on=function(){var e=this._.on.apply(this._,arguments);return e===this._?this:e};function yh(e){return!e.ctrlKey&&!e.button}function bh(){return this.parentNode}function xh(e,t){return t??{x:e.x,y:e.y}}function Sh(){return navigator.maxTouchPoints||`ontouchstart`in this}function Ch(){var e=yh,t=bh,n=xh,r=Sh,i={},a=cp(`start`,`drag`,`end`),o=0,s,c,l,u,d=0;function f(e){e.on(`mousedown.drag`,p).filter(r).on(`touchstart.drag`,g).on(`touchmove.drag`,_,dh).on(`touchend.drag touchcancel.drag`,v).style(`touch-action`,`none`).style(`-webkit-tap-highlight-color`,`rgba(0,0,0,0)`)}function p(n,r){if(!(u||!e.call(this,n,r))){var i=y(this,t.call(this,n,r),n,r,`mouse`);i&&(ch(n.view).on(`mousemove.drag`,m,fh).on(`mouseup.drag`,h,fh),hh(n.view),ph(n),l=!1,s=n.clientX,c=n.clientY,i(`start`,n))}}function m(e){if(mh(e),!l){var t=e.clientX-s,n=e.clientY-c;l=t*t+n*n>d}i.mouse(`drag`,e)}function h(e){ch(e.view).on(`mousemove.drag mouseup.drag`,null),gh(e.view,l),mh(e),i.mouse(`end`,e)}function g(n,r){if(e.call(this,n,r)){var i=n.changedTouches,a=t.call(this,n,r),o=i.length,s,c;for(s=0;s<o;++s)(c=y(this,a,n,r,i[s].identifier,i[s]))&&(ph(n),c(`start`,n,i[s]))}}function _(e){var t=e.changedTouches,n=t.length,r,a;for(r=0;r<n;++r)(a=i[t[r].identifier])&&(mh(e),a(`drag`,e,t[r]))}function v(e){var t=e.changedTouches,n=t.length,r,a;for(u&&clearTimeout(u),u=setTimeout(function(){u=null},500),r=0;r<n;++r)(a=i[t[r].identifier])&&(ph(e),a(`end`,e,t[r]))}function y(e,t,r,s,c,l){var u=a.copy(),d=uh(l||r,t),p,m,h;if((h=n.call(e,new vh(`beforestart`,{sourceEvent:r,target:f,identifier:c,active:o,x:d[0],y:d[1],dx:0,dy:0,dispatch:u}),s))!=null)return p=h.x-d[0]||0,m=h.y-d[1]||0,function n(r,a,l){var g=d,_;switch(r){case`start`:i[c]=n,_=o++;break;case`end`:delete i[c],--o;case`drag`:d=uh(l||a,t),_=o;break}u.call(r,e,new vh(r,{sourceEvent:a,subject:h,target:f,identifier:c,active:_,x:d[0]+p,y:d[1]+m,dx:d[0]-g[0],dy:d[1]-g[1],dispatch:u}),s)}}return f.filter=function(t){return arguments.length?(e=typeof t==`function`?t:_h(!!t),f):e},f.container=function(e){return arguments.length?(t=typeof e==`function`?e:_h(e),f):t},f.subject=function(e){return arguments.length?(n=typeof e==`function`?e:_h(e),f):n},f.touchable=function(e){return arguments.length?(r=typeof e==`function`?e:_h(!!e),f):r},f.on=function(){var e=a.on.apply(a,arguments);return e===a?f:e},f.clickDistance=function(e){return arguments.length?(d=(e=+e)*e,f):Math.sqrt(d)},f}function wh(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function Th(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function Eh(){}var Dh=.7,Oh=1/Dh,kh=`\\s*([+-]?\\d+)\\s*`,Ah=`\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*`,jh=`\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*`,Mh=/^#([0-9a-f]{3,8})$/,Nh=RegExp(`^rgb\\(${kh},${kh},${kh}\\)$`),Ph=RegExp(`^rgb\\(${jh},${jh},${jh}\\)$`),Fh=RegExp(`^rgba\\(${kh},${kh},${kh},${Ah}\\)$`),Ih=RegExp(`^rgba\\(${jh},${jh},${jh},${Ah}\\)$`),Lh=RegExp(`^hsl\\(${Ah},${jh},${jh}\\)$`),Rh=RegExp(`^hsla\\(${Ah},${jh},${jh},${Ah}\\)$`),zh={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};wh(Eh,Wh,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:Bh,formatHex:Bh,formatHex8:Vh,formatHsl:Hh,formatRgb:Uh,toString:Uh});function Bh(){return this.rgb().formatHex()}function Vh(){return this.rgb().formatHex8()}function Hh(){return rg(this).formatHsl()}function Uh(){return this.rgb().formatRgb()}function Wh(e){var t,n;return e=(e+``).trim().toLowerCase(),(t=Mh.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?Gh(t):n===3?new Yh(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?Kh(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?Kh(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=Nh.exec(e))?new Yh(t[1],t[2],t[3],1):(t=Ph.exec(e))?new Yh(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=Fh.exec(e))?Kh(t[1],t[2],t[3],t[4]):(t=Ih.exec(e))?Kh(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=Lh.exec(e))?ng(t[1],t[2]/100,t[3]/100,1):(t=Rh.exec(e))?ng(t[1],t[2]/100,t[3]/100,t[4]):zh.hasOwnProperty(e)?Gh(zh[e]):e===`transparent`?new Yh(NaN,NaN,NaN,0):null}function Gh(e){return new Yh(e>>16&255,e>>8&255,e&255,1)}function Kh(e,t,n,r){return r<=0&&(e=t=n=NaN),new Yh(e,t,n,r)}function qh(e){return e instanceof Eh||(e=Wh(e)),e?(e=e.rgb(),new Yh(e.r,e.g,e.b,e.opacity)):new Yh}function Jh(e,t,n,r){return arguments.length===1?qh(e):new Yh(e,t,n,r??1)}function Yh(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}wh(Yh,Jh,Th(Eh,{brighter(e){return e=e==null?Oh:Oh**+e,new Yh(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?Dh:Dh**+e,new Yh(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Yh(eg(this.r),eg(this.g),eg(this.b),$h(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Xh,formatHex:Xh,formatHex8:Zh,formatRgb:Qh,toString:Qh}));function Xh(){return`#${tg(this.r)}${tg(this.g)}${tg(this.b)}`}function Zh(){return`#${tg(this.r)}${tg(this.g)}${tg(this.b)}${tg((isNaN(this.opacity)?1:this.opacity)*255)}`}function Qh(){let e=$h(this.opacity);return`${e===1?`rgb(`:`rgba(`}${eg(this.r)}, ${eg(this.g)}, ${eg(this.b)}${e===1?`)`:`, ${e})`}`}function $h(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function eg(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function tg(e){return e=eg(e),(e<16?`0`:``)+e.toString(16)}function ng(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new ag(e,t,n,r)}function rg(e){if(e instanceof ag)return new ag(e.h,e.s,e.l,e.opacity);if(e instanceof Eh||(e=Wh(e)),!e)return new ag;if(e instanceof ag)return e;e=e.rgb();var t=e.r/255,n=e.g/255,r=e.b/255,i=Math.min(t,n,r),a=Math.max(t,n,r),o=NaN,s=a-i,c=(a+i)/2;return s?(o=t===a?(n-r)/s+(n<r)*6:n===a?(r-t)/s+2:(t-n)/s+4,s/=c<.5?a+i:2-a-i,o*=60):s=c>0&&c<1?0:o,new ag(o,s,c,e.opacity)}function ig(e,t,n,r){return arguments.length===1?rg(e):new ag(e,t,n,r??1)}function ag(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}wh(ag,ig,Th(Eh,{brighter(e){return e=e==null?Oh:Oh**+e,new ag(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?Dh:Dh**+e,new ag(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,i=2*n-r;return new Yh(cg(e>=240?e-240:e+120,i,r),cg(e,i,r),cg(e<120?e+240:e-120,i,r),this.opacity)},clamp(){return new ag(og(this.h),sg(this.s),sg(this.l),$h(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){let e=$h(this.opacity);return`${e===1?`hsl(`:`hsla(`}${og(this.h)}, ${sg(this.s)*100}%, ${sg(this.l)*100}%${e===1?`)`:`, ${e})`}`}}));function og(e){return e=(e||0)%360,e<0?e+360:e}function sg(e){return Math.max(0,Math.min(1,e||0))}function cg(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}var lg=e=>()=>e;function ug(e,t){return function(n){return e+n*t}}function dg(e,t,n){return e**=+n,t=t**+n-e,n=1/n,function(r){return(e+r*t)**+n}}function fg(e){return(e=+e)==1?pg:function(t,n){return n-t?dg(t,n,e):lg(isNaN(t)?n:t)}}function pg(e,t){var n=t-e;return n?ug(e,n):lg(isNaN(e)?t:e)}var mg=(function e(t){var n=fg(t);function r(e,t){var r=n((e=Jh(e)).r,(t=Jh(t)).r),i=n(e.g,t.g),a=n(e.b,t.b),o=pg(e.opacity,t.opacity);return function(t){return e.r=r(t),e.g=i(t),e.b=a(t),e.opacity=o(t),e+``}}return r.gamma=e,r})(1);function hg(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}var gg=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,_g=new RegExp(gg.source,`g`);function vg(e){return function(){return e}}function yg(e){return function(t){return e(t)+``}}function bg(e,t){var n=gg.lastIndex=_g.lastIndex=0,r,i,a,o=-1,s=[],c=[];for(e+=``,t+=``;(r=gg.exec(e))&&(i=_g.exec(t));)(a=i.index)>n&&(a=t.slice(n,a),s[o]?s[o]+=a:s[++o]=a),(r=r[0])===(i=i[0])?s[o]?s[o]+=i:s[++o]=i:(s[++o]=null,c.push({i:o,x:hg(r,i)})),n=_g.lastIndex;return n<t.length&&(a=t.slice(n),s[o]?s[o]+=a:s[++o]=a),s.length<2?c[0]?yg(c[0].x):vg(t):(t=c.length,function(e){for(var n=0,r;n<t;++n)s[(r=c[n]).i]=r.x(e);return s.join(``)})}var xg=180/Math.PI,Sg={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Cg(e,t,n,r,i,a){var o,s,c;return(o=Math.sqrt(e*e+t*t))&&(e/=o,t/=o),(c=e*n+t*r)&&(n-=e*c,r-=t*c),(s=Math.sqrt(n*n+r*r))&&(n/=s,r/=s,c/=s),e*r<t*n&&(e=-e,t=-t,c=-c,o=-o),{translateX:i,translateY:a,rotate:Math.atan2(t,e)*xg,skewX:Math.atan(c)*xg,scaleX:o,scaleY:s}}var wg;function Tg(e){let t=new(typeof DOMMatrix==`function`?DOMMatrix:WebKitCSSMatrix)(e+``);return t.isIdentity?Sg:Cg(t.a,t.b,t.c,t.d,t.e,t.f)}function Eg(e){return e==null||(wg||=document.createElementNS(`http://www.w3.org/2000/svg`,`g`),wg.setAttribute(`transform`,e),!(e=wg.transform.baseVal.consolidate()))?Sg:(e=e.matrix,Cg(e.a,e.b,e.c,e.d,e.e,e.f))}function Dg(e,t,n,r){function i(e){return e.length?e.pop()+` `:``}function a(e,r,i,a,o,s){if(e!==i||r!==a){var c=o.push(`translate(`,null,t,null,n);s.push({i:c-4,x:hg(e,i)},{i:c-2,x:hg(r,a)})}else (i||a)&&o.push(`translate(`+i+t+a+n)}function o(e,t,n,a){e===t?t&&n.push(i(n)+`rotate(`+t+r):(e-t>180?t+=360:t-e>180&&(e+=360),a.push({i:n.push(i(n)+`rotate(`,null,r)-2,x:hg(e,t)}))}function s(e,t,n,a){e===t?t&&n.push(i(n)+`skewX(`+t+r):a.push({i:n.push(i(n)+`skewX(`,null,r)-2,x:hg(e,t)})}function c(e,t,n,r,a,o){if(e!==n||t!==r){var s=a.push(i(a)+`scale(`,null,`,`,null,`)`);o.push({i:s-4,x:hg(e,n)},{i:s-2,x:hg(t,r)})}else (n!==1||r!==1)&&a.push(i(a)+`scale(`+n+`,`+r+`)`)}return function(t,n){var r=[],i=[];return t=e(t),n=e(n),a(t.translateX,t.translateY,n.translateX,n.translateY,r,i),o(t.rotate,n.rotate,r,i),s(t.skewX,n.skewX,r,i),c(t.scaleX,t.scaleY,n.scaleX,n.scaleY,r,i),t=n=null,function(e){for(var t=-1,n=i.length,a;++t<n;)r[(a=i[t]).i]=a.x(e);return r.join(``)}}}var Og=Dg(Tg,`px, `,`px)`,`deg)`),kg=Dg(Eg,`, `,`)`,`)`),Ag=1e-12;function jg(e){return((e=Math.exp(e))+1/e)/2}function Mg(e){return((e=Math.exp(e))-1/e)/2}function Ng(e){return((e=Math.exp(2*e))-1)/(e+1)}var Pg=(function e(t,n,r){function i(e,i){var a=e[0],o=e[1],s=e[2],c=i[0],l=i[1],u=i[2],d=c-a,f=l-o,p=d*d+f*f,m,h;if(p<Ag)h=Math.log(u/s)/t,m=function(e){return[a+e*d,o+e*f,s*Math.exp(t*e*h)]};else{var g=Math.sqrt(p),_=(u*u-s*s+r*p)/(2*s*n*g),v=(u*u-s*s-r*p)/(2*u*n*g),y=Math.log(Math.sqrt(_*_+1)-_);h=(Math.log(Math.sqrt(v*v+1)-v)-y)/t,m=function(e){var r=e*h,i=jg(y),c=s/(n*g)*(i*Ng(t*r+y)-Mg(y));return[a+c*d,o+c*f,s*i/jg(t*r+y)]}}return m.duration=h*1e3*t/Math.SQRT2,m}return i.rho=function(t){var n=Math.max(.001,+t),r=n*n,i=r*r;return e(n,r,i)},i})(Math.SQRT2,2,4),Fg=0,Ig=0,Lg=0,Rg=1e3,zg,Bg,Vg=0,Hg=0,Ug=0,Wg=typeof performance==`object`&&performance.now?performance:Date,Gg=typeof window==`object`&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function Kg(){return Hg||=(Gg(qg),Wg.now()+Ug)}function qg(){Hg=0}function Jg(){this._call=this._time=this._next=null}Jg.prototype=Yg.prototype={constructor:Jg,restart:function(e,t,n){if(typeof e!=`function`)throw TypeError(`callback is not a function`);n=(n==null?Kg():+n)+(t==null?0:+t),!this._next&&Bg!==this&&(Bg?Bg._next=this:zg=this,Bg=this),this._call=e,this._time=n,e_()},stop:function(){this._call&&(this._call=null,this._time=1/0,e_())}};function Yg(e,t,n){var r=new Jg;return r.restart(e,t,n),r}function Xg(){Kg(),++Fg;for(var e=zg,t;e;)(t=Hg-e._time)>=0&&e._call.call(void 0,t),e=e._next;--Fg}function Zg(){Hg=(Vg=Wg.now())+Ug,Fg=Ig=0;try{Xg()}finally{Fg=0,$g(),Hg=0}}function Qg(){var e=Wg.now(),t=e-Vg;t>Rg&&(Ug-=t,Vg=e)}function $g(){for(var e,t=zg,n,r=1/0;t;)t._call?(r>t._time&&(r=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:zg=n);Bg=e,e_(r)}function e_(e){Fg||(Ig&&=clearTimeout(Ig),e-Hg>24?(e<1/0&&(Ig=setTimeout(Zg,e-Wg.now()-Ug)),Lg&&=clearInterval(Lg)):(Lg||=(Vg=Wg.now(),setInterval(Qg,Rg)),Fg=1,Gg(Zg)))}function t_(e,t,n){var r=new Jg;return t=t==null?0:+t,r.restart(n=>{r.stop(),e(n+t)},t,n),r}var n_=cp(`start`,`end`,`cancel`,`interrupt`),r_=[];function i_(e,t,n,r,i,a){var o=e.__transition;if(!o)e.__transition={};else if(n in o)return;c_(e,n,{name:t,index:r,group:i,on:n_,tween:r_,time:a.time,delay:a.delay,duration:a.duration,ease:a.ease,timer:null,state:0})}function a_(e,t){var n=s_(e,t);if(n.state>0)throw Error(`too late; already scheduled`);return n}function o_(e,t){var n=s_(e,t);if(n.state>3)throw Error(`too late; already running`);return n}function s_(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw Error(`transition not found`);return n}function c_(e,t,n){var r=e.__transition,i;r[t]=n,n.timer=Yg(a,0,n.time);function a(e){n.state=1,n.timer.restart(o,n.delay,n.time),n.delay<=e&&o(e-n.delay)}function o(a){var l,u,d,f;if(n.state!==1)return c();for(l in r){if(f=r[l],f.name!==n.name)continue;if(f.state===3)return t_(o);f.state===4?(f.state=6,f.timer.stop(),f.on.call(`interrupt`,e,e.__data__,f.index,f.group),delete r[l]):+l<t&&(f.state=6,f.timer.stop(),f.on.call(`cancel`,e,e.__data__,f.index,f.group),delete r[l])}if(t_(function(){n.state===3&&(n.state=4,n.timer.restart(s,n.delay,n.time),s(a))}),n.state=2,n.on.call(`start`,e,e.__data__,n.index,n.group),n.state===2){for(n.state=3,i=Array(d=n.tween.length),l=0,u=-1;l<d;++l)(f=n.tween[l].value.call(e,e.__data__,n.index,n.group))&&(i[++u]=f);i.length=u+1}}function s(t){for(var r=t<n.duration?n.ease.call(null,t/n.duration):(n.timer.restart(c),n.state=5,1),a=-1,o=i.length;++a<o;)i[a].call(e,r);n.state===5&&(n.on.call(`end`,e,e.__data__,n.index,n.group),c())}function c(){for(var i in n.state=6,n.timer.stop(),delete r[t],r)return;delete e.__transition}}function l_(e,t){var n=e.__transition,r,i,a=!0,o;if(n){for(o in t=t==null?null:t+``,n){if((r=n[o]).name!==t){a=!1;continue}i=r.state>2&&r.state<5,r.state=6,r.timer.stop(),r.on.call(i?`interrupt`:`cancel`,e,e.__data__,r.index,r.group),delete n[o]}a&&delete e.__transition}}function u_(e){return this.each(function(){l_(this,e)})}function d_(e,t){var n,r;return function(){var i=o_(this,e),a=i.tween;if(a!==n){r=n=a;for(var o=0,s=r.length;o<s;++o)if(r[o].name===t){r=r.slice(),r.splice(o,1);break}}i.tween=r}}function f_(e,t,n){var r,i;if(typeof n!=`function`)throw Error();return function(){var a=o_(this,e),o=a.tween;if(o!==r){i=(r=o).slice();for(var s={name:t,value:n},c=0,l=i.length;c<l;++c)if(i[c].name===t){i[c]=s;break}c===l&&i.push(s)}a.tween=i}}function p_(e,t){var n=this._id;if(e+=``,arguments.length<2){for(var r=s_(this.node(),n).tween,i=0,a=r.length,o;i<a;++i)if((o=r[i]).name===e)return o.value;return null}return this.each((t==null?d_:f_)(n,e,t))}function m_(e,t,n){var r=e._id;return e.each(function(){var e=o_(this,r);(e.value||={})[t]=n.apply(this,arguments)}),function(e){return s_(e,r).value[t]}}function h_(e,t){var n;return(typeof t==`number`?hg:t instanceof Wh?mg:(n=Wh(t))?(t=n,mg):bg)(e,t)}function g_(e){return function(){this.removeAttribute(e)}}function __(e){return function(){this.removeAttributeNS(e.space,e.local)}}function v_(e,t,n){var r,i=n+``,a;return function(){var o=this.getAttribute(e);return o===i?null:o===r?a:a=t(r=o,n)}}function y_(e,t,n){var r,i=n+``,a;return function(){var o=this.getAttributeNS(e.space,e.local);return o===i?null:o===r?a:a=t(r=o,n)}}function b_(e,t,n){var r,i,a;return function(){var o,s=n(this),c;return s==null?void this.removeAttribute(e):(o=this.getAttribute(e),c=s+``,o===c?null:o===r&&c===i?a:(i=c,a=t(r=o,s)))}}function x_(e,t,n){var r,i,a;return function(){var o,s=n(this),c;return s==null?void this.removeAttributeNS(e.space,e.local):(o=this.getAttributeNS(e.space,e.local),c=s+``,o===c?null:o===r&&c===i?a:(i=c,a=t(r=o,s)))}}function S_(e,t){var n=up(e),r=n===`transform`?kg:h_;return this.attrTween(e,typeof t==`function`?(n.local?x_:b_)(n,r,m_(this,`attr.`+e,t)):t==null?(n.local?__:g_)(n):(n.local?y_:v_)(n,r,t))}function C_(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}function w_(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}function T_(e,t){var n,r;function i(){var i=t.apply(this,arguments);return i!==r&&(n=(r=i)&&w_(e,i)),n}return i._value=t,i}function E_(e,t){var n,r;function i(){var i=t.apply(this,arguments);return i!==r&&(n=(r=i)&&C_(e,i)),n}return i._value=t,i}function D_(e,t){var n=`attr.`+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(t==null)return this.tween(n,null);if(typeof t!=`function`)throw Error();var r=up(e);return this.tween(n,(r.local?T_:E_)(r,t))}function O_(e,t){return function(){a_(this,e).delay=+t.apply(this,arguments)}}function k_(e,t){return t=+t,function(){a_(this,e).delay=t}}function A_(e){var t=this._id;return arguments.length?this.each((typeof e==`function`?O_:k_)(t,e)):s_(this.node(),t).delay}function j_(e,t){return function(){o_(this,e).duration=+t.apply(this,arguments)}}function M_(e,t){return t=+t,function(){o_(this,e).duration=t}}function N_(e){var t=this._id;return arguments.length?this.each((typeof e==`function`?j_:M_)(t,e)):s_(this.node(),t).duration}function P_(e,t){if(typeof t!=`function`)throw Error();return function(){o_(this,e).ease=t}}function F_(e){var t=this._id;return arguments.length?this.each(P_(t,e)):s_(this.node(),t).ease}function I_(e,t){return function(){var n=t.apply(this,arguments);if(typeof n!=`function`)throw Error();o_(this,e).ease=n}}function L_(e){if(typeof e!=`function`)throw Error();return this.each(I_(this._id,e))}function R_(e){typeof e!=`function`&&(e=Sp(e));for(var t=this._groups,n=t.length,r=Array(n),i=0;i<n;++i)for(var a=t[i],o=a.length,s=r[i]=[],c,l=0;l<o;++l)(c=a[l])&&e.call(c,c.__data__,l,a)&&s.push(c);return new pv(r,this._parents,this._name,this._id)}function z_(e){if(e._id!==this._id)throw Error();for(var t=this._groups,n=e._groups,r=t.length,i=n.length,a=Math.min(r,i),o=Array(r),s=0;s<a;++s)for(var c=t[s],l=n[s],u=c.length,d=o[s]=Array(u),f,p=0;p<u;++p)(f=c[p]||l[p])&&(d[p]=f);for(;s<r;++s)o[s]=t[s];return new pv(o,this._parents,this._name,this._id)}function B_(e){return(e+``).trim().split(/^|\s+/).every(function(e){var t=e.indexOf(`.`);return t>=0&&(e=e.slice(0,t)),!e||e===`start`})}function V_(e,t,n){var r,i,a=B_(t)?a_:o_;return function(){var o=a(this,e),s=o.on;s!==r&&(i=(r=s).copy()).on(t,n),o.on=i}}function H_(e,t){var n=this._id;return arguments.length<2?s_(this.node(),n).on.on(e):this.each(V_(n,e,t))}function U_(e){return function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}}function W_(){return this.on(`end.remove`,U_(this._id))}function G_(e){var t=this._name,n=this._id;typeof e!=`function`&&(e=hp(e));for(var r=this._groups,i=r.length,a=Array(i),o=0;o<i;++o)for(var s=r[o],c=s.length,l=a[o]=Array(c),u,d,f=0;f<c;++f)(u=s[f])&&(d=e.call(u,u.__data__,f,s))&&(`__data__`in u&&(d.__data__=u.__data__),l[f]=d,i_(l[f],t,n,f,l,s_(u,n)));return new pv(a,this._parents,t,n)}function K_(e){var t=this._name,n=this._id;typeof e!=`function`&&(e=yp(e));for(var r=this._groups,i=r.length,a=[],o=[],s=0;s<i;++s)for(var c=r[s],l=c.length,u,d=0;d<l;++d)if(u=c[d]){for(var f=e.call(u,u.__data__,d,c),p,m=s_(u,n),h=0,g=f.length;h<g;++h)(p=f[h])&&i_(p,t,n,h,f,m);a.push(f),o.push(u)}return new pv(a,o,t,n)}var q_=sh.prototype.constructor;function J_(){return new q_(this._groups,this._parents)}function Y_(e,t){var n,r,i;return function(){var a=fm(this,e),o=(this.style.removeProperty(e),fm(this,e));return a===o?null:a===n&&o===r?i:i=t(n=a,r=o)}}function X_(e){return function(){this.style.removeProperty(e)}}function Z_(e,t,n){var r,i=n+``,a;return function(){var o=fm(this,e);return o===i?null:o===r?a:a=t(r=o,n)}}function Q_(e,t,n){var r,i,a;return function(){var o=fm(this,e),s=n(this),c=s+``;return s??(c=s=(this.style.removeProperty(e),fm(this,e))),o===c?null:o===r&&c===i?a:(i=c,a=t(r=o,s))}}function $_(e,t){var n,r,i,a=`style.`+t,o=`end.`+a,s;return function(){var c=o_(this,e),l=c.on,u=c.value[a]==null?s||=X_(t):void 0;(l!==n||i!==u)&&(r=(n=l).copy()).on(o,i=u),c.on=r}}function ev(e,t,n){var r=(e+=``)==`transform`?Og:h_;return t==null?this.styleTween(e,Y_(e,r)).on(`end.style.`+e,X_(e)):typeof t==`function`?this.styleTween(e,Q_(e,r,m_(this,`style.`+e,t))).each($_(this._id,e)):this.styleTween(e,Z_(e,r,t),n).on(`end.style.`+e,null)}function tv(e,t,n){return function(r){this.style.setProperty(e,t.call(this,r),n)}}function nv(e,t,n){var r,i;function a(){var a=t.apply(this,arguments);return a!==i&&(r=(i=a)&&tv(e,a,n)),r}return a._value=t,a}function rv(e,t,n){var r=`style.`+(e+=``);if(arguments.length<2)return(r=this.tween(r))&&r._value;if(t==null)return this.tween(r,null);if(typeof t!=`function`)throw Error();return this.tween(r,nv(e,t,n??``))}function iv(e){return function(){this.textContent=e}}function av(e){return function(){this.textContent=e(this)??``}}function ov(e){return this.tween(`text`,typeof e==`function`?av(m_(this,`text`,e)):iv(e==null?``:e+``))}function sv(e){return function(t){this.textContent=e.call(this,t)}}function cv(e){var t,n;function r(){var r=e.apply(this,arguments);return r!==n&&(t=(n=r)&&sv(r)),t}return r._value=e,r}function lv(e){var t=`text`;if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!=`function`)throw Error();return this.tween(t,cv(e))}function uv(){for(var e=this._name,t=this._id,n=hv(),r=this._groups,i=r.length,a=0;a<i;++a)for(var o=r[a],s=o.length,c,l=0;l<s;++l)if(c=o[l]){var u=s_(c,t);i_(c,e,n,l,o,{time:u.time+u.delay+u.duration,delay:0,duration:u.duration,ease:u.ease})}return new pv(r,this._parents,e,n)}function dv(){var e,t,n=this,r=n._id,i=n.size();return new Promise(function(a,o){var s={value:o},c={value:function(){--i===0&&a()}};n.each(function(){var n=o_(this,r),i=n.on;i!==e&&(t=(e=i).copy(),t._.cancel.push(s),t._.interrupt.push(s),t._.end.push(c)),n.on=t}),i===0&&a()})}var fv=0;function pv(e,t,n,r){this._groups=e,this._parents=t,this._name=n,this._id=r}function mv(e){return sh().transition(e)}function hv(){return++fv}var gv=sh.prototype;pv.prototype=mv.prototype={constructor:pv,select:G_,selectAll:K_,selectChild:gv.selectChild,selectChildren:gv.selectChildren,filter:R_,merge:z_,selection:J_,transition:uv,call:gv.call,nodes:gv.nodes,node:gv.node,size:gv.size,empty:gv.empty,each:gv.each,on:H_,attr:S_,attrTween:D_,style:ev,styleTween:rv,text:ov,textTween:lv,remove:W_,tween:p_,delay:A_,duration:N_,ease:F_,easeVarying:L_,end:dv,[Symbol.iterator]:gv[Symbol.iterator]};function _v(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var vv={time:null,delay:0,duration:250,ease:_v};function yv(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw Error(`transition ${t} not found`);return n}function bv(e){var t,n;e instanceof pv?(t=e._id,e=e._name):(t=hv(),(n=vv).time=Kg(),e=e==null?null:e+``);for(var r=this._groups,i=r.length,a=0;a<i;++a)for(var o=r[a],s=o.length,c,l=0;l<s;++l)(c=o[l])&&i_(c,e,t,l,o,n||yv(c,t));return new pv(r,this._parents,e,t)}sh.prototype.interrupt=u_,sh.prototype.transition=bv;var xv=e=>()=>e;function Sv(e,{sourceEvent:t,target:n,transform:r,dispatch:i}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:r,enumerable:!0,configurable:!0},_:{value:i}})}function Cv(e,t,n){this.k=e,this.x=t,this.y=n}Cv.prototype={constructor:Cv,scale:function(e){return e===1?this:new Cv(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new Cv(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return`translate(`+this.x+`,`+this.y+`) scale(`+this.k+`)`}};var wv=new Cv(1,0,0);Tv.prototype=Cv.prototype;function Tv(e){for(;!e.__zoom;)if(!(e=e.parentNode))return wv;return e.__zoom}function Ev(e){e.stopImmediatePropagation()}function Dv(e){e.preventDefault(),e.stopImmediatePropagation()}function Ov(e){return(!e.ctrlKey||e.type===`wheel`)&&!e.button}function kv(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e,e.hasAttribute(`viewBox`)?(e=e.viewBox.baseVal,[[e.x,e.y],[e.x+e.width,e.y+e.height]]):[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]):[[0,0],[e.clientWidth,e.clientHeight]]}function Av(){return this.__zoom||wv}function jv(e){return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function Mv(){return navigator.maxTouchPoints||`ontouchstart`in this}function Nv(e,t,n){var r=e.invertX(t[0][0])-n[0][0],i=e.invertX(t[1][0])-n[1][0],a=e.invertY(t[0][1])-n[0][1],o=e.invertY(t[1][1])-n[1][1];return e.translate(i>r?(r+i)/2:Math.min(0,r)||Math.max(0,i),o>a?(a+o)/2:Math.min(0,a)||Math.max(0,o))}function Pv(){var e=Ov,t=kv,n=Nv,r=jv,i=Mv,a=[0,1/0],o=[[-1/0,-1/0],[1/0,1/0]],s=250,c=Pg,l=cp(`start`,`zoom`,`end`),u,d,f,p=500,m=150,h=0,g=10;function _(e){e.property(`__zoom`,Av).on(`wheel.zoom`,w,{passive:!1}).on(`mousedown.zoom`,T).on(`dblclick.zoom`,E).filter(i).on(`touchstart.zoom`,D).on(`touchmove.zoom`,O).on(`touchend.zoom touchcancel.zoom`,k).style(`-webkit-tap-highlight-color`,`rgba(0,0,0,0)`)}_.transform=function(e,t,n,r){var i=e.selection?e.selection():e;i.property(`__zoom`,Av),e===i?i.interrupt().each(function(){S(this,arguments).event(r).start().zoom(null,typeof t==`function`?t.apply(this,arguments):t).end()}):x(e,t,n,r)},_.scaleBy=function(e,t,n,r){_.scaleTo(e,function(){var e=this.__zoom.k,n=typeof t==`function`?t.apply(this,arguments):t;return e*n},n,r)},_.scaleTo=function(e,r,i,a){_.transform(e,function(){var e=t.apply(this,arguments),a=this.__zoom,s=i==null?b(e):typeof i==`function`?i.apply(this,arguments):i,c=a.invert(s),l=typeof r==`function`?r.apply(this,arguments):r;return n(y(v(a,l),s,c),e,o)},i,a)},_.translateBy=function(e,r,i,a){_.transform(e,function(){return n(this.__zoom.translate(typeof r==`function`?r.apply(this,arguments):r,typeof i==`function`?i.apply(this,arguments):i),t.apply(this,arguments),o)},null,a)},_.translateTo=function(e,r,i,a,s){_.transform(e,function(){var e=t.apply(this,arguments),s=this.__zoom,c=a==null?b(e):typeof a==`function`?a.apply(this,arguments):a;return n(wv.translate(c[0],c[1]).scale(s.k).translate(typeof r==`function`?-r.apply(this,arguments):-r,typeof i==`function`?-i.apply(this,arguments):-i),e,o)},a,s)};function v(e,t){return t=Math.max(a[0],Math.min(a[1],t)),t===e.k?e:new Cv(t,e.x,e.y)}function y(e,t,n){var r=t[0]-n[0]*e.k,i=t[1]-n[1]*e.k;return r===e.x&&i===e.y?e:new Cv(e.k,r,i)}function b(e){return[(+e[0][0]+ +e[1][0])/2,(+e[0][1]+ +e[1][1])/2]}function x(e,n,r,i){e.on(`start.zoom`,function(){S(this,arguments).event(i).start()}).on(`interrupt.zoom end.zoom`,function(){S(this,arguments).event(i).end()}).tween(`zoom`,function(){var e=this,a=arguments,o=S(e,a).event(i),s=t.apply(e,a),l=r==null?b(s):typeof r==`function`?r.apply(e,a):r,u=Math.max(s[1][0]-s[0][0],s[1][1]-s[0][1]),d=e.__zoom,f=typeof n==`function`?n.apply(e,a):n,p=c(d.invert(l).concat(u/d.k),f.invert(l).concat(u/f.k));return function(e){if(e===1)e=f;else{var t=p(e),n=u/t[2];e=new Cv(n,l[0]-t[0]*n,l[1]-t[1]*n)}o.zoom(null,e)}})}function S(e,t,n){return!n&&e.__zooming||new C(e,t)}function C(e,n){this.that=e,this.args=n,this.active=0,this.sourceEvent=null,this.extent=t.apply(e,n),this.taps=0}C.prototype={event:function(e){return e&&(this.sourceEvent=e),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit(`start`)),this},zoom:function(e,t){return this.mouse&&e!==`mouse`&&(this.mouse[1]=t.invert(this.mouse[0])),this.touch0&&e!==`touch`&&(this.touch0[1]=t.invert(this.touch0[0])),this.touch1&&e!==`touch`&&(this.touch1[1]=t.invert(this.touch1[0])),this.that.__zoom=t,this.emit(`zoom`),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit(`end`)),this},emit:function(e){var t=ch(this.that).datum();l.call(e,this.that,new Sv(e,{sourceEvent:this.sourceEvent,target:_,type:e,transform:this.that.__zoom,dispatch:l}),t)}};function w(t,...i){if(!e.apply(this,arguments))return;var s=S(this,i).event(t),c=this.__zoom,l=Math.max(a[0],Math.min(a[1],c.k*2**r.apply(this,arguments))),u=uh(t);if(s.wheel)(s.mouse[0][0]!==u[0]||s.mouse[0][1]!==u[1])&&(s.mouse[1]=c.invert(s.mouse[0]=u)),clearTimeout(s.wheel);else if(c.k===l)return;else s.mouse=[u,c.invert(u)],l_(this),s.start();Dv(t),s.wheel=setTimeout(d,m),s.zoom(`mouse`,n(y(v(c,l),s.mouse[0],s.mouse[1]),s.extent,o));function d(){s.wheel=null,s.end()}}function T(t,...r){if(f||!e.apply(this,arguments))return;var i=t.currentTarget,a=S(this,r,!0).event(t),s=ch(t.view).on(`mousemove.zoom`,d,!0).on(`mouseup.zoom`,p,!0),c=uh(t,i),l=t.clientX,u=t.clientY;hh(t.view),Ev(t),a.mouse=[c,this.__zoom.invert(c)],l_(this),a.start();function d(e){if(Dv(e),!a.moved){var t=e.clientX-l,r=e.clientY-u;a.moved=t*t+r*r>h}a.event(e).zoom(`mouse`,n(y(a.that.__zoom,a.mouse[0]=uh(e,i),a.mouse[1]),a.extent,o))}function p(e){s.on(`mousemove.zoom mouseup.zoom`,null),gh(e.view,a.moved),Dv(e),a.event(e).end()}}function E(r,...i){if(e.apply(this,arguments)){var a=this.__zoom,c=uh(r.changedTouches?r.changedTouches[0]:r,this),l=a.invert(c),u=a.k*(r.shiftKey?.5:2),d=n(y(v(a,u),c,l),t.apply(this,i),o);Dv(r),s>0?ch(this).transition().duration(s).call(x,d,c,r):ch(this).call(_.transform,d,c,r)}}function D(t,...n){if(e.apply(this,arguments)){var r=t.touches,i=r.length,a=S(this,n,t.changedTouches.length===i).event(t),o,s,c,l;for(Ev(t),s=0;s<i;++s)c=r[s],l=uh(c,this),l=[l,this.__zoom.invert(l),c.identifier],a.touch0?!a.touch1&&a.touch0[2]!==l[2]&&(a.touch1=l,a.taps=0):(a.touch0=l,o=!0,a.taps=1+!!u);u&&=clearTimeout(u),o&&(a.taps<2&&(d=l[0],u=setTimeout(function(){u=null},p)),l_(this),a.start())}}function O(e,...t){if(this.__zooming){var r=S(this,t).event(e),i=e.changedTouches,a=i.length,s,c,l,u;for(Dv(e),s=0;s<a;++s)c=i[s],l=uh(c,this),r.touch0&&r.touch0[2]===c.identifier?r.touch0[0]=l:r.touch1&&r.touch1[2]===c.identifier&&(r.touch1[0]=l);if(c=r.that.__zoom,r.touch1){var d=r.touch0[0],f=r.touch0[1],p=r.touch1[0],m=r.touch1[1],h=(h=p[0]-d[0])*h+(h=p[1]-d[1])*h,g=(g=m[0]-f[0])*g+(g=m[1]-f[1])*g;c=v(c,Math.sqrt(h/g)),l=[(d[0]+p[0])/2,(d[1]+p[1])/2],u=[(f[0]+m[0])/2,(f[1]+m[1])/2]}else if(r.touch0)l=r.touch0[0],u=r.touch0[1];else return;r.zoom(`touch`,n(y(c,l,u),r.extent,o))}}function k(e,...t){if(this.__zooming){var n=S(this,t).event(e),r=e.changedTouches,i=r.length,a,o;for(Ev(e),f&&clearTimeout(f),f=setTimeout(function(){f=null},p),a=0;a<i;++a)o=r[a],n.touch0&&n.touch0[2]===o.identifier?delete n.touch0:n.touch1&&n.touch1[2]===o.identifier&&delete n.touch1;if(n.touch1&&!n.touch0&&(n.touch0=n.touch1,delete n.touch1),n.touch0)n.touch0[1]=this.__zoom.invert(n.touch0[0]);else if(n.end(),n.taps===2&&(o=uh(o,this),Math.hypot(d[0]-o[0],d[1]-o[1])<g)){var s=ch(this).on(`dblclick.zoom`);s&&s.apply(this,arguments)}}}return _.wheelDelta=function(e){return arguments.length?(r=typeof e==`function`?e:xv(+e),_):r},_.filter=function(t){return arguments.length?(e=typeof t==`function`?t:xv(!!t),_):e},_.touchable=function(e){return arguments.length?(i=typeof e==`function`?e:xv(!!e),_):i},_.extent=function(e){return arguments.length?(t=typeof e==`function`?e:xv([[+e[0][0],+e[0][1]],[+e[1][0],+e[1][1]]]),_):t},_.scaleExtent=function(e){return arguments.length?(a[0]=+e[0],a[1]=+e[1],_):[a[0],a[1]]},_.translateExtent=function(e){return arguments.length?(o[0][0]=+e[0][0],o[1][0]=+e[1][0],o[0][1]=+e[0][1],o[1][1]=+e[1][1],_):[[o[0][0],o[0][1]],[o[1][0],o[1][1]]]},_.constrain=function(e){return arguments.length?(n=e,_):n},_.duration=function(e){return arguments.length?(s=+e,_):s},_.interpolate=function(e){return arguments.length?(c=e,_):c},_.on=function(){var e=l.on.apply(l,arguments);return e===l?_:e},_.clickDistance=function(e){return arguments.length?(h=(e=+e)*e,_):Math.sqrt(h)},_.tapDistance=function(e){return arguments.length?(g=+e,_):g},_}ne();var Fv=(0,H.createContext)(null),Iv=Fv.Provider,Lv={error001:()=>`[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001`,error002:()=>`It looks like you've created a new nodeTypes or edgeTypes object. If this wasn't on purpose please define the nodeTypes/edgeTypes outside of the component or memoize them.`,error003:e=>`Node type "${e}" not found. Using fallback type "default".`,error004:()=>`The React Flow parent container needs a width and a height to render the graph.`,error005:()=>`Only child nodes can use a parent extent.`,error006:()=>`Can't create edge. An edge needs a source and a target.`,error007:e=>`The old edge with id=${e} does not exist.`,error009:e=>`Marker type "${e}" doesn't exist.`,error008:(e,t)=>`Couldn't create edge for ${e?`target`:`source`} handle id: "${e?t.targetHandle:t.sourceHandle}", edge id: ${t.id}.`,error010:()=>`Handle: No node id found. Make sure to only use a Handle inside a custom Node.`,error011:e=>`Edge type "${e}" not found. Using fallback type "default".`,error012:e=>`Node with id "${e}" does not exist, it may have been removed. This can happen when a node is deleted before the "onNodeClick" handler is called.`},Rv=Lv.error001();function X(e,t){let n=(0,H.useContext)(Fv);if(n===null)throw Error(Rv);return Qf(n,e,t)}var zv=()=>{let e=(0,H.useContext)(Fv);if(e===null)throw Error(Rv);return(0,H.useMemo)(()=>({getState:e.getState,setState:e.setState,subscribe:e.subscribe,destroy:e.destroy}),[e])},Bv=e=>e.userSelectionActive?`none`:`all`;function Vv({position:e,children:t,className:n,style:r,...i}){let a=X(Bv),o=`${e}`.split(`-`);return H.createElement(`div`,{className:Vf([`react-flow__panel`,n,...o]),style:{...r,pointerEvents:a},...i},t)}function Hv({proOptions:e,position:t=`bottom-right`}){return e?.hideAttribution?null:H.createElement(Vv,{position:t,className:`react-flow__attribution`,"data-message":`Please only hide this attribution when you are subscribed to React Flow Pro: https://reactflow.dev/pro`},H.createElement(`a`,{href:`https://reactflow.dev`,target:`_blank`,rel:`noopener noreferrer`,"aria-label":`React Flow attribution`},`React Flow`))}var Uv=(0,H.memo)(({x:e,y:t,label:n,labelStyle:r={},labelShowBg:i=!0,labelBgStyle:a={},labelBgPadding:o=[2,4],labelBgBorderRadius:s=2,children:c,className:l,...u})=>{let d=(0,H.useRef)(null),[f,p]=(0,H.useState)({x:0,y:0,width:0,height:0}),m=Vf([`react-flow__edge-textwrapper`,l]);return(0,H.useEffect)(()=>{if(d.current){let e=d.current.getBBox();p({x:e.x,y:e.y,width:e.width,height:e.height})}},[n]),n===void 0||!n?null:H.createElement(`g`,{transform:`translate(${e-f.width/2} ${t-f.height/2})`,className:m,visibility:f.width?`visible`:`hidden`,...u},i&&H.createElement(`rect`,{width:f.width+2*o[0],x:-o[0],y:-o[1],height:f.height+2*o[1],className:`react-flow__edge-textbg`,style:a,rx:s,ry:s}),H.createElement(`text`,{className:`react-flow__edge-text`,y:f.height/2,dy:`0.3em`,ref:d,style:r},n),c)}),Wv=e=>({width:e.offsetWidth,height:e.offsetHeight}),Gv=(e,t=0,n=1)=>Math.min(Math.max(e,t),n),Kv=(e={x:0,y:0},t)=>({x:Gv(e.x,t[0][0],t[1][0]),y:Gv(e.y,t[0][1],t[1][1])}),qv=(e,t,n)=>e<t?Gv(Math.abs(e-t),1,50)/50:e>n?-Gv(Math.abs(e-n),1,50)/50:0,Jv=(e,t)=>{let n=qv(e.x,35,t.width-35)*20,r=qv(e.y,35,t.height-35)*20;return[n,r]},Yv=e=>e.getRootNode?.()||window?.document,Xv=(e,t)=>({x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x2,t.x2),y2:Math.max(e.y2,t.y2)}),Zv=({x:e,y:t,width:n,height:r})=>({x:e,y:t,x2:e+n,y2:t+r}),Qv=({x:e,y:t,x2:n,y2:r})=>({x:e,y:t,width:n-e,height:r-t}),$v=e=>({...e.positionAbsolute||{x:0,y:0},width:e.width||0,height:e.height||0}),ey=(e,t)=>Qv(Xv(Zv(e),Zv(t))),ty=(e,t)=>{let n=Math.max(0,Math.min(e.x+e.width,t.x+t.width)-Math.max(e.x,t.x)),r=Math.max(0,Math.min(e.y+e.height,t.y+t.height)-Math.max(e.y,t.y));return Math.ceil(n*r)},ny=e=>ry(e.width)&&ry(e.height)&&ry(e.x)&&ry(e.y),ry=e=>!isNaN(e)&&isFinite(e),Z=Symbol.for(`internals`),iy=[`Enter`,` `,`Escape`],ay=(e,t)=>{},oy=e=>`nativeEvent`in e;function sy(e){let t=(oy(e)?e.nativeEvent:e).composedPath?.()?.[0]||e.target;return[`INPUT`,`SELECT`,`TEXTAREA`].includes(t?.nodeName)||t?.hasAttribute(`contenteditable`)||!!t?.closest(`.nokey`)}var cy=e=>`clientX`in e,ly=(e,t)=>{let n=cy(e),r=n?e.clientX:e.touches?.[0].clientX,i=n?e.clientY:e.touches?.[0].clientY;return{x:r-(t?.left??0),y:i-(t?.top??0)}},uy=()=>typeof navigator<`u`&&navigator?.userAgent?.indexOf(`Mac`)>=0,dy=({id:e,path:t,labelX:n,labelY:r,label:i,labelStyle:a,labelShowBg:o,labelBgStyle:s,labelBgPadding:c,labelBgBorderRadius:l,style:u,markerEnd:d,markerStart:f,interactionWidth:p=20})=>H.createElement(H.Fragment,null,H.createElement(`path`,{id:e,style:u,d:t,fill:`none`,className:`react-flow__edge-path`,markerEnd:d,markerStart:f}),p&&H.createElement(`path`,{d:t,fill:`none`,strokeOpacity:0,strokeWidth:p,className:`react-flow__edge-interaction`}),i&&ry(n)&&ry(r)?H.createElement(Uv,{x:n,y:r,label:i,labelStyle:a,labelShowBg:o,labelBgStyle:s,labelBgPadding:c,labelBgBorderRadius:l}):null);dy.displayName=`BaseEdge`;function fy(e,t,n){return n===void 0?n:r=>{let i=t().edges.find(t=>t.id===e);i&&n(r,{...i})}}function py({sourceX:e,sourceY:t,targetX:n,targetY:r}){let i=Math.abs(n-e)/2,a=n<e?n+i:n-i,o=Math.abs(r-t)/2,s=r<t?r+o:r-o;return[a,s,i,o]}function my({sourceX:e,sourceY:t,targetX:n,targetY:r,sourceControlX:i,sourceControlY:a,targetControlX:o,targetControlY:s}){let c=e*.125+i*.375+o*.375+n*.125,l=t*.125+a*.375+s*.375+r*.125,u=Math.abs(c-e),d=Math.abs(l-t);return[c,l,u,d]}var hy;(function(e){e.Strict=`strict`,e.Loose=`loose`})(hy||={});var gy;(function(e){e.Free=`free`,e.Vertical=`vertical`,e.Horizontal=`horizontal`})(gy||={});var _y;(function(e){e.Partial=`partial`,e.Full=`full`})(_y||={});var vy;(function(e){e.Bezier=`default`,e.Straight=`straight`,e.Step=`step`,e.SmoothStep=`smoothstep`,e.SimpleBezier=`simplebezier`})(vy||={});var yy;(function(e){e.Arrow=`arrow`,e.ArrowClosed=`arrowclosed`})(yy||={});var Q;(function(e){e.Left=`left`,e.Top=`top`,e.Right=`right`,e.Bottom=`bottom`})(Q||={});function by({pos:e,x1:t,y1:n,x2:r,y2:i}){return e===Q.Left||e===Q.Right?[.5*(t+r),n]:[t,.5*(n+i)]}function xy({sourceX:e,sourceY:t,sourcePosition:n=Q.Bottom,targetX:r,targetY:i,targetPosition:a=Q.Top}){let[o,s]=by({pos:n,x1:e,y1:t,x2:r,y2:i}),[c,l]=by({pos:a,x1:r,y1:i,x2:e,y2:t}),[u,d,f,p]=my({sourceX:e,sourceY:t,targetX:r,targetY:i,sourceControlX:o,sourceControlY:s,targetControlX:c,targetControlY:l});return[`M${e},${t} C${o},${s} ${c},${l} ${r},${i}`,u,d,f,p]}var Sy=(0,H.memo)(({sourceX:e,sourceY:t,targetX:n,targetY:r,sourcePosition:i=Q.Bottom,targetPosition:a=Q.Top,label:o,labelStyle:s,labelShowBg:c,labelBgStyle:l,labelBgPadding:u,labelBgBorderRadius:d,style:f,markerEnd:p,markerStart:m,interactionWidth:h})=>{let[g,_,v]=xy({sourceX:e,sourceY:t,sourcePosition:i,targetX:n,targetY:r,targetPosition:a});return H.createElement(dy,{path:g,labelX:_,labelY:v,label:o,labelStyle:s,labelShowBg:c,labelBgStyle:l,labelBgPadding:u,labelBgBorderRadius:d,style:f,markerEnd:p,markerStart:m,interactionWidth:h})});Sy.displayName=`SimpleBezierEdge`;var Cy={[Q.Left]:{x:-1,y:0},[Q.Right]:{x:1,y:0},[Q.Top]:{x:0,y:-1},[Q.Bottom]:{x:0,y:1}},wy=({source:e,sourcePosition:t=Q.Bottom,target:n})=>t===Q.Left||t===Q.Right?e.x<n.x?{x:1,y:0}:{x:-1,y:0}:e.y<n.y?{x:0,y:1}:{x:0,y:-1},Ty=(e,t)=>Math.sqrt((t.x-e.x)**2+(t.y-e.y)**2);function Ey({source:e,sourcePosition:t=Q.Bottom,target:n,targetPosition:r=Q.Top,center:i,offset:a}){let o=Cy[t],s=Cy[r],c={x:e.x+o.x*a,y:e.y+o.y*a},l={x:n.x+s.x*a,y:n.y+s.y*a},u=wy({source:c,sourcePosition:t,target:l}),d=u.x===0?`y`:`x`,f=u[d],p=[],m,h,g={x:0,y:0},_={x:0,y:0},[v,y,b,x]=py({sourceX:e.x,sourceY:e.y,targetX:n.x,targetY:n.y});if(o[d]*s[d]===-1){m=i.x??v,h=i.y??y;let e=[{x:m,y:c.y},{x:m,y:l.y}],t=[{x:c.x,y:h},{x:l.x,y:h}];p=o[d]===f?d===`x`?e:t:d===`x`?t:e}else{let i=[{x:c.x,y:l.y}],u=[{x:l.x,y:c.y}];if(p=d===`x`?o.x===f?u:i:o.y===f?i:u,t===r){let t=Math.abs(e[d]-n[d]);if(t<=a){let r=Math.min(a-1,a-t);o[d]===f?g[d]=(c[d]>e[d]?-1:1)*r:_[d]=(l[d]>n[d]?-1:1)*r}}if(t!==r){let e=d===`x`?`y`:`x`,t=o[d]===s[e],n=c[e]>l[e],r=c[e]<l[e];(o[d]===1&&(!t&&n||t&&r)||o[d]!==1&&(!t&&r||t&&n))&&(p=d===`x`?i:u)}let v={x:c.x+g.x,y:c.y+g.y},y={x:l.x+_.x,y:l.y+_.y},b=Math.max(Math.abs(v.x-p[0].x),Math.abs(y.x-p[0].x)),x=Math.max(Math.abs(v.y-p[0].y),Math.abs(y.y-p[0].y));b>=x?(m=(v.x+y.x)/2,h=p[0].y):(m=p[0].x,h=(v.y+y.y)/2)}return[[e,{x:c.x+g.x,y:c.y+g.y},...p,{x:l.x+_.x,y:l.y+_.y},n],m,h,b,x]}function Dy(e,t,n,r){let i=Math.min(Ty(e,t)/2,Ty(t,n)/2,r),{x:a,y:o}=t;if(e.x===a&&a===n.x||e.y===o&&o===n.y)return`L${a} ${o}`;if(e.y===o){let t=e.x<n.x?-1:1,r=e.y<n.y?1:-1;return`L ${a+i*t},${o}Q ${a},${o} ${a},${o+i*r}`}let s=e.x<n.x?1:-1,c=e.y<n.y?-1:1;return`L ${a},${o+i*c}Q ${a},${o} ${a+i*s},${o}`}function Oy({sourceX:e,sourceY:t,sourcePosition:n=Q.Bottom,targetX:r,targetY:i,targetPosition:a=Q.Top,borderRadius:o=5,centerX:s,centerY:c,offset:l=20}){let[u,d,f,p,m]=Ey({source:{x:e,y:t},sourcePosition:n,target:{x:r,y:i},targetPosition:a,center:{x:s,y:c},offset:l});return[u.reduce((e,t,n)=>{let r=``;return r=n>0&&n<u.length-1?Dy(u[n-1],t,u[n+1],o):`${n===0?`M`:`L`}${t.x} ${t.y}`,e+=r,e},``),d,f,p,m]}var ky=(0,H.memo)(({sourceX:e,sourceY:t,targetX:n,targetY:r,label:i,labelStyle:a,labelShowBg:o,labelBgStyle:s,labelBgPadding:c,labelBgBorderRadius:l,style:u,sourcePosition:d=Q.Bottom,targetPosition:f=Q.Top,markerEnd:p,markerStart:m,pathOptions:h,interactionWidth:g})=>{let[_,v,y]=Oy({sourceX:e,sourceY:t,sourcePosition:d,targetX:n,targetY:r,targetPosition:f,borderRadius:h?.borderRadius,offset:h?.offset});return H.createElement(dy,{path:_,labelX:v,labelY:y,label:i,labelStyle:a,labelShowBg:o,labelBgStyle:s,labelBgPadding:c,labelBgBorderRadius:l,style:u,markerEnd:p,markerStart:m,interactionWidth:g})});ky.displayName=`SmoothStepEdge`;var Ay=(0,H.memo)(e=>H.createElement(ky,{...e,pathOptions:(0,H.useMemo)(()=>({borderRadius:0,offset:e.pathOptions?.offset}),[e.pathOptions?.offset])}));Ay.displayName=`StepEdge`;function jy({sourceX:e,sourceY:t,targetX:n,targetY:r}){let[i,a,o,s]=py({sourceX:e,sourceY:t,targetX:n,targetY:r});return[`M ${e},${t}L ${n},${r}`,i,a,o,s]}var My=(0,H.memo)(({sourceX:e,sourceY:t,targetX:n,targetY:r,label:i,labelStyle:a,labelShowBg:o,labelBgStyle:s,labelBgPadding:c,labelBgBorderRadius:l,style:u,markerEnd:d,markerStart:f,interactionWidth:p})=>{let[m,h,g]=jy({sourceX:e,sourceY:t,targetX:n,targetY:r});return H.createElement(dy,{path:m,labelX:h,labelY:g,label:i,labelStyle:a,labelShowBg:o,labelBgStyle:s,labelBgPadding:c,labelBgBorderRadius:l,style:u,markerEnd:d,markerStart:f,interactionWidth:p})});My.displayName=`StraightEdge`;function Ny(e,t){return e>=0?.5*e:t*25*Math.sqrt(-e)}function Py({pos:e,x1:t,y1:n,x2:r,y2:i,c:a}){switch(e){case Q.Left:return[t-Ny(t-r,a),n];case Q.Right:return[t+Ny(r-t,a),n];case Q.Top:return[t,n-Ny(n-i,a)];case Q.Bottom:return[t,n+Ny(i-n,a)]}}function Fy({sourceX:e,sourceY:t,sourcePosition:n=Q.Bottom,targetX:r,targetY:i,targetPosition:a=Q.Top,curvature:o=.25}){let[s,c]=Py({pos:n,x1:e,y1:t,x2:r,y2:i,c:o}),[l,u]=Py({pos:a,x1:r,y1:i,x2:e,y2:t,c:o}),[d,f,p,m]=my({sourceX:e,sourceY:t,targetX:r,targetY:i,sourceControlX:s,sourceControlY:c,targetControlX:l,targetControlY:u});return[`M${e},${t} C${s},${c} ${l},${u} ${r},${i}`,d,f,p,m]}var Iy=(0,H.memo)(({sourceX:e,sourceY:t,targetX:n,targetY:r,sourcePosition:i=Q.Bottom,targetPosition:a=Q.Top,label:o,labelStyle:s,labelShowBg:c,labelBgStyle:l,labelBgPadding:u,labelBgBorderRadius:d,style:f,markerEnd:p,markerStart:m,pathOptions:h,interactionWidth:g})=>{let[_,v,y]=Fy({sourceX:e,sourceY:t,sourcePosition:i,targetX:n,targetY:r,targetPosition:a,curvature:h?.curvature});return H.createElement(dy,{path:_,labelX:v,labelY:y,label:o,labelStyle:s,labelShowBg:c,labelBgStyle:l,labelBgPadding:u,labelBgBorderRadius:d,style:f,markerEnd:p,markerStart:m,interactionWidth:g})});Iy.displayName=`BezierEdge`;var Ly=(0,H.createContext)(null),Ry=Ly.Provider;Ly.Consumer;var zy=()=>(0,H.useContext)(Ly),By=e=>`id`in e&&`source`in e&&`target`in e,Vy=({source:e,sourceHandle:t,target:n,targetHandle:r})=>`reactflow__edge-${e}${t||``}-${n}${r||``}`,Hy=(e,t)=>e===void 0?``:typeof e==`string`?e:`${t?`${t}__`:``}${Object.keys(e).sort().map(t=>`${t}=${e[t]}`).join(`&`)}`,Uy=(e,t)=>t.some(t=>t.source===e.source&&t.target===e.target&&(t.sourceHandle===e.sourceHandle||!t.sourceHandle&&!e.sourceHandle)&&(t.targetHandle===e.targetHandle||!t.targetHandle&&!e.targetHandle)),Wy=(e,t)=>{if(!e.source||!e.target)return Lv.error006(),t;let n;return n=By(e)?{...e}:{...e,id:Vy(e)},Uy(n,t)?t:t.concat(n)},Gy=({x:e,y:t},[n,r,i],a,[o,s])=>{let c={x:(e-n)/i,y:(t-r)/i};return a?{x:o*Math.round(c.x/o),y:s*Math.round(c.y/s)}:c},Ky=({x:e,y:t},[n,r,i])=>({x:e*i+n,y:t*i+r}),qy=(e,t=[0,0])=>{if(!e)return{x:0,y:0,positionAbsolute:{x:0,y:0}};let n=(e.width??0)*t[0],r=(e.height??0)*t[1],i={x:e.position.x-n,y:e.position.y-r};return{...i,positionAbsolute:e.positionAbsolute?{x:e.positionAbsolute.x-n,y:e.positionAbsolute.y-r}:i}},Jy=(e,t=[0,0])=>{if(e.length===0)return{x:0,y:0,width:0,height:0};let n=e.reduce((e,n)=>{let{x:r,y:i}=qy(n,t).positionAbsolute;return Xv(e,Zv({x:r,y:i,width:n.width||0,height:n.height||0}))},{x:1/0,y:1/0,x2:-1/0,y2:-1/0});return Qv(n)},Yy=(e,t,[n,r,i]=[0,0,1],a=!1,o=!1,s=[0,0])=>{let c={x:(t.x-n)/i,y:(t.y-r)/i,width:t.width/i,height:t.height/i},l=[];return e.forEach(e=>{let{width:t,height:n,selectable:r=!0,hidden:i=!1}=e;if(o&&!r||i)return!1;let{positionAbsolute:u}=qy(e,s),d={x:u.x,y:u.y,width:t||0,height:n||0},f=ty(c,d),p=t===void 0||n===void 0||t===null||n===null,m=a&&f>0,h=(t||0)*(n||0);(p||m||f>=h||e.dragging)&&l.push(e)}),l},Xy=(e,t)=>{let n=e.map(e=>e.id);return t.filter(e=>n.includes(e.source)||n.includes(e.target))},Zy=(e,t,n,r,i,a=.1)=>{let o=t/(e.width*(1+a)),s=n/(e.height*(1+a)),c=Gv(Math.min(o,s),r,i),l=e.x+e.width/2,u=e.y+e.height/2,d=t/2-l*c,f=n/2-u*c;return{x:d,y:f,zoom:c}},Qy=(e,t=0)=>e.transition().duration(t);function $y(e,t,n,r){return(t[n]||[]).reduce((t,i)=>(`${e.id}-${i.id}-${n}`!==r&&t.push({id:i.id||null,type:n,nodeId:e.id,x:(e.positionAbsolute?.x??0)+i.x+i.width/2,y:(e.positionAbsolute?.y??0)+i.y+i.height/2}),t),[])}function eb(e,t,n,r,i,a){let{x:o,y:s}=ly(e),c=t.elementsFromPoint(o,s).find(e=>e.classList.contains(`react-flow__handle`));if(c){let e=c.getAttribute(`data-nodeid`);if(e){let t=ab(void 0,c),r=c.getAttribute(`data-handleid`),o=a({nodeId:e,id:r,type:t});if(o){let a=i.find(n=>n.nodeId===e&&n.type===t&&n.id===r);return{handle:{id:r,type:t,nodeId:e,x:a?.x||n.x,y:a?.y||n.y},validHandleResult:o}}}}let l=[],u=1/0;if(i.forEach(e=>{let t=Math.sqrt((e.x-n.x)**2+(e.y-n.y)**2);if(t<=r){let n=a(e);t<=u&&(t<u?l=[{handle:e,validHandleResult:n}]:t===u&&l.push({handle:e,validHandleResult:n}),u=t)}}),!l.length)return{handle:null,validHandleResult:nb()};if(l.length===1)return l[0];let d=l.some(({validHandleResult:e})=>e.isValid),f=l.some(({handle:e})=>e.type===`target`);return l.find(({handle:e,validHandleResult:t})=>f?e.type===`target`:d?t.isValid:!0)||l[0]}var tb={source:null,target:null,sourceHandle:null,targetHandle:null},nb=()=>({handleDomNode:null,isValid:!1,connection:tb,endHandle:null});function rb(e,t,n,r,i,a,o){let s=i===`target`,c=o.querySelector(`.react-flow__handle[data-id="${e?.nodeId}-${e?.id}-${e?.type}"]`),l={...nb(),handleDomNode:c};if(c){let e=ab(void 0,c),i=c.getAttribute(`data-nodeid`),o=c.getAttribute(`data-handleid`),u=c.classList.contains(`connectable`),d=c.classList.contains(`connectableend`),f={source:s?i:n,sourceHandle:s?o:r,target:s?n:i,targetHandle:s?r:o};l.connection=f,u&&d&&(t===hy.Strict?s&&e===`source`||!s&&e===`target`:i!==n||o!==r)&&(l.endHandle={nodeId:i,handleId:o,type:e},l.isValid=a(f))}return l}function ib({nodes:e,nodeId:t,handleId:n,handleType:r}){return e.reduce((e,i)=>{if(i[Z]){let{handleBounds:a}=i[Z],o=[],s=[];a&&(o=$y(i,a,`source`,`${t}-${n}-${r}`),s=$y(i,a,`target`,`${t}-${n}-${r}`)),e.push(...o,...s)}return e},[])}function ab(e,t){return e||(t?.classList.contains(`target`)?`target`:t?.classList.contains(`source`)?`source`:null)}function ob(e){e?.classList.remove(`valid`,`connecting`,`react-flow__handle-valid`,`react-flow__handle-connecting`)}function sb(e,t){let n=null;return t?n=`valid`:e&&!t&&(n=`invalid`),n}function cb({event:e,handleId:t,nodeId:n,onConnect:r,isTarget:i,getState:a,setState:o,isValidConnection:s,edgeUpdaterType:c,onReconnectEnd:l}){let u=Yv(e.target),{connectionMode:d,domNode:f,autoPanOnConnect:p,connectionRadius:m,onConnectStart:h,panBy:g,getNodes:_,cancelConnection:v}=a(),y=0,b,{x,y:S}=ly(e),C=u?.elementFromPoint(x,S),w=ab(c,C),T=f?.getBoundingClientRect();if(!T||!w)return;let E,D=ly(e,T),O=!1,k=null,A=!1,j=null,M=ib({nodes:_(),nodeId:n,handleId:t,handleType:w}),N=()=>{if(!p)return;let[e,t]=Jv(D,T);g({x:e,y:t}),y=requestAnimationFrame(N)};o({connectionPosition:D,connectionStatus:null,connectionNodeId:n,connectionHandleId:t,connectionHandleType:w,connectionStartHandle:{nodeId:n,handleId:t,type:w},connectionEndHandle:null}),h?.(e,{nodeId:n,handleId:t,handleType:w});function P(e){let{transform:r}=a();D=ly(e,T);let{handle:c,validHandleResult:l}=eb(e,u,Gy(D,r,!1,[1,1]),m,M,e=>rb(e,d,n,t,i?`target`:`source`,s,u));if(b=c,O||=(N(),!0),j=l.handleDomNode,k=l.connection,A=l.isValid,o({connectionPosition:b&&A?Ky({x:b.x,y:b.y},r):D,connectionStatus:sb(!!b,A),connectionEndHandle:l.endHandle}),!b&&!A&&!j)return ob(E);k.source!==k.target&&j&&(ob(E),E=j,j.classList.add(`connecting`,`react-flow__handle-connecting`),j.classList.toggle(`valid`,A),j.classList.toggle(`react-flow__handle-valid`,A))}function F(e){(b||j)&&k&&A&&r?.(k),a().onConnectEnd?.(e),c&&l?.(e),ob(E),v(),cancelAnimationFrame(y),O=!1,A=!1,k=null,j=null,u.removeEventListener(`mousemove`,P),u.removeEventListener(`mouseup`,F),u.removeEventListener(`touchmove`,P),u.removeEventListener(`touchend`,F)}u.addEventListener(`mousemove`,P),u.addEventListener(`mouseup`,F),u.addEventListener(`touchmove`,P),u.addEventListener(`touchend`,F)}var lb=()=>!0,ub=e=>({connectionStartHandle:e.connectionStartHandle,connectOnClick:e.connectOnClick,noPanClassName:e.noPanClassName}),db=(e,t,n)=>r=>{let{connectionStartHandle:i,connectionEndHandle:a,connectionClickStartHandle:o}=r;return{connecting:i?.nodeId===e&&i?.handleId===t&&i?.type===n||a?.nodeId===e&&a?.handleId===t&&a?.type===n,clickConnecting:o?.nodeId===e&&o?.handleId===t&&o?.type===n}},fb=(0,H.forwardRef)(({type:e=`source`,position:t=Q.Top,isValidConnection:n,isConnectable:r=!0,isConnectableStart:i=!0,isConnectableEnd:a=!0,id:o,onConnect:s,children:c,className:l,onMouseDown:u,onTouchStart:d,...f},p)=>{let m=o||null,h=e===`target`,g=zv(),_=zy(),{connectOnClick:v,noPanClassName:y}=X(ub,tp),{connecting:b,clickConnecting:x}=X(db(_,m,e),tp);_||g.getState().onError?.(`010`,Lv.error010());let S=e=>{let{defaultEdgeOptions:t,onConnect:n,hasDefaultEdges:r}=g.getState(),i={...t,...e};if(r){let{edges:e,setEdges:t}=g.getState();t(Wy(i,e))}n?.(i),s?.(i)},C=e=>{if(!_)return;let t=cy(e);i&&(t&&e.button===0||!t)&&cb({event:e,handleId:m,nodeId:_,onConnect:S,isTarget:h,getState:g.getState,setState:g.setState,isValidConnection:n||g.getState().isValidConnection||lb}),t?u?.(e):d?.(e)},w=t=>{let{onClickConnectStart:r,onClickConnectEnd:a,connectionClickStartHandle:o,connectionMode:s,isValidConnection:c}=g.getState();if(!_||!o&&!i)return;if(!o){r?.(t,{nodeId:_,handleId:m,handleType:e}),g.setState({connectionClickStartHandle:{nodeId:_,type:e,handleId:m}});return}let l=Yv(t.target),u=n||c||lb,{connection:d,isValid:f}=rb({nodeId:_,id:m,type:e},s,o.nodeId,o.handleId||null,o.type,u,l);f&&S(d),a?.(t),g.setState({connectionClickStartHandle:null})};return H.createElement(`div`,{"data-handleid":m,"data-nodeid":_,"data-handlepos":t,"data-id":`${_}-${m}-${e}`,className:Vf([`react-flow__handle`,`react-flow__handle-${t}`,`nodrag`,y,l,{source:!h,target:h,connectable:r,connectablestart:i,connectableend:a,connecting:x,connectionindicator:r&&(i&&!b||a&&b)}]),onMouseDown:C,onTouchStart:C,onClick:v?w:void 0,ref:p,...f},c)});fb.displayName=`Handle`;var pb=(0,H.memo)(fb),mb=({data:e,isConnectable:t,targetPosition:n=Q.Top,sourcePosition:r=Q.Bottom})=>H.createElement(H.Fragment,null,H.createElement(pb,{type:`target`,position:n,isConnectable:t}),e?.label,H.createElement(pb,{type:`source`,position:r,isConnectable:t}));mb.displayName=`DefaultNode`;var hb=(0,H.memo)(mb),gb=({data:e,isConnectable:t,sourcePosition:n=Q.Bottom})=>H.createElement(H.Fragment,null,e?.label,H.createElement(pb,{type:`source`,position:n,isConnectable:t}));gb.displayName=`InputNode`;var _b=(0,H.memo)(gb),vb=({data:e,isConnectable:t,targetPosition:n=Q.Top})=>H.createElement(H.Fragment,null,H.createElement(pb,{type:`target`,position:n,isConnectable:t}),e?.label);vb.displayName=`OutputNode`;var yb=(0,H.memo)(vb),bb=()=>null;bb.displayName=`GroupNode`;var xb=e=>({selectedNodes:e.getNodes().filter(e=>e.selected),selectedEdges:e.edges.filter(e=>e.selected).map(e=>({...e}))}),Sb=e=>e.id;function Cb(e,t){return tp(e.selectedNodes.map(Sb),t.selectedNodes.map(Sb))&&tp(e.selectedEdges.map(Sb),t.selectedEdges.map(Sb))}var wb=(0,H.memo)(({onSelectionChange:e})=>{let t=zv(),{selectedNodes:n,selectedEdges:r}=X(xb,Cb);return(0,H.useEffect)(()=>{let i={nodes:n,edges:r};e?.(i),t.getState().onSelectionChange.forEach(e=>e(i))},[n,r,e]),null});wb.displayName=`SelectionListener`;var Tb=e=>!!e.onSelectionChange;function Eb({onSelectionChange:e}){let t=X(Tb);return e||t?H.createElement(wb,{onSelectionChange:e}):null}var Db=e=>({setNodes:e.setNodes,setEdges:e.setEdges,setDefaultNodesAndEdges:e.setDefaultNodesAndEdges,setMinZoom:e.setMinZoom,setMaxZoom:e.setMaxZoom,setTranslateExtent:e.setTranslateExtent,setNodeExtent:e.setNodeExtent,reset:e.reset});function Ob(e,t){(0,H.useEffect)(()=>{e!==void 0&&t(e)},[e])}function $(e,t,n){(0,H.useEffect)(()=>{t!==void 0&&n({[e]:t})},[t])}var kb=({nodes:e,edges:t,defaultNodes:n,defaultEdges:r,onConnect:i,onConnectStart:a,onConnectEnd:o,onClickConnectStart:s,onClickConnectEnd:c,nodesDraggable:l,nodesConnectable:u,nodesFocusable:d,edgesFocusable:f,edgesUpdatable:p,elevateNodesOnSelect:m,minZoom:h,maxZoom:g,nodeExtent:_,onNodesChange:v,onEdgesChange:y,elementsSelectable:b,connectionMode:x,snapGrid:S,snapToGrid:C,translateExtent:w,connectOnClick:T,defaultEdgeOptions:E,fitView:D,fitViewOptions:O,onNodesDelete:k,onEdgesDelete:A,onNodeDrag:j,onNodeDragStart:M,onNodeDragStop:N,onSelectionDrag:P,onSelectionDragStart:F,onSelectionDragStop:I,noPanClassName:L,nodeOrigin:R,rfId:ee,autoPanOnConnect:te,autoPanOnNodeDrag:ne,onError:re,connectionRadius:ie,isValidConnection:ae,nodeDragThreshold:oe})=>{let{setNodes:z,setEdges:se,setDefaultNodesAndEdges:ce,setMinZoom:le,setMaxZoom:B,setTranslateExtent:ue,setNodeExtent:de,reset:fe}=X(Db,tp),V=zv();return(0,H.useEffect)(()=>{let e=r?.map(e=>({...e,...E}));return ce(n,e),()=>{fe()}},[]),$(`defaultEdgeOptions`,E,V.setState),$(`connectionMode`,x,V.setState),$(`onConnect`,i,V.setState),$(`onConnectStart`,a,V.setState),$(`onConnectEnd`,o,V.setState),$(`onClickConnectStart`,s,V.setState),$(`onClickConnectEnd`,c,V.setState),$(`nodesDraggable`,l,V.setState),$(`nodesConnectable`,u,V.setState),$(`nodesFocusable`,d,V.setState),$(`edgesFocusable`,f,V.setState),$(`edgesUpdatable`,p,V.setState),$(`elementsSelectable`,b,V.setState),$(`elevateNodesOnSelect`,m,V.setState),$(`snapToGrid`,C,V.setState),$(`snapGrid`,S,V.setState),$(`onNodesChange`,v,V.setState),$(`onEdgesChange`,y,V.setState),$(`connectOnClick`,T,V.setState),$(`fitViewOnInit`,D,V.setState),$(`fitViewOnInitOptions`,O,V.setState),$(`onNodesDelete`,k,V.setState),$(`onEdgesDelete`,A,V.setState),$(`onNodeDrag`,j,V.setState),$(`onNodeDragStart`,M,V.setState),$(`onNodeDragStop`,N,V.setState),$(`onSelectionDrag`,P,V.setState),$(`onSelectionDragStart`,F,V.setState),$(`onSelectionDragStop`,I,V.setState),$(`noPanClassName`,L,V.setState),$(`nodeOrigin`,R,V.setState),$(`rfId`,ee,V.setState),$(`autoPanOnConnect`,te,V.setState),$(`autoPanOnNodeDrag`,ne,V.setState),$(`onError`,re,V.setState),$(`connectionRadius`,ie,V.setState),$(`isValidConnection`,ae,V.setState),$(`nodeDragThreshold`,oe,V.setState),Ob(e,z),Ob(t,se),Ob(h,le),Ob(g,B),Ob(w,ue),Ob(_,de),null},Ab={display:`none`},jb={position:`absolute`,width:1,height:1,margin:-1,border:0,padding:0,overflow:`hidden`,clip:`rect(0px, 0px, 0px, 0px)`,clipPath:`inset(100%)`},Mb=`react-flow__node-desc`,Nb=`react-flow__edge-desc`,Pb=`react-flow__aria-live`,Fb=e=>e.ariaLiveMessage;function Ib({rfId:e}){let t=X(Fb);return H.createElement(`div`,{id:`${Pb}-${e}`,"aria-live":`assertive`,"aria-atomic":`true`,style:jb},t)}function Lb({rfId:e,disableKeyboardA11y:t}){return H.createElement(H.Fragment,null,H.createElement(`div`,{id:`${Mb}-${e}`,style:Ab},`Press enter or space to select a node.`,!t&&`You can then use the arrow keys to move the node around.`,` Press delete to remove it and escape to cancel.`,` `),H.createElement(`div`,{id:`${Nb}-${e}`,style:Ab},`Press enter or space to select an edge. You can then press delete to remove it or escape to cancel.`),!t&&H.createElement(Ib,{rfId:e}))}var Rb=(e=null,t={actInsideInputWithModifier:!0})=>{let[n,r]=(0,H.useState)(!1),i=(0,H.useRef)(!1),a=(0,H.useRef)(new Set([])),[o,s]=(0,H.useMemo)(()=>{if(e!==null){let t=(Array.isArray(e)?e:[e]).filter(e=>typeof e==`string`).map(e=>e.split(`+`)),n=t.reduce((e,t)=>e.concat(...t),[]);return[t,n]}return[[],[]]},[e]);return(0,H.useEffect)(()=>{let n=typeof document<`u`?document:null,c=t?.target||n;if(e!==null){let e=e=>{if(i.current=e.ctrlKey||e.metaKey||e.shiftKey,(!i.current||i.current&&!t.actInsideInputWithModifier)&&sy(e))return!1;let n=Bb(e.code,s);a.current.add(e[n]),zb(o,a.current,!1)&&(e.preventDefault(),r(!0))},n=e=>{if((!i.current||i.current&&!t.actInsideInputWithModifier)&&sy(e))return!1;let n=Bb(e.code,s);zb(o,a.current,!0)?(r(!1),a.current.clear()):a.current.delete(e[n]),e.key===`Meta`&&a.current.clear(),i.current=!1},l=()=>{a.current.clear(),r(!1)};return c?.addEventListener(`keydown`,e),c?.addEventListener(`keyup`,n),window.addEventListener(`blur`,l),()=>{c?.removeEventListener(`keydown`,e),c?.removeEventListener(`keyup`,n),window.removeEventListener(`blur`,l)}}},[e,r]),n};function zb(e,t,n){return e.filter(e=>n||e.length===t.size).some(e=>e.every(e=>t.has(e)))}function Bb(e,t){return t.includes(e)?`code`:`key`}function Vb(e,t,n,r){let i=e.parentNode||e.parentId;if(!i)return n;let a=t.get(i),o=qy(a,r);return Vb(a,t,{x:(n.x??0)+o.x,y:(n.y??0)+o.y,z:(a[Z]?.z??0)>(n.z??0)?a[Z]?.z??0:n.z??0},r)}function Hb(e,t,n){e.forEach(r=>{let i=r.parentNode||r.parentId;if(i&&!e.has(i))throw Error(`Parent node ${i} not found`);if(i||n?.[r.id]){let{x:i,y:a,z:o}=Vb(r,e,{...r.position,z:r[Z]?.z??0},t);r.positionAbsolute={x:i,y:a},r[Z].z=o,n?.[r.id]&&(r[Z].isParent=!0)}})}function Ub(e,t,n,r){let i=new Map,a={},o=r?1e3:0;return e.forEach(e=>{let n=(ry(e.zIndex)?e.zIndex:0)+(e.selected?o:0),r=t.get(e.id),s={...e,positionAbsolute:{x:e.position.x,y:e.position.y}},c=e.parentNode||e.parentId;c&&(a[c]=!0);let l=r?.type&&r?.type!==e.type;Object.defineProperty(s,Z,{enumerable:!1,value:{handleBounds:l?void 0:r?.[Z]?.handleBounds,z:n}}),i.set(e.id,s)}),Hb(i,n,a),i}function Wb(e,t={}){let{getNodes:n,width:r,height:i,minZoom:a,maxZoom:o,d3Zoom:s,d3Selection:c,fitViewOnInitDone:l,fitViewOnInit:u,nodeOrigin:d}=e(),f=t.initial&&!l&&u;if(s&&c&&(f||!t.initial)){let e=n().filter(e=>{let n=t.includeHiddenNodes?e.width&&e.height:!e.hidden;return t.nodes?.length?n&&t.nodes.some(t=>t.id===e.id):n}),l=e.every(e=>e.width&&e.height);if(e.length>0&&l){let n=Jy(e,d),{x:l,y:u,zoom:f}=Zy(n,r,i,t.minZoom??a,t.maxZoom??o,t.padding??.1),p=wv.translate(l,u).scale(f);return typeof t.duration==`number`&&t.duration>0?s.transform(Qy(c,t.duration),p):s.transform(c,p),!0}}return!1}function Gb(e,t){return e.forEach(e=>{let n=t.get(e.id);n&&t.set(n.id,{...n,[Z]:n[Z],selected:e.selected})}),new Map(t)}function Kb(e,t){return t.map(t=>{let n=e.find(e=>e.id===t.id);return n&&(t.selected=n.selected),t})}function qb({changedNodes:e,changedEdges:t,get:n,set:r}){let{nodeInternals:i,edges:a,onNodesChange:o,onEdgesChange:s,hasDefaultNodes:c,hasDefaultEdges:l}=n();e?.length&&(c&&r({nodeInternals:Gb(e,i)}),o?.(e)),t?.length&&(l&&r({edges:Kb(t,a)}),s?.(t))}var Jb=()=>{},Yb={zoomIn:Jb,zoomOut:Jb,zoomTo:Jb,getZoom:()=>1,setViewport:Jb,getViewport:()=>({x:0,y:0,zoom:1}),fitView:()=>!1,setCenter:Jb,fitBounds:Jb,project:e=>e,screenToFlowPosition:e=>e,flowToScreenPosition:e=>e,viewportInitialized:!1},Xb=e=>({d3Zoom:e.d3Zoom,d3Selection:e.d3Selection}),Zb=()=>{let e=zv(),{d3Zoom:t,d3Selection:n}=X(Xb,tp);return(0,H.useMemo)(()=>n&&t?{zoomIn:e=>t.scaleBy(Qy(n,e?.duration),1.2),zoomOut:e=>t.scaleBy(Qy(n,e?.duration),1/1.2),zoomTo:(e,r)=>t.scaleTo(Qy(n,r?.duration),e),getZoom:()=>e.getState().transform[2],setViewport:(r,i)=>{let[a,o,s]=e.getState().transform,c=wv.translate(r.x??a,r.y??o).scale(r.zoom??s);t.transform(Qy(n,i?.duration),c)},getViewport:()=>{let[t,n,r]=e.getState().transform;return{x:t,y:n,zoom:r}},fitView:t=>Wb(e.getState,t),setCenter:(r,i,a)=>{let{width:o,height:s,maxZoom:c}=e.getState(),l=a?.zoom===void 0?c:a.zoom,u=o/2-r*l,d=s/2-i*l,f=wv.translate(u,d).scale(l);t.transform(Qy(n,a?.duration),f)},fitBounds:(r,i)=>{let{width:a,height:o,minZoom:s,maxZoom:c}=e.getState(),{x:l,y:u,zoom:d}=Zy(r,a,o,s,c,i?.padding??.1),f=wv.translate(l,u).scale(d);t.transform(Qy(n,i?.duration),f)},project:t=>{let{transform:n,snapToGrid:r,snapGrid:i}=e.getState();return console.warn("[DEPRECATED] `project` is deprecated. Instead use `screenToFlowPosition`. There is no need to subtract the react flow bounds anymore! https://reactflow.dev/api-reference/types/react-flow-instance#screen-to-flow-position"),Gy(t,n,r,i)},screenToFlowPosition:t=>{let{transform:n,snapToGrid:r,snapGrid:i,domNode:a}=e.getState();if(!a)return t;let{x:o,y:s}=a.getBoundingClientRect(),c={x:t.x-o,y:t.y-s};return Gy(c,n,r,i)},flowToScreenPosition:t=>{let{transform:n,domNode:r}=e.getState();if(!r)return t;let{x:i,y:a}=r.getBoundingClientRect(),o=Ky(t,n);return{x:o.x+i,y:o.y+a}},viewportInitialized:!0}:Yb,[t,n])};function Qb(){let e=Zb(),t=zv(),n=(0,H.useCallback)(()=>t.getState().getNodes().map(e=>({...e})),[]),r=(0,H.useCallback)(e=>t.getState().nodeInternals.get(e),[]),i=(0,H.useCallback)(()=>{let{edges:e=[]}=t.getState();return e.map(e=>({...e}))},[]),a=(0,H.useCallback)(e=>{let{edges:n=[]}=t.getState();return n.find(t=>t.id===e)},[]),o=(0,H.useCallback)(e=>{let{getNodes:n,setNodes:r,hasDefaultNodes:i,onNodesChange:a}=t.getState(),o=n(),s=typeof e==`function`?e(o):e;if(i)r(s);else if(a){let e=s.length===0?o.map(e=>({type:`remove`,id:e.id})):s.map(e=>({item:e,type:`reset`}));a(e)}},[]),s=(0,H.useCallback)(e=>{let{edges:n=[],setEdges:r,hasDefaultEdges:i,onEdgesChange:a}=t.getState(),o=typeof e==`function`?e(n):e;if(i)r(o);else if(a){let e=o.length===0?n.map(e=>({type:`remove`,id:e.id})):o.map(e=>({item:e,type:`reset`}));a(e)}},[]),c=(0,H.useCallback)(e=>{let n=Array.isArray(e)?e:[e],{getNodes:r,setNodes:i,hasDefaultNodes:a,onNodesChange:o}=t.getState();if(a){let e=[...r(),...n];i(e)}else if(o){let e=n.map(e=>({item:e,type:`add`}));o(e)}},[]),l=(0,H.useCallback)(e=>{let n=Array.isArray(e)?e:[e],{edges:r=[],setEdges:i,hasDefaultEdges:a,onEdgesChange:o}=t.getState();if(a)i([...r,...n]);else if(o){let e=n.map(e=>({item:e,type:`add`}));o(e)}},[]),u=(0,H.useCallback)(()=>{let{getNodes:e,edges:n=[],transform:r}=t.getState(),[i,a,o]=r;return{nodes:e().map(e=>({...e})),edges:n.map(e=>({...e})),viewport:{x:i,y:a,zoom:o}}},[]),d=(0,H.useCallback)(({nodes:e,edges:n})=>{let{nodeInternals:r,getNodes:i,edges:a,hasDefaultNodes:o,hasDefaultEdges:s,onNodesDelete:c,onEdgesDelete:l,onNodesChange:u,onEdgesChange:d}=t.getState(),f=(e||[]).map(e=>e.id),p=(n||[]).map(e=>e.id),m=i().reduce((e,t)=>{let n=t.parentNode||t.parentId,r=!f.includes(t.id)&&n&&e.find(e=>e.id===n);return(typeof t.deletable!=`boolean`||t.deletable)&&(f.includes(t.id)||r)&&e.push(t),e},[]),h=a.filter(e=>typeof e.deletable==`boolean`?e.deletable:!0),g=h.filter(e=>p.includes(e.id));if(m||g){let e=Xy(m,h),n=[...g,...e],i=n.reduce((e,t)=>(e.includes(t.id)||e.push(t.id),e),[]);if((s||o)&&(s&&t.setState({edges:a.filter(e=>!i.includes(e.id))}),o&&(m.forEach(e=>{r.delete(e.id)}),t.setState({nodeInternals:new Map(r)}))),i.length>0&&(l?.(n),d&&d(i.map(e=>({id:e,type:`remove`})))),m.length>0&&(c?.(m),u)){let e=m.map(e=>({id:e.id,type:`remove`}));u(e)}}},[]),f=(0,H.useCallback)(e=>{let n=ny(e),r=n?null:t.getState().nodeInternals.get(e.id);return!n&&!r?[null,null,n]:[n?e:$v(r),r,n]},[]),p=(0,H.useCallback)((e,n=!0,r)=>{let[i,a,o]=f(e);return i?(r||t.getState().getNodes()).filter(e=>{if(!o&&(e.id===a.id||!e.positionAbsolute))return!1;let t=$v(e),r=ty(t,i);return n&&r>0||r>=i.width*i.height}):[]},[]),m=(0,H.useCallback)((e,t,n=!0)=>{let[r]=f(e);if(!r)return!1;let i=ty(r,t);return n&&i>0||i>=r.width*r.height},[]);return(0,H.useMemo)(()=>({...e,getNodes:n,getNode:r,getEdges:i,getEdge:a,setNodes:o,setEdges:s,addNodes:c,addEdges:l,toObject:u,deleteElements:d,getIntersectingNodes:p,isNodeIntersecting:m}),[e,n,r,i,a,o,s,c,l,u,d,p,m])}var $b={actInsideInputWithModifier:!1},ex=({deleteKeyCode:e,multiSelectionKeyCode:t})=>{let n=zv(),{deleteElements:r}=Qb(),i=Rb(e,$b),a=Rb(t);(0,H.useEffect)(()=>{if(i){let{edges:e,getNodes:t}=n.getState(),i=t().filter(e=>e.selected),a=e.filter(e=>e.selected);r({nodes:i,edges:a}),n.setState({nodesSelectionActive:!1})}},[i]),(0,H.useEffect)(()=>{n.setState({multiSelectionActive:a})},[a])};function tx(e){let t=zv();(0,H.useEffect)(()=>{let n,r=()=>{if(!e.current)return;let n=Wv(e.current);(n.height===0||n.width===0)&&t.getState().onError?.(`004`,Lv.error004()),t.setState({width:n.width||500,height:n.height||500})};return r(),window.addEventListener(`resize`,r),e.current&&(n=new ResizeObserver(()=>r()),n.observe(e.current)),()=>{window.removeEventListener(`resize`,r),n&&e.current&&n.unobserve(e.current)}},[])}var nx={position:`absolute`,width:`100%`,height:`100%`,top:0,left:0},rx=(e,t)=>e.x!==t.x||e.y!==t.y||e.zoom!==t.k,ix=e=>({x:e.x,y:e.y,zoom:e.k}),ax=(e,t)=>e.target.closest(`.${t}`),ox=(e,t)=>t===2&&Array.isArray(e)&&e.includes(2),sx=e=>{let t=e.ctrlKey&&uy()?10:1;return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*t},cx=e=>({d3Zoom:e.d3Zoom,d3Selection:e.d3Selection,d3ZoomHandler:e.d3ZoomHandler,userSelectionActive:e.userSelectionActive}),lx=({onMove:e,onMoveStart:t,onMoveEnd:n,onPaneContextMenu:r,zoomOnScroll:i=!0,zoomOnPinch:a=!0,panOnScroll:o=!1,panOnScrollSpeed:s=.5,panOnScrollMode:c=gy.Free,zoomOnDoubleClick:l=!0,elementsSelectable:u,panOnDrag:d=!0,defaultViewport:f,translateExtent:p,minZoom:m,maxZoom:h,zoomActivationKeyCode:g,preventScrolling:_=!0,children:v,noWheelClassName:y,noPanClassName:b})=>{let x=(0,H.useRef)(),S=zv(),C=(0,H.useRef)(!1),w=(0,H.useRef)(!1),T=(0,H.useRef)(null),E=(0,H.useRef)({x:0,y:0,zoom:0}),{d3Zoom:D,d3Selection:O,d3ZoomHandler:k,userSelectionActive:A}=X(cx,tp),j=Rb(g),M=(0,H.useRef)(0),N=(0,H.useRef)(!1),P=(0,H.useRef)();return tx(T),(0,H.useEffect)(()=>{if(T.current){let e=T.current.getBoundingClientRect(),t=Pv().scaleExtent([m,h]).translateExtent(p),n=ch(T.current).call(t),r=wv.translate(f.x,f.y).scale(Gv(f.zoom,m,h)),i=[[0,0],[e.width,e.height]],a=t.constrain()(r,i,p);t.transform(n,a),t.wheelDelta(sx),S.setState({d3Zoom:t,d3Selection:n,d3ZoomHandler:n.on(`wheel.zoom`),transform:[a.x,a.y,a.k],domNode:T.current.closest(`.react-flow`)})}},[]),(0,H.useEffect)(()=>{O&&D&&(o&&!j&&!A?O.on(`wheel.zoom`,r=>{if(ax(r,y))return!1;r.preventDefault(),r.stopImmediatePropagation();let i=O.property(`__zoom`).k||1;if(r.ctrlKey&&a){let e=uh(r),t=sx(r),n=i*2**t;D.scaleTo(O,n,e,r);return}let o=r.deltaMode===1?20:1,l=c===gy.Vertical?0:r.deltaX*o,u=c===gy.Horizontal?0:r.deltaY*o;!uy()&&r.shiftKey&&c!==gy.Vertical&&(l=r.deltaY*o,u=0),D.translateBy(O,-(l/i)*s,-(u/i)*s,{internal:!0});let d=ix(O.property(`__zoom`)),{onViewportChangeStart:f,onViewportChange:p,onViewportChangeEnd:m}=S.getState();clearTimeout(P.current),N.current||(N.current=!0,t?.(r,d),f?.(d)),N.current&&(e?.(r,d),p?.(d),P.current=setTimeout(()=>{n?.(r,d),m?.(d),N.current=!1},150))},{passive:!1}):k!==void 0&&O.on(`wheel.zoom`,function(e,t){if(!_&&e.type===`wheel`&&!e.ctrlKey||ax(e,y))return null;e.preventDefault(),k.call(this,e,t)},{passive:!1}))},[A,o,c,O,D,k,j,a,_,y,t,e,n]),(0,H.useEffect)(()=>{D&&D.on(`start`,e=>{if(!e.sourceEvent||e.sourceEvent.internal)return null;M.current=e.sourceEvent?.button;let{onViewportChangeStart:n}=S.getState(),r=ix(e.transform);C.current=!0,E.current=r,e.sourceEvent?.type===`mousedown`&&S.setState({paneDragging:!0}),n?.(r),t?.(e.sourceEvent,r)})},[D,t]),(0,H.useEffect)(()=>{D&&(A&&!C.current?D.on(`zoom`,null):A||D.on(`zoom`,t=>{let{onViewportChange:n}=S.getState();if(S.setState({transform:[t.transform.x,t.transform.y,t.transform.k]}),w.current=!!(r&&ox(d,M.current??0)),(e||n)&&!t.sourceEvent?.internal){let r=ix(t.transform);n?.(r),e?.(t.sourceEvent,r)}}))},[A,D,e,d,r]),(0,H.useEffect)(()=>{D&&D.on(`end`,e=>{if(!e.sourceEvent||e.sourceEvent.internal)return null;let{onViewportChangeEnd:t}=S.getState();if(C.current=!1,S.setState({paneDragging:!1}),r&&ox(d,M.current??0)&&!w.current&&r(e.sourceEvent),w.current=!1,(n||t)&&rx(E.current,e.transform)){let r=ix(e.transform);E.current=r,clearTimeout(x.current),x.current=setTimeout(()=>{t?.(r),n?.(e.sourceEvent,r)},o?150:0)}})},[D,o,d,n,r]),(0,H.useEffect)(()=>{D&&D.filter(e=>{let t=j||i,n=a&&e.ctrlKey;if((d===!0||Array.isArray(d)&&d.includes(1))&&e.button===1&&e.type===`mousedown`&&(ax(e,`react-flow__node`)||ax(e,`react-flow__edge`)))return!0;if(!d&&!t&&!o&&!l&&!a||A||!l&&e.type===`dblclick`||ax(e,y)&&e.type===`wheel`||ax(e,b)&&(e.type!==`wheel`||o&&e.type===`wheel`&&!j)||!a&&e.ctrlKey&&e.type===`wheel`||!t&&!o&&!n&&e.type===`wheel`||!d&&(e.type===`mousedown`||e.type===`touchstart`)||Array.isArray(d)&&!d.includes(e.button)&&e.type===`mousedown`)return!1;let r=Array.isArray(d)&&d.includes(e.button)||!e.button||e.button<=1;return(!e.ctrlKey||e.type===`wheel`)&&r})},[A,D,i,a,o,l,d,u,j]),H.createElement(`div`,{className:`react-flow__renderer`,ref:T,style:nx},v)},ux=e=>({userSelectionActive:e.userSelectionActive,userSelectionRect:e.userSelectionRect});function dx(){let{userSelectionActive:e,userSelectionRect:t}=X(ux,tp);return e&&t?H.createElement(`div`,{className:`react-flow__selection react-flow__container`,style:{width:t.width,height:t.height,transform:`translate(${t.x}px, ${t.y}px)`}}):null}function fx(e,t){let n=t.parentNode||t.parentId,r=e.find(e=>e.id===n);if(r){let e=t.position.x+t.width-r.width,n=t.position.y+t.height-r.height;if(e>0||n>0||t.position.x<0||t.position.y<0){if(r.style={...r.style},r.style.width=r.style.width??r.width,r.style.height=r.style.height??r.height,e>0&&(r.style.width+=e),n>0&&(r.style.height+=n),t.position.x<0){let e=Math.abs(t.position.x);r.position.x=r.position.x-e,r.style.width+=e,t.position.x=0}if(t.position.y<0){let e=Math.abs(t.position.y);r.position.y=r.position.y-e,r.style.height+=e,t.position.y=0}r.width=r.style.width,r.height=r.style.height}}}function px(e,t){if(e.some(e=>e.type===`reset`))return e.filter(e=>e.type===`reset`).map(e=>e.item);let n=e.filter(e=>e.type===`add`).map(e=>e.item);return t.reduce((t,n)=>{let r=e.filter(e=>e.id===n.id);if(r.length===0)return t.push(n),t;let i={...n};for(let e of r)if(e)switch(e.type){case`select`:i.selected=e.selected;break;case`position`:e.position!==void 0&&(i.position=e.position),e.positionAbsolute!==void 0&&(i.positionAbsolute=e.positionAbsolute),e.dragging!==void 0&&(i.dragging=e.dragging),i.expandParent&&fx(t,i);break;case`dimensions`:e.dimensions!==void 0&&(i.width=e.dimensions.width,i.height=e.dimensions.height),e.updateStyle!==void 0&&(i.style={...i.style||{},...e.dimensions}),typeof e.resizing==`boolean`&&(i.resizing=e.resizing),i.expandParent&&fx(t,i);break;case`remove`:return t}return t.push(i),t},n)}function mx(e,t){return px(e,t)}var hx=(e,t)=>({id:e,type:`select`,selected:t});function gx(e,t){return e.reduce((e,n)=>{let r=t.includes(n.id);return!n.selected&&r?(n.selected=!0,e.push(hx(n.id,!0))):n.selected&&!r&&(n.selected=!1,e.push(hx(n.id,!1))),e},[])}var _x=(e,t)=>n=>{n.target===t.current&&e?.(n)},vx=e=>({userSelectionActive:e.userSelectionActive,elementsSelectable:e.elementsSelectable,dragging:e.paneDragging}),yx=(0,H.memo)(({isSelecting:e,selectionMode:t=_y.Full,panOnDrag:n,onSelectionStart:r,onSelectionEnd:i,onPaneClick:a,onPaneContextMenu:o,onPaneScroll:s,onPaneMouseEnter:c,onPaneMouseMove:l,onPaneMouseLeave:u,children:d})=>{let f=(0,H.useRef)(null),p=zv(),m=(0,H.useRef)(0),h=(0,H.useRef)(0),g=(0,H.useRef)(),{userSelectionActive:_,elementsSelectable:v,dragging:y}=X(vx,tp),b=()=>{p.setState({userSelectionActive:!1,userSelectionRect:null}),m.current=0,h.current=0},x=e=>{a?.(e),p.getState().resetSelectedElements(),p.setState({nodesSelectionActive:!1})},S=e=>{if(Array.isArray(n)&&n?.includes(2)){e.preventDefault();return}o?.(e)},C=s?e=>s(e):void 0,w=t=>{let{resetSelectedElements:n,domNode:i}=p.getState();if(g.current=i?.getBoundingClientRect(),!v||!e||t.button!==0||t.target!==f.current||!g.current)return;let{x:a,y:o}=ly(t,g.current);n(),p.setState({userSelectionRect:{width:0,height:0,startX:a,startY:o,x:a,y:o}}),r?.(t)},T=n=>{let{userSelectionRect:r,nodeInternals:i,edges:a,transform:o,onNodesChange:s,onEdgesChange:c,nodeOrigin:l,getNodes:u}=p.getState();if(!e||!g.current||!r)return;p.setState({userSelectionActive:!0,nodesSelectionActive:!1});let d=ly(n,g.current),f=r.startX??0,_=r.startY??0,v={...r,x:d.x<f?d.x:f,y:d.y<_?d.y:_,width:Math.abs(d.x-f),height:Math.abs(d.y-_)},y=u(),b=Yy(i,v,o,t===_y.Partial,!0,l),x=Xy(b,a).map(e=>e.id),S=b.map(e=>e.id);if(m.current!==S.length){m.current=S.length;let e=gx(y,S);e.length&&s?.(e)}if(h.current!==x.length){h.current=x.length;let e=gx(a,x);e.length&&c?.(e)}p.setState({userSelectionRect:v})},E=e=>{if(e.button!==0)return;let{userSelectionRect:t}=p.getState();!_&&t&&e.target===f.current&&x?.(e),p.setState({nodesSelectionActive:m.current>0}),b(),i?.(e)},D=e=>{_&&(p.setState({nodesSelectionActive:m.current>0}),i?.(e)),b()},O=v&&(e||_);return H.createElement(`div`,{className:Vf([`react-flow__pane`,{dragging:y,selection:e}]),onClick:O?void 0:_x(x,f),onContextMenu:_x(S,f),onWheel:_x(C,f),onMouseEnter:O?void 0:c,onMouseDown:O?w:void 0,onMouseMove:O?T:l,onMouseUp:O?E:void 0,onMouseLeave:O?D:u,ref:f,style:nx},d,H.createElement(dx,null))});yx.displayName=`Pane`;function bx(e,t){let n=e.parentNode||e.parentId;if(!n)return!1;let r=t.get(n);return r?r.selected?!0:bx(r,t):!1}function xx(e,t,n){let r=e;do{if(r?.matches(t))return!0;if(r===n.current)return!1;r=r.parentElement}while(r);return!1}function Sx(e,t,n,r){return Array.from(e.values()).filter(n=>(n.selected||n.id===r)&&(!n.parentNode||n.parentId||!bx(n,e))&&(n.draggable||t&&n.draggable===void 0)).map(e=>({id:e.id,position:e.position||{x:0,y:0},positionAbsolute:e.positionAbsolute||{x:0,y:0},distance:{x:n.x-(e.positionAbsolute?.x??0),y:n.y-(e.positionAbsolute?.y??0)},delta:{x:0,y:0},extent:e.extent,parentNode:e.parentNode||e.parentId,parentId:e.parentNode||e.parentId,width:e.width,height:e.height,expandParent:e.expandParent}))}function Cx(e,t){return!t||t===`parent`?t:[t[0],[t[1][0]-(e.width||0),t[1][1]-(e.height||0)]]}function wx(e,t,n,r,i=[0,0],a){let o=Cx(e,e.extent||r),s=o,c=e.parentNode||e.parentId;if(e.extent===`parent`&&!e.expandParent)if(c&&e.width&&e.height){let t=n.get(c),{x:r,y:a}=qy(t,i).positionAbsolute;s=t&&ry(r)&&ry(a)&&ry(t.width)&&ry(t.height)?[[r+e.width*i[0],a+e.height*i[1]],[r+t.width-e.width+e.width*i[0],a+t.height-e.height+e.height*i[1]]]:s}else a?.(`005`,Lv.error005()),s=o;else if(e.extent&&c&&e.extent!==`parent`){let t=n.get(c),{x:r,y:a}=qy(t,i).positionAbsolute;s=[[e.extent[0][0]+r,e.extent[0][1]+a],[e.extent[1][0]+r,e.extent[1][1]+a]]}let l={x:0,y:0};if(c){let e=n.get(c);l=qy(e,i).positionAbsolute}let u=s&&s!==`parent`?Kv(t,s):t;return{position:{x:u.x-l.x,y:u.y-l.y},positionAbsolute:u}}function Tx({nodeId:e,dragItems:t,nodeInternals:n}){let r=t.map(e=>({...n.get(e.id),position:e.position,positionAbsolute:e.positionAbsolute}));return[e?r.find(t=>t.id===e):r[0],r]}var Ex=(e,t,n,r)=>{let i=t.querySelectorAll(e);if(!i||!i.length)return null;let a=Array.from(i),o=t.getBoundingClientRect(),s={x:o.width*r[0],y:o.height*r[1]};return a.map(e=>{let t=e.getBoundingClientRect();return{id:e.getAttribute(`data-handleid`),position:e.getAttribute(`data-handlepos`),x:(t.left-o.left-s.x)/n,y:(t.top-o.top-s.y)/n,...Wv(e)}})};function Dx(e,t,n){return n===void 0?n:r=>{let i=t().nodeInternals.get(e);i&&n(r,{...i})}}function Ox({id:e,store:t,unselect:n=!1,nodeRef:r}){let{addSelectedNodes:i,unselectNodesAndEdges:a,multiSelectionActive:o,nodeInternals:s,onError:c}=t.getState(),l=s.get(e);if(!l){c?.(`012`,Lv.error012(e));return}t.setState({nodesSelectionActive:!1}),l.selected?(n||l.selected&&o)&&(a({nodes:[l],edges:[]}),requestAnimationFrame(()=>r?.current?.blur())):i([e])}function kx(){let e=zv();return(0,H.useCallback)(({sourceEvent:t})=>{let{transform:n,snapGrid:r,snapToGrid:i}=e.getState(),a=t.touches?t.touches[0].clientX:t.clientX,o=t.touches?t.touches[0].clientY:t.clientY,s={x:(a-n[0])/n[2],y:(o-n[1])/n[2]};return{xSnapped:i?r[0]*Math.round(s.x/r[0]):s.x,ySnapped:i?r[1]*Math.round(s.y/r[1]):s.y,...s}},[])}function Ax(e){return(t,n,r)=>e?.(t,r)}function jx({nodeRef:e,disabled:t=!1,noDragClassName:n,handleSelector:r,nodeId:i,isSelectable:a,selectNodesOnDrag:o}){let s=zv(),[c,l]=(0,H.useState)(!1),u=(0,H.useRef)([]),d=(0,H.useRef)({x:null,y:null}),f=(0,H.useRef)(0),p=(0,H.useRef)(null),m=(0,H.useRef)({x:0,y:0}),h=(0,H.useRef)(null),g=(0,H.useRef)(!1),_=(0,H.useRef)(!1),v=(0,H.useRef)(!1),y=kx();return(0,H.useEffect)(()=>{if(e?.current){let c=ch(e.current),b=({x:e,y:t})=>{let{nodeInternals:n,onNodeDrag:r,onSelectionDrag:a,updateNodePositions:o,nodeExtent:c,snapGrid:f,snapToGrid:p,nodeOrigin:m,onError:g}=s.getState();d.current={x:e,y:t};let _=!1,v={x:0,y:0,x2:0,y2:0};if(u.current.length>1&&c){let e=Jy(u.current,m);v=Zv(e)}if(u.current=u.current.map(r=>{let i={x:e-r.distance.x,y:t-r.distance.y};p&&(i.x=f[0]*Math.round(i.x/f[0]),i.y=f[1]*Math.round(i.y/f[1]));let a=[[c[0][0],c[0][1]],[c[1][0],c[1][1]]];u.current.length>1&&c&&!r.extent&&(a[0][0]=r.positionAbsolute.x-v.x+c[0][0],a[1][0]=r.positionAbsolute.x+(r.width??0)-v.x2+c[1][0],a[0][1]=r.positionAbsolute.y-v.y+c[0][1],a[1][1]=r.positionAbsolute.y+(r.height??0)-v.y2+c[1][1]);let o=wx(r,i,n,a,m,g);return _=_||r.position.x!==o.position.x||r.position.y!==o.position.y,r.position=o.position,r.positionAbsolute=o.positionAbsolute,r}),!_)return;o(u.current,!0,!0),l(!0);let y=i?r:Ax(a);if(y&&h.current){let[e,t]=Tx({nodeId:i,dragItems:u.current,nodeInternals:n});y(h.current,e,t)}},x=()=>{if(!p.current)return;let[e,t]=Jv(m.current,p.current);if(e!==0||t!==0){let{transform:n,panBy:r}=s.getState();d.current.x=(d.current.x??0)-e/n[2],d.current.y=(d.current.y??0)-t/n[2],r({x:e,y:t})&&b(d.current)}f.current=requestAnimationFrame(x)},S=t=>{let{nodeInternals:n,multiSelectionActive:r,nodesDraggable:c,unselectNodesAndEdges:l,onNodeDragStart:f,onSelectionDragStart:p}=s.getState();_.current=!0;let m=i?f:Ax(p);(!o||!a)&&!r&&i&&(n.get(i)?.selected||l()),i&&a&&o&&Ox({id:i,store:s,nodeRef:e});let h=y(t);if(d.current=h,u.current=Sx(n,c,h,i),m&&u.current){let[e,r]=Tx({nodeId:i,dragItems:u.current,nodeInternals:n});m(t.sourceEvent,e,r)}};if(t)c.on(`.drag`,null);else{let t=Ch().on(`start`,e=>{let{domNode:t,nodeDragThreshold:n}=s.getState();n===0&&S(e),v.current=!1,d.current=y(e),p.current=t?.getBoundingClientRect()||null,m.current=ly(e.sourceEvent,p.current)}).on(`drag`,e=>{let t=y(e),{autoPanOnNodeDrag:n,nodeDragThreshold:r}=s.getState();if(e.sourceEvent.type===`touchmove`&&e.sourceEvent.touches.length>1&&(v.current=!0),!v.current){if(!g.current&&_.current&&n&&(g.current=!0,x()),!_.current){let n=t.xSnapped-(d?.current?.x??0),i=t.ySnapped-(d?.current?.y??0);Math.sqrt(n*n+i*i)>r&&S(e)}(d.current.x!==t.xSnapped||d.current.y!==t.ySnapped)&&u.current&&_.current&&(h.current=e.sourceEvent,m.current=ly(e.sourceEvent,p.current),b(t))}}).on(`end`,e=>{if(!(!_.current||v.current)&&(l(!1),g.current=!1,_.current=!1,cancelAnimationFrame(f.current),u.current)){let{updateNodePositions:t,nodeInternals:n,onNodeDragStop:r,onSelectionDragStop:a}=s.getState(),o=i?r:Ax(a);if(t(u.current,!1,!1),o){let[t,r]=Tx({nodeId:i,dragItems:u.current,nodeInternals:n});o(e.sourceEvent,t,r)}}}).filter(t=>{let i=t.target;return!t.button&&(!n||!xx(i,`.${n}`,e))&&(!r||xx(i,r,e))});return c.call(t),()=>{c.on(`.drag`,null)}}}},[e,t,n,r,a,s,i,o,y]),c}function Mx(){let e=zv();return(0,H.useCallback)(t=>{let{nodeInternals:n,nodeExtent:r,updateNodePositions:i,getNodes:a,snapToGrid:o,snapGrid:s,onError:c,nodesDraggable:l}=e.getState(),u=a().filter(e=>e.selected&&(e.draggable||l&&e.draggable===void 0)),d=o?s[0]:5,f=o?s[1]:5,p=t.isShiftPressed?4:1,m=t.x*d*p,h=t.y*f*p,g=u.map(e=>{if(e.positionAbsolute){let t={x:e.positionAbsolute.x+m,y:e.positionAbsolute.y+h};o&&(t.x=s[0]*Math.round(t.x/s[0]),t.y=s[1]*Math.round(t.y/s[1]));let{positionAbsolute:i,position:a}=wx(e,t,n,r,void 0,c);e.position=a,e.positionAbsolute=i}return e});i(g,!0,!1)},[])}var Nx={ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}},Px=e=>{let t=({id:t,type:n,data:r,xPos:i,yPos:a,xPosOrigin:o,yPosOrigin:s,selected:c,onClick:l,onMouseEnter:u,onMouseMove:d,onMouseLeave:f,onContextMenu:p,onDoubleClick:m,style:h,className:g,isDraggable:_,isSelectable:v,isConnectable:y,isFocusable:b,selectNodesOnDrag:x,sourcePosition:S,targetPosition:C,hidden:w,resizeObserver:T,dragHandle:E,zIndex:D,isParent:O,noDragClassName:k,noPanClassName:A,initialized:j,disableKeyboardA11y:M,ariaLabel:N,rfId:P,hasHandleBounds:F})=>{let I=zv(),L=(0,H.useRef)(null),R=(0,H.useRef)(null),ee=(0,H.useRef)(S),te=(0,H.useRef)(C),ne=(0,H.useRef)(n),re=v||_||l||u||d||f,ie=Mx(),ae=Dx(t,I.getState,u),oe=Dx(t,I.getState,d),z=Dx(t,I.getState,f),se=Dx(t,I.getState,p),ce=Dx(t,I.getState,m),le=e=>{let{nodeDragThreshold:n}=I.getState();if(v&&(!x||!_||n>0)&&Ox({id:t,store:I,nodeRef:L}),l){let n=I.getState().nodeInternals.get(t);n&&l(e,{...n})}},B=e=>{if(!sy(e)&&!M)if(iy.includes(e.key)&&v){let n=e.key===`Escape`;Ox({id:t,store:I,unselect:n,nodeRef:L})}else _&&c&&Object.prototype.hasOwnProperty.call(Nx,e.key)&&(I.setState({ariaLiveMessage:`Moved selected node ${e.key.replace(`Arrow`,``).toLowerCase()}. New position, x: ${~~i}, y: ${~~a}`}),ie({x:Nx[e.key].x,y:Nx[e.key].y,isShiftPressed:e.shiftKey}))};(0,H.useEffect)(()=>()=>{R.current&&=(T?.unobserve(R.current),null)},[]),(0,H.useEffect)(()=>{if(L.current&&!w){let e=L.current;(!j||!F||R.current!==e)&&(R.current&&T?.unobserve(R.current),T?.observe(e),R.current=e)}},[w,j,F]),(0,H.useEffect)(()=>{let e=ne.current!==n,r=ee.current!==S,i=te.current!==C;L.current&&(e||r||i)&&(e&&(ne.current=n),r&&(ee.current=S),i&&(te.current=C),I.getState().updateNodeDimensions([{id:t,nodeElement:L.current,forceUpdate:!0}]))},[t,n,S,C]);let ue=jx({nodeRef:L,disabled:w||!_,noDragClassName:k,handleSelector:E,nodeId:t,isSelectable:v,selectNodesOnDrag:x});return w?null:H.createElement(`div`,{className:Vf([`react-flow__node`,`react-flow__node-${n}`,{[A]:_},g,{selected:c,selectable:v,parent:O,dragging:ue}]),ref:L,style:{zIndex:D,transform:`translate(${o}px,${s}px)`,pointerEvents:re?`all`:`none`,visibility:j?`visible`:`hidden`,...h},"data-id":t,"data-testid":`rf__node-${t}`,onMouseEnter:ae,onMouseMove:oe,onMouseLeave:z,onContextMenu:se,onClick:le,onDoubleClick:ce,onKeyDown:b?B:void 0,tabIndex:b?0:void 0,role:b?`button`:void 0,"aria-describedby":M?void 0:`${Mb}-${P}`,"aria-label":N},H.createElement(Ry,{value:t},H.createElement(e,{id:t,data:r,type:n,xPos:i,yPos:a,selected:c,isConnectable:y,sourcePosition:S,targetPosition:C,dragging:ue,dragHandle:E,zIndex:D})))};return t.displayName=`NodeWrapper`,(0,H.memo)(t)},Fx=e=>{let t=e.getNodes().filter(e=>e.selected);return{...Jy(t,e.nodeOrigin),transformString:`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`,userSelectionActive:e.userSelectionActive}};function Ix({onSelectionContextMenu:e,noPanClassName:t,disableKeyboardA11y:n}){let r=zv(),{width:i,height:a,x:o,y:s,transformString:c,userSelectionActive:l}=X(Fx,tp),u=Mx(),d=(0,H.useRef)(null);if((0,H.useEffect)(()=>{n||d.current?.focus({preventScroll:!0})},[n]),jx({nodeRef:d}),l||!i||!a)return null;let f=e?t=>{let n=r.getState().getNodes().filter(e=>e.selected);e(t,n)}:void 0;return H.createElement(`div`,{className:Vf([`react-flow__nodesselection`,`react-flow__container`,t]),style:{transform:c}},H.createElement(`div`,{ref:d,className:`react-flow__nodesselection-rect`,onContextMenu:f,tabIndex:n?void 0:-1,onKeyDown:n?void 0:e=>{Object.prototype.hasOwnProperty.call(Nx,e.key)&&u({x:Nx[e.key].x,y:Nx[e.key].y,isShiftPressed:e.shiftKey})},style:{width:i,height:a,top:s,left:o}}))}var Lx=(0,H.memo)(Ix),Rx=e=>e.nodesSelectionActive,zx=({children:e,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:r,onPaneMouseLeave:i,onPaneContextMenu:a,onPaneScroll:o,deleteKeyCode:s,onMove:c,onMoveStart:l,onMoveEnd:u,selectionKeyCode:d,selectionOnDrag:f,selectionMode:p,onSelectionStart:m,onSelectionEnd:h,multiSelectionKeyCode:g,panActivationKeyCode:_,zoomActivationKeyCode:v,elementsSelectable:y,zoomOnScroll:b,zoomOnPinch:x,panOnScroll:S,panOnScrollSpeed:C,panOnScrollMode:w,zoomOnDoubleClick:T,panOnDrag:E,defaultViewport:D,translateExtent:O,minZoom:k,maxZoom:A,preventScrolling:j,onSelectionContextMenu:M,noWheelClassName:N,noPanClassName:P,disableKeyboardA11y:F})=>{let I=X(Rx),L=Rb(d),R=Rb(_),ee=R||E,te=R||S,ne=L||f&&ee!==!0;return ex({deleteKeyCode:s,multiSelectionKeyCode:g}),H.createElement(lx,{onMove:c,onMoveStart:l,onMoveEnd:u,onPaneContextMenu:a,elementsSelectable:y,zoomOnScroll:b,zoomOnPinch:x,panOnScroll:te,panOnScrollSpeed:C,panOnScrollMode:w,zoomOnDoubleClick:T,panOnDrag:!L&&ee,defaultViewport:D,translateExtent:O,minZoom:k,maxZoom:A,zoomActivationKeyCode:v,preventScrolling:j,noWheelClassName:N,noPanClassName:P},H.createElement(yx,{onSelectionStart:m,onSelectionEnd:h,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:r,onPaneMouseLeave:i,onPaneContextMenu:a,onPaneScroll:o,panOnDrag:ee,isSelecting:!!ne,selectionMode:p},e,I&&H.createElement(Lx,{onSelectionContextMenu:M,noPanClassName:P,disableKeyboardA11y:F})))};zx.displayName=`FlowRenderer`;var Bx=(0,H.memo)(zx);function Vx(e){return X((0,H.useCallback)(t=>e?Yy(t.nodeInternals,{x:0,y:0,width:t.width,height:t.height},t.transform,!0):t.getNodes(),[e]))}function Hx(e){let t={input:Px(e.input||_b),default:Px(e.default||hb),output:Px(e.output||yb),group:Px(e.group||bb)},n=Object.keys(e).filter(e=>![`input`,`default`,`output`,`group`].includes(e)).reduce((t,n)=>(t[n]=Px(e[n]||hb),t),{});return{...t,...n}}var Ux=({x:e,y:t,width:n,height:r,origin:i})=>!n||!r||i[0]<0||i[1]<0||i[0]>1||i[1]>1?{x:e,y:t}:{x:e-n*i[0],y:t-r*i[1]},Wx=e=>({nodesDraggable:e.nodesDraggable,nodesConnectable:e.nodesConnectable,nodesFocusable:e.nodesFocusable,elementsSelectable:e.elementsSelectable,updateNodeDimensions:e.updateNodeDimensions,onError:e.onError}),Gx=e=>{let{nodesDraggable:t,nodesConnectable:n,nodesFocusable:r,elementsSelectable:i,updateNodeDimensions:a,onError:o}=X(Wx,tp),s=Vx(e.onlyRenderVisibleElements),c=(0,H.useRef)(),l=(0,H.useMemo)(()=>{if(typeof ResizeObserver>`u`)return null;let e=new ResizeObserver(e=>{let t=e.map(e=>({id:e.target.getAttribute(`data-id`),nodeElement:e.target,forceUpdate:!0}));a(t)});return c.current=e,e},[]);return(0,H.useEffect)(()=>()=>{c?.current?.disconnect()},[]),H.createElement(`div`,{className:`react-flow__nodes`,style:nx},s.map(a=>{let s=a.type||`default`;e.nodeTypes[s]||(o?.(`003`,Lv.error003(s)),s=`default`);let c=e.nodeTypes[s]||e.nodeTypes.default,u=!!(a.draggable||t&&a.draggable===void 0),d=!!(a.selectable||i&&a.selectable===void 0),f=!!(a.connectable||n&&a.connectable===void 0),p=!!(a.focusable||r&&a.focusable===void 0),m=e.nodeExtent?Kv(a.positionAbsolute,e.nodeExtent):a.positionAbsolute,h=m?.x??0,g=m?.y??0,_=Ux({x:h,y:g,width:a.width??0,height:a.height??0,origin:e.nodeOrigin});return H.createElement(c,{key:a.id,id:a.id,className:a.className,style:a.style,type:s,data:a.data,sourcePosition:a.sourcePosition||Q.Bottom,targetPosition:a.targetPosition||Q.Top,hidden:a.hidden,xPos:h,yPos:g,xPosOrigin:_.x,yPosOrigin:_.y,selectNodesOnDrag:e.selectNodesOnDrag,onClick:e.onNodeClick,onMouseEnter:e.onNodeMouseEnter,onMouseMove:e.onNodeMouseMove,onMouseLeave:e.onNodeMouseLeave,onContextMenu:e.onNodeContextMenu,onDoubleClick:e.onNodeDoubleClick,selected:!!a.selected,isDraggable:u,isSelectable:d,isConnectable:f,isFocusable:p,resizeObserver:l,dragHandle:a.dragHandle,zIndex:a[Z]?.z??0,isParent:!!a[Z]?.isParent,noDragClassName:e.noDragClassName,noPanClassName:e.noPanClassName,initialized:!!a.width&&!!a.height,rfId:e.rfId,disableKeyboardA11y:e.disableKeyboardA11y,ariaLabel:a.ariaLabel,hasHandleBounds:!!a[Z]?.handleBounds})}))};Gx.displayName=`NodeRenderer`;var Kx=(0,H.memo)(Gx),qx=(e,t,n)=>n===Q.Left?e-t:n===Q.Right?e+t:e,Jx=(e,t,n)=>n===Q.Top?e-t:n===Q.Bottom?e+t:e,Yx=`react-flow__edgeupdater`,Xx=({position:e,centerX:t,centerY:n,radius:r=10,onMouseDown:i,onMouseEnter:a,onMouseOut:o,type:s})=>H.createElement(`circle`,{onMouseDown:i,onMouseEnter:a,onMouseOut:o,className:Vf([Yx,`${Yx}-${s}`]),cx:qx(t,r,e),cy:Jx(n,r,e),r,stroke:`transparent`,fill:`transparent`}),Zx=()=>!0,Qx=e=>{let t=({id:t,className:n,type:r,data:i,onClick:a,onEdgeDoubleClick:o,selected:s,animated:c,label:l,labelStyle:u,labelShowBg:d,labelBgStyle:f,labelBgPadding:p,labelBgBorderRadius:m,style:h,source:g,target:_,sourceX:v,sourceY:y,targetX:b,targetY:x,sourcePosition:S,targetPosition:C,elementsSelectable:w,hidden:T,sourceHandleId:E,targetHandleId:D,onContextMenu:O,onMouseEnter:k,onMouseMove:A,onMouseLeave:j,reconnectRadius:M,onReconnect:N,onReconnectStart:P,onReconnectEnd:F,markerEnd:I,markerStart:L,rfId:R,ariaLabel:ee,isFocusable:te,isReconnectable:ne,pathOptions:re,interactionWidth:ie,disableKeyboardA11y:ae})=>{let oe=(0,H.useRef)(null),[z,se]=(0,H.useState)(!1),[ce,le]=(0,H.useState)(!1),B=zv(),ue=(0,H.useMemo)(()=>`url('#${Hy(L,R)}')`,[L,R]),de=(0,H.useMemo)(()=>`url('#${Hy(I,R)}')`,[I,R]);if(T)return null;let fe=e=>{let{edges:n,addSelectedEdges:r,unselectNodesAndEdges:i,multiSelectionActive:o}=B.getState(),s=n.find(e=>e.id===t);s&&(w&&(B.setState({nodesSelectionActive:!1}),s.selected&&o?(i({nodes:[],edges:[s]}),oe.current?.blur()):r([t])),a&&a(e,s))},V=fy(t,B.getState,o),pe=fy(t,B.getState,O),me=fy(t,B.getState,k),he=fy(t,B.getState,A),ge=fy(t,B.getState,j),_e=(e,n)=>{if(e.button!==0)return;let{edges:r,isValidConnection:i}=B.getState(),a=n?_:g,o=(n?D:E)||null,s=n?`target`:`source`,c=i||Zx,l=n,u=r.find(e=>e.id===t);le(!0),P?.(e,u,s),cb({event:e,handleId:o,nodeId:a,onConnect:e=>N?.(u,e),isTarget:l,getState:B.getState,setState:B.setState,isValidConnection:c,edgeUpdaterType:s,onReconnectEnd:e=>{le(!1),F?.(e,u,s)}})},ve=e=>_e(e,!0),ye=e=>_e(e,!1),be=()=>se(!0),xe=()=>se(!1),Se=!w&&!a;return H.createElement(`g`,{className:Vf([`react-flow__edge`,`react-flow__edge-${r}`,n,{selected:s,animated:c,inactive:Se,updating:z}]),onClick:fe,onDoubleClick:V,onContextMenu:pe,onMouseEnter:me,onMouseMove:he,onMouseLeave:ge,onKeyDown:te?e=>{if(!ae&&iy.includes(e.key)&&w){let{unselectNodesAndEdges:n,addSelectedEdges:r,edges:i}=B.getState();e.key===`Escape`?(oe.current?.blur(),n({edges:[i.find(e=>e.id===t)]})):r([t])}}:void 0,tabIndex:te?0:void 0,role:te?`button`:`img`,"data-testid":`rf__edge-${t}`,"aria-label":ee===null?void 0:ee||`Edge from ${g} to ${_}`,"aria-describedby":te?`${Nb}-${R}`:void 0,ref:oe},!ce&&H.createElement(e,{id:t,source:g,target:_,selected:s,animated:c,label:l,labelStyle:u,labelShowBg:d,labelBgStyle:f,labelBgPadding:p,labelBgBorderRadius:m,data:i,style:h,sourceX:v,sourceY:y,targetX:b,targetY:x,sourcePosition:S,targetPosition:C,sourceHandleId:E,targetHandleId:D,markerStart:ue,markerEnd:de,pathOptions:re,interactionWidth:ie}),ne&&H.createElement(H.Fragment,null,(ne===`source`||ne===!0)&&H.createElement(Xx,{position:S,centerX:v,centerY:y,radius:M,onMouseDown:ve,onMouseEnter:be,onMouseOut:xe,type:`source`}),(ne===`target`||ne===!0)&&H.createElement(Xx,{position:C,centerX:b,centerY:x,radius:M,onMouseDown:ye,onMouseEnter:be,onMouseOut:xe,type:`target`})))};return t.displayName=`EdgeWrapper`,(0,H.memo)(t)};function $x(e){let t={default:Qx(e.default||Iy),straight:Qx(e.bezier||My),step:Qx(e.step||Ay),smoothstep:Qx(e.step||ky),simplebezier:Qx(e.simplebezier||Sy)},n=Object.keys(e).filter(e=>![`default`,`bezier`].includes(e)).reduce((t,n)=>(t[n]=Qx(e[n]||Iy),t),{});return{...t,...n}}function eS(e,t,n=null){let r=(n?.x||0)+t.x,i=(n?.y||0)+t.y,a=n?.width||t.width,o=n?.height||t.height;switch(e){case Q.Top:return{x:r+a/2,y:i};case Q.Right:return{x:r+a,y:i+o/2};case Q.Bottom:return{x:r+a/2,y:i+o};case Q.Left:return{x:r,y:i+o/2}}}function tS(e,t){return e?e.length===1||!t?e[0]:t&&e.find(e=>e.id===t)||null:null}var nS=(e,t,n,r,i,a)=>{let o=eS(n,e,t),s=eS(a,r,i);return{sourceX:o.x,sourceY:o.y,targetX:s.x,targetY:s.y}};function rS({sourcePos:e,targetPos:t,sourceWidth:n,sourceHeight:r,targetWidth:i,targetHeight:a,width:o,height:s,transform:c}){let l={x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x+n,t.x+i),y2:Math.max(e.y+r,t.y+a)};l.x===l.x2&&(l.x2+=1),l.y===l.y2&&(l.y2+=1);let u=Zv({x:(0-c[0])/c[2],y:(0-c[1])/c[2],width:o/c[2],height:s/c[2]}),d=Math.max(0,Math.min(u.x2,l.x2)-Math.max(u.x,l.x)),f=Math.max(0,Math.min(u.y2,l.y2)-Math.max(u.y,l.y));return Math.ceil(d*f)>0}function iS(e){let t=e?.[Z]?.handleBounds||null,n=t&&e?.width&&e?.height&&e?.positionAbsolute?.x!==void 0&&e?.positionAbsolute?.y!==void 0;return[{x:e?.positionAbsolute?.x||0,y:e?.positionAbsolute?.y||0,width:e?.width||0,height:e?.height||0},t,!!n]}var aS=[{level:0,isMaxLevel:!0,edges:[]}];function oS(e,t,n=!1){let r=-1,i=e.reduce((e,i)=>{let a=ry(i.zIndex),o=a?i.zIndex:0;if(n){let e=t.get(i.target),n=t.get(i.source),r=i.selected||e?.selected||n?.selected,s=Math.max(n?.[Z]?.z||0,e?.[Z]?.z||0,1e3);o=(a?i.zIndex:0)+(r?s:0)}return e[o]?e[o].push(i):e[o]=[i],r=o>r?o:r,e},{}),a=Object.entries(i).map(([e,t])=>{let n=+e;return{edges:t,level:n,isMaxLevel:n===r}});return a.length===0?aS:a}function sS(e,t,n){let r=X((0,H.useCallback)(n=>e?n.edges.filter(e=>{let r=t.get(e.source),i=t.get(e.target);return r?.width&&r?.height&&i?.width&&i?.height&&rS({sourcePos:r.positionAbsolute||{x:0,y:0},targetPos:i.positionAbsolute||{x:0,y:0},sourceWidth:r.width,sourceHeight:r.height,targetWidth:i.width,targetHeight:i.height,width:n.width,height:n.height,transform:n.transform})}):n.edges,[e,t]));return oS(r,t,n)}var cS=({color:e=`none`,strokeWidth:t=1})=>H.createElement(`polyline`,{style:{stroke:e,strokeWidth:t},strokeLinecap:`round`,strokeLinejoin:`round`,fill:`none`,points:`-5,-4 0,0 -5,4`}),lS=({color:e=`none`,strokeWidth:t=1})=>H.createElement(`polyline`,{style:{stroke:e,fill:e,strokeWidth:t},strokeLinecap:`round`,strokeLinejoin:`round`,points:`-5,-4 0,0 -5,4 -5,-4`}),uS={[yy.Arrow]:cS,[yy.ArrowClosed]:lS};function dS(e){let t=zv();return(0,H.useMemo)(()=>Object.prototype.hasOwnProperty.call(uS,e)?uS[e]:(t.getState().onError?.(`009`,Lv.error009(e)),null),[e])}var fS=({id:e,type:t,color:n,width:r=12.5,height:i=12.5,markerUnits:a=`strokeWidth`,strokeWidth:o,orient:s=`auto-start-reverse`})=>{let c=dS(t);return c?H.createElement(`marker`,{className:`react-flow__arrowhead`,id:e,markerWidth:`${r}`,markerHeight:`${i}`,viewBox:`-10 -10 20 20`,markerUnits:a,orient:s,refX:`0`,refY:`0`},H.createElement(c,{color:n,strokeWidth:o})):null},pS=({defaultColor:e,rfId:t})=>n=>{let r=[];return n.edges.reduce((n,i)=>([i.markerStart,i.markerEnd].forEach(i=>{if(i&&typeof i==`object`){let a=Hy(i,t);r.includes(a)||(n.push({id:a,color:i.color||e,...i}),r.push(a))}}),n),[]).sort((e,t)=>e.id.localeCompare(t.id))},mS=({defaultColor:e,rfId:t})=>{let n=X((0,H.useCallback)(pS({defaultColor:e,rfId:t}),[e,t]),(e,t)=>!(e.length!==t.length||e.some((e,n)=>e.id!==t[n].id)));return H.createElement(`defs`,null,n.map(e=>H.createElement(fS,{id:e.id,key:e.id,type:e.type,color:e.color,width:e.width,height:e.height,markerUnits:e.markerUnits,strokeWidth:e.strokeWidth,orient:e.orient})))};mS.displayName=`MarkerDefinitions`;var hS=(0,H.memo)(mS),gS=e=>({nodesConnectable:e.nodesConnectable,edgesFocusable:e.edgesFocusable,edgesUpdatable:e.edgesUpdatable,elementsSelectable:e.elementsSelectable,width:e.width,height:e.height,connectionMode:e.connectionMode,nodeInternals:e.nodeInternals,onError:e.onError}),_S=({defaultMarkerColor:e,onlyRenderVisibleElements:t,elevateEdgesOnSelect:n,rfId:r,edgeTypes:i,noPanClassName:a,onEdgeContextMenu:o,onEdgeMouseEnter:s,onEdgeMouseMove:c,onEdgeMouseLeave:l,onEdgeClick:u,onEdgeDoubleClick:d,onReconnect:f,onReconnectStart:p,onReconnectEnd:m,reconnectRadius:h,children:g,disableKeyboardA11y:_})=>{let{edgesFocusable:v,edgesUpdatable:y,elementsSelectable:b,width:x,height:S,connectionMode:C,nodeInternals:w,onError:T}=X(gS,tp),E=sS(t,w,n);return x?H.createElement(H.Fragment,null,E.map(({level:t,edges:n,isMaxLevel:g})=>H.createElement(`svg`,{key:t,style:{zIndex:t},width:x,height:S,className:`react-flow__edges react-flow__container`},g&&H.createElement(hS,{defaultColor:e,rfId:r}),H.createElement(`g`,null,n.map(e=>{let[t,n,g]=iS(w.get(e.source)),[x,S,E]=iS(w.get(e.target));if(!g||!E)return null;let D=e.type||`default`;i[D]||(T?.(`011`,Lv.error011(D)),D=`default`);let O=i[D]||i.default,k=C===hy.Strict?S.target:(S.target??[]).concat(S.source??[]),A=tS(n.source,e.sourceHandle),j=tS(k,e.targetHandle),M=A?.position||Q.Bottom,N=j?.position||Q.Top,P=!!(e.focusable||v&&e.focusable===void 0),F=e.reconnectable||e.updatable,I=f!==void 0&&(F||y&&F===void 0);if(!A||!j)return T?.(`008`,Lv.error008(A,e)),null;let{sourceX:L,sourceY:R,targetX:ee,targetY:te}=nS(t,A,M,x,j,N);return H.createElement(O,{key:e.id,id:e.id,className:Vf([e.className,a]),type:D,data:e.data,selected:!!e.selected,animated:!!e.animated,hidden:!!e.hidden,label:e.label,labelStyle:e.labelStyle,labelShowBg:e.labelShowBg,labelBgStyle:e.labelBgStyle,labelBgPadding:e.labelBgPadding,labelBgBorderRadius:e.labelBgBorderRadius,style:e.style,source:e.source,target:e.target,sourceHandleId:e.sourceHandle,targetHandleId:e.targetHandle,markerEnd:e.markerEnd,markerStart:e.markerStart,sourceX:L,sourceY:R,targetX:ee,targetY:te,sourcePosition:M,targetPosition:N,elementsSelectable:b,onContextMenu:o,onMouseEnter:s,onMouseMove:c,onMouseLeave:l,onClick:u,onEdgeDoubleClick:d,onReconnect:f,onReconnectStart:p,onReconnectEnd:m,reconnectRadius:h,rfId:r,ariaLabel:e.ariaLabel,isFocusable:P,isReconnectable:I,pathOptions:`pathOptions`in e?e.pathOptions:void 0,interactionWidth:e.interactionWidth,disableKeyboardA11y:_})})))),g):null};_S.displayName=`EdgeRenderer`;var vS=(0,H.memo)(_S),yS=e=>`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`;function bS({children:e}){let t=X(yS);return H.createElement(`div`,{className:`react-flow__viewport react-flow__container`,style:{transform:t}},e)}function xS(e){let t=Qb(),n=(0,H.useRef)(!1);(0,H.useEffect)(()=>{!n.current&&t.viewportInitialized&&e&&(setTimeout(()=>e(t),1),n.current=!0)},[e,t.viewportInitialized])}var SS={[Q.Left]:Q.Right,[Q.Right]:Q.Left,[Q.Top]:Q.Bottom,[Q.Bottom]:Q.Top},CS=({nodeId:e,handleType:t,style:n,type:r=vy.Bezier,CustomComponent:i,connectionStatus:a})=>{let{fromNode:o,handleId:s,toX:c,toY:l,connectionMode:u}=X((0,H.useCallback)(t=>({fromNode:t.nodeInternals.get(e),handleId:t.connectionHandleId,toX:(t.connectionPosition.x-t.transform[0])/t.transform[2],toY:(t.connectionPosition.y-t.transform[1])/t.transform[2],connectionMode:t.connectionMode}),[e]),tp),d=o?.[Z]?.handleBounds,f=d?.[t];if(u===hy.Loose&&(f||=d?.[t===`source`?`target`:`source`]),!o||!f)return null;let p=s?f.find(e=>e.id===s):f[0],m=p?p.x+p.width/2:(o.width??0)/2,h=p?p.y+p.height/2:o.height??0,g=(o.positionAbsolute?.x??0)+m,_=(o.positionAbsolute?.y??0)+h,v=p?.position,y=v?SS[v]:null;if(!v||!y)return null;if(i)return H.createElement(i,{connectionLineType:r,connectionLineStyle:n,fromNode:o,fromHandle:p,fromX:g,fromY:_,toX:c,toY:l,fromPosition:v,toPosition:y,connectionStatus:a});let b=``,x={sourceX:g,sourceY:_,sourcePosition:v,targetX:c,targetY:l,targetPosition:y};return r===vy.Bezier?[b]=Fy(x):r===vy.Step?[b]=Oy({...x,borderRadius:0}):r===vy.SmoothStep?[b]=Oy(x):r===vy.SimpleBezier?[b]=xy(x):b=`M${g},${_} ${c},${l}`,H.createElement(`path`,{d:b,fill:`none`,className:`react-flow__connection-path`,style:n})};CS.displayName=`ConnectionLine`;var wS=e=>({nodeId:e.connectionNodeId,handleType:e.connectionHandleType,nodesConnectable:e.nodesConnectable,connectionStatus:e.connectionStatus,width:e.width,height:e.height});function TS({containerStyle:e,style:t,type:n,component:r}){let{nodeId:i,handleType:a,nodesConnectable:o,width:s,height:c,connectionStatus:l}=X(wS,tp);return i&&a&&s&&o?H.createElement(`svg`,{style:e,width:s,height:c,className:`react-flow__edges react-flow__connectionline react-flow__container`},H.createElement(`g`,{className:Vf([`react-flow__connection`,l])},H.createElement(CS,{nodeId:i,handleType:a,style:t,type:n,CustomComponent:r,connectionStatus:l}))):null}function ES(e,t){return(0,H.useRef)(null),zv(),(0,H.useMemo)(()=>t(e),[e])}var DS=({nodeTypes:e,edgeTypes:t,onMove:n,onMoveStart:r,onMoveEnd:i,onInit:a,onNodeClick:o,onEdgeClick:s,onNodeDoubleClick:c,onEdgeDoubleClick:l,onNodeMouseEnter:u,onNodeMouseMove:d,onNodeMouseLeave:f,onNodeContextMenu:p,onSelectionContextMenu:m,onSelectionStart:h,onSelectionEnd:g,connectionLineType:_,connectionLineStyle:v,connectionLineComponent:y,connectionLineContainerStyle:b,selectionKeyCode:x,selectionOnDrag:S,selectionMode:C,multiSelectionKeyCode:w,panActivationKeyCode:T,zoomActivationKeyCode:E,deleteKeyCode:D,onlyRenderVisibleElements:O,elementsSelectable:k,selectNodesOnDrag:A,defaultViewport:j,translateExtent:M,minZoom:N,maxZoom:P,preventScrolling:F,defaultMarkerColor:I,zoomOnScroll:L,zoomOnPinch:R,panOnScroll:ee,panOnScrollSpeed:te,panOnScrollMode:ne,zoomOnDoubleClick:re,panOnDrag:ie,onPaneClick:ae,onPaneMouseEnter:oe,onPaneMouseMove:z,onPaneMouseLeave:se,onPaneScroll:ce,onPaneContextMenu:le,onEdgeContextMenu:B,onEdgeMouseEnter:ue,onEdgeMouseMove:de,onEdgeMouseLeave:fe,onReconnect:V,onReconnectStart:pe,onReconnectEnd:me,reconnectRadius:he,noDragClassName:ge,noWheelClassName:_e,noPanClassName:ve,elevateEdgesOnSelect:ye,disableKeyboardA11y:be,nodeOrigin:xe,nodeExtent:Se,rfId:Ce})=>{let we=ES(e,Hx),Te=ES(t,$x);return xS(a),H.createElement(Bx,{onPaneClick:ae,onPaneMouseEnter:oe,onPaneMouseMove:z,onPaneMouseLeave:se,onPaneContextMenu:le,onPaneScroll:ce,deleteKeyCode:D,selectionKeyCode:x,selectionOnDrag:S,selectionMode:C,onSelectionStart:h,onSelectionEnd:g,multiSelectionKeyCode:w,panActivationKeyCode:T,zoomActivationKeyCode:E,elementsSelectable:k,onMove:n,onMoveStart:r,onMoveEnd:i,zoomOnScroll:L,zoomOnPinch:R,zoomOnDoubleClick:re,panOnScroll:ee,panOnScrollSpeed:te,panOnScrollMode:ne,panOnDrag:ie,defaultViewport:j,translateExtent:M,minZoom:N,maxZoom:P,onSelectionContextMenu:m,preventScrolling:F,noDragClassName:ge,noWheelClassName:_e,noPanClassName:ve,disableKeyboardA11y:be},H.createElement(bS,null,H.createElement(vS,{edgeTypes:Te,onEdgeClick:s,onEdgeDoubleClick:l,onlyRenderVisibleElements:O,onEdgeContextMenu:B,onEdgeMouseEnter:ue,onEdgeMouseMove:de,onEdgeMouseLeave:fe,onReconnect:V,onReconnectStart:pe,onReconnectEnd:me,reconnectRadius:he,defaultMarkerColor:I,noPanClassName:ve,elevateEdgesOnSelect:!!ye,disableKeyboardA11y:be,rfId:Ce},H.createElement(TS,{style:v,type:_,component:y,containerStyle:b})),H.createElement(`div`,{className:`react-flow__edgelabel-renderer`}),H.createElement(Kx,{nodeTypes:we,onNodeClick:o,onNodeDoubleClick:c,onNodeMouseEnter:u,onNodeMouseMove:d,onNodeMouseLeave:f,onNodeContextMenu:p,selectNodesOnDrag:A,onlyRenderVisibleElements:O,noPanClassName:ve,noDragClassName:ge,disableKeyboardA11y:be,nodeOrigin:xe,nodeExtent:Se,rfId:Ce})))};DS.displayName=`GraphView`;var OS=(0,H.memo)(DS),kS=[[-1/0,-1/0],[1/0,1/0]],AS={rfId:`1`,width:0,height:0,transform:[0,0,1],nodeInternals:new Map,edges:[],onNodesChange:null,onEdgesChange:null,hasDefaultNodes:!1,hasDefaultEdges:!1,d3Zoom:null,d3Selection:null,d3ZoomHandler:void 0,minZoom:.5,maxZoom:2,translateExtent:kS,nodeExtent:kS,nodesSelectionActive:!1,userSelectionActive:!1,userSelectionRect:null,connectionNodeId:null,connectionHandleId:null,connectionHandleType:`source`,connectionPosition:{x:0,y:0},connectionStatus:null,connectionMode:hy.Strict,domNode:null,paneDragging:!1,noPanClassName:`nopan`,nodeOrigin:[0,0],nodeDragThreshold:0,snapGrid:[15,15],snapToGrid:!1,nodesDraggable:!0,nodesConnectable:!0,nodesFocusable:!0,edgesFocusable:!0,edgesUpdatable:!0,elementsSelectable:!0,elevateNodesOnSelect:!0,fitViewOnInit:!1,fitViewOnInitDone:!1,fitViewOnInitOptions:void 0,onSelectionChange:[],multiSelectionActive:!1,connectionStartHandle:null,connectionEndHandle:null,connectionClickStartHandle:null,connectOnClick:!0,ariaLiveMessage:``,autoPanOnConnect:!0,autoPanOnNodeDrag:!0,connectionRadius:20,onError:ay,isValidConnection:void 0},jS=()=>ep((e,t)=>({...AS,setNodes:n=>{let{nodeInternals:r,nodeOrigin:i,elevateNodesOnSelect:a}=t();e({nodeInternals:Ub(n,r,i,a)})},getNodes:()=>Array.from(t().nodeInternals.values()),setEdges:n=>{let{defaultEdgeOptions:r={}}=t();e({edges:n.map(e=>({...r,...e}))})},setDefaultNodesAndEdges:(n,r)=>{let i=n!==void 0,a=r!==void 0,o=i?Ub(n,new Map,t().nodeOrigin,t().elevateNodesOnSelect):new Map;e({nodeInternals:o,edges:a?r:[],hasDefaultNodes:i,hasDefaultEdges:a})},updateNodeDimensions:n=>{let{onNodesChange:r,nodeInternals:i,fitViewOnInit:a,fitViewOnInitDone:o,fitViewOnInitOptions:s,domNode:c,nodeOrigin:l}=t(),u=c?.querySelector(`.react-flow__viewport`);if(!u)return;let d=window.getComputedStyle(u),{m22:f}=new window.DOMMatrixReadOnly(d.transform),p=n.reduce((e,t)=>{let n=i.get(t.id);if(n?.hidden)i.set(n.id,{...n,[Z]:{...n[Z],handleBounds:void 0}});else if(n){let r=Wv(t.nodeElement);r.width&&r.height&&(n.width!==r.width||n.height!==r.height||t.forceUpdate)&&(i.set(n.id,{...n,[Z]:{...n[Z],handleBounds:{source:Ex(`.source`,t.nodeElement,f,l),target:Ex(`.target`,t.nodeElement,f,l)}},...r}),e.push({id:n.id,type:`dimensions`,dimensions:r}))}return e},[]);Hb(i,l);let m=o||a&&!o&&Wb(t,{initial:!0,...s});e({nodeInternals:new Map(i),fitViewOnInitDone:m}),p?.length>0&&r?.(p)},updateNodePositions:(e,n=!0,r=!1)=>{let{triggerNodeChanges:i}=t(),a=e.map(e=>{let t={id:e.id,type:`position`,dragging:r};return n&&(t.positionAbsolute=e.positionAbsolute,t.position=e.position),t});i(a)},triggerNodeChanges:n=>{let{onNodesChange:r,nodeInternals:i,hasDefaultNodes:a,nodeOrigin:o,getNodes:s,elevateNodesOnSelect:c}=t();if(n?.length){if(a){let t=mx(n,s()),r=Ub(t,i,o,c);e({nodeInternals:r})}r?.(n)}},addSelectedNodes:n=>{let{multiSelectionActive:r,edges:i,getNodes:a}=t(),o,s=null;r?o=n.map(e=>hx(e,!0)):(o=gx(a(),n),s=gx(i,[])),qb({changedNodes:o,changedEdges:s,get:t,set:e})},addSelectedEdges:n=>{let{multiSelectionActive:r,edges:i,getNodes:a}=t(),o,s=null;r?o=n.map(e=>hx(e,!0)):(o=gx(i,n),s=gx(a(),[])),qb({changedNodes:s,changedEdges:o,get:t,set:e})},unselectNodesAndEdges:({nodes:n,edges:r}={})=>{let{edges:i,getNodes:a}=t(),o=n||a(),s=r||i,c=o.map(e=>(e.selected=!1,hx(e.id,!1))),l=s.map(e=>hx(e.id,!1));qb({changedNodes:c,changedEdges:l,get:t,set:e})},setMinZoom:n=>{let{d3Zoom:r,maxZoom:i}=t();r?.scaleExtent([n,i]),e({minZoom:n})},setMaxZoom:n=>{let{d3Zoom:r,minZoom:i}=t();r?.scaleExtent([i,n]),e({maxZoom:n})},setTranslateExtent:n=>{t().d3Zoom?.translateExtent(n),e({translateExtent:n})},resetSelectedElements:()=>{let{edges:n,getNodes:r}=t(),i=r().filter(e=>e.selected).map(e=>hx(e.id,!1)),a=n.filter(e=>e.selected).map(e=>hx(e.id,!1));qb({changedNodes:i,changedEdges:a,get:t,set:e})},setNodeExtent:n=>{let{nodeInternals:r}=t();r.forEach(e=>{e.positionAbsolute=Kv(e.position,n)}),e({nodeExtent:n,nodeInternals:new Map(r)})},panBy:e=>{let{transform:n,width:r,height:i,d3Zoom:a,d3Selection:o,translateExtent:s}=t();if(!a||!o||!e.x&&!e.y)return!1;let c=wv.translate(n[0]+e.x,n[1]+e.y).scale(n[2]),l=[[0,0],[r,i]],u=a?.constrain()(c,l,s);return a.transform(o,u),n[0]!==u.x||n[1]!==u.y||n[2]!==u.k},cancelConnection:()=>e({connectionNodeId:AS.connectionNodeId,connectionHandleId:AS.connectionHandleId,connectionHandleType:AS.connectionHandleType,connectionStatus:AS.connectionStatus,connectionStartHandle:AS.connectionStartHandle,connectionEndHandle:AS.connectionEndHandle}),reset:()=>e({...AS})}),Object.is),MS=({children:e})=>{let t=(0,H.useRef)(null);return t.current||=jS(),H.createElement(Iv,{value:t.current},e)};MS.displayName=`ReactFlowProvider`;var NS=({children:e})=>(0,H.useContext)(Fv)?H.createElement(H.Fragment,null,e):H.createElement(MS,null,e);NS.displayName=`ReactFlowWrapper`;var PS={input:_b,default:hb,output:yb,group:bb},FS={default:Iy,straight:My,step:Ay,smoothstep:ky,simplebezier:Sy},IS=[0,0],LS=[15,15],RS={x:0,y:0,zoom:1},zS={width:`100%`,height:`100%`,overflow:`hidden`,position:`relative`,zIndex:0},BS=(0,H.forwardRef)(({nodes:e,edges:t,defaultNodes:n,defaultEdges:r,className:i,nodeTypes:a=PS,edgeTypes:o=FS,onNodeClick:s,onEdgeClick:c,onInit:l,onMove:u,onMoveStart:d,onMoveEnd:f,onConnect:p,onConnectStart:m,onConnectEnd:h,onClickConnectStart:g,onClickConnectEnd:_,onNodeMouseEnter:v,onNodeMouseMove:y,onNodeMouseLeave:b,onNodeContextMenu:x,onNodeDoubleClick:S,onNodeDragStart:C,onNodeDrag:w,onNodeDragStop:T,onNodesDelete:E,onEdgesDelete:D,onSelectionChange:O,onSelectionDragStart:k,onSelectionDrag:A,onSelectionDragStop:j,onSelectionContextMenu:M,onSelectionStart:N,onSelectionEnd:P,connectionMode:F=hy.Strict,connectionLineType:I=vy.Bezier,connectionLineStyle:L,connectionLineComponent:R,connectionLineContainerStyle:ee,deleteKeyCode:te=`Backspace`,selectionKeyCode:ne=`Shift`,selectionOnDrag:re=!1,selectionMode:ie=_y.Full,panActivationKeyCode:ae=`Space`,multiSelectionKeyCode:oe=uy()?`Meta`:`Control`,zoomActivationKeyCode:z=uy()?`Meta`:`Control`,snapToGrid:se=!1,snapGrid:ce=LS,onlyRenderVisibleElements:le=!1,selectNodesOnDrag:B=!0,nodesDraggable:ue,nodesConnectable:de,nodesFocusable:fe,nodeOrigin:V=IS,edgesFocusable:pe,edgesUpdatable:me,elementsSelectable:he,defaultViewport:ge=RS,minZoom:_e=.5,maxZoom:ve=2,translateExtent:ye=kS,preventScrolling:be=!0,nodeExtent:xe,defaultMarkerColor:Se=`#b1b1b7`,zoomOnScroll:Ce=!0,zoomOnPinch:we=!0,panOnScroll:Te=!1,panOnScrollSpeed:Ee=.5,panOnScrollMode:De=gy.Free,zoomOnDoubleClick:Oe=!0,panOnDrag:ke=!0,onPaneClick:Ae,onPaneMouseEnter:je,onPaneMouseMove:Me,onPaneMouseLeave:Ne,onPaneScroll:Pe,onPaneContextMenu:Fe,children:Ie,onEdgeContextMenu:Le,onEdgeDoubleClick:Re,onEdgeMouseEnter:ze,onEdgeMouseMove:Be,onEdgeMouseLeave:U,onEdgeUpdate:Ve,onEdgeUpdateStart:He,onEdgeUpdateEnd:Ue,onReconnect:We,onReconnectStart:Ge,onReconnectEnd:Ke,reconnectRadius:qe=10,edgeUpdaterRadius:Je=10,onNodesChange:Ye,onEdgesChange:Xe,noDragClassName:Ze=`nodrag`,noWheelClassName:Qe=`nowheel`,noPanClassName:$e=`nopan`,fitView:et=!1,fitViewOptions:tt,connectOnClick:nt=!0,attributionPosition:rt,proOptions:it,defaultEdgeOptions:at,elevateNodesOnSelect:ot=!0,elevateEdgesOnSelect:st=!1,disableKeyboardA11y:W=!1,autoPanOnConnect:ct=!0,autoPanOnNodeDrag:lt=!0,connectionRadius:ut=20,isValidConnection:dt,onError:ft,style:pt,id:mt,nodeDragThreshold:ht,...gt},_t)=>{let G=mt||`1`;return H.createElement(`div`,{...gt,style:{...pt,...zS},ref:_t,className:Vf([`react-flow`,i]),"data-testid":`rf__wrapper`,id:mt},H.createElement(NS,null,H.createElement(OS,{onInit:l,onMove:u,onMoveStart:d,onMoveEnd:f,onNodeClick:s,onEdgeClick:c,onNodeMouseEnter:v,onNodeMouseMove:y,onNodeMouseLeave:b,onNodeContextMenu:x,onNodeDoubleClick:S,nodeTypes:a,edgeTypes:o,connectionLineType:I,connectionLineStyle:L,connectionLineComponent:R,connectionLineContainerStyle:ee,selectionKeyCode:ne,selectionOnDrag:re,selectionMode:ie,deleteKeyCode:te,multiSelectionKeyCode:oe,panActivationKeyCode:ae,zoomActivationKeyCode:z,onlyRenderVisibleElements:le,selectNodesOnDrag:B,defaultViewport:ge,translateExtent:ye,minZoom:_e,maxZoom:ve,preventScrolling:be,zoomOnScroll:Ce,zoomOnPinch:we,zoomOnDoubleClick:Oe,panOnScroll:Te,panOnScrollSpeed:Ee,panOnScrollMode:De,panOnDrag:ke,onPaneClick:Ae,onPaneMouseEnter:je,onPaneMouseMove:Me,onPaneMouseLeave:Ne,onPaneScroll:Pe,onPaneContextMenu:Fe,onSelectionContextMenu:M,onSelectionStart:N,onSelectionEnd:P,onEdgeContextMenu:Le,onEdgeDoubleClick:Re,onEdgeMouseEnter:ze,onEdgeMouseMove:Be,onEdgeMouseLeave:U,onReconnect:We??Ve,onReconnectStart:Ge??He,onReconnectEnd:Ke??Ue,reconnectRadius:qe??Je,defaultMarkerColor:Se,noDragClassName:Ze,noWheelClassName:Qe,noPanClassName:$e,elevateEdgesOnSelect:st,rfId:G,disableKeyboardA11y:W,nodeOrigin:V,nodeExtent:xe}),H.createElement(kb,{nodes:e,edges:t,defaultNodes:n,defaultEdges:r,onConnect:p,onConnectStart:m,onConnectEnd:h,onClickConnectStart:g,onClickConnectEnd:_,nodesDraggable:ue,nodesConnectable:de,nodesFocusable:fe,edgesFocusable:pe,edgesUpdatable:me,elementsSelectable:he,elevateNodesOnSelect:ot,minZoom:_e,maxZoom:ve,nodeExtent:xe,onNodesChange:Ye,onEdgesChange:Xe,snapToGrid:se,snapGrid:ce,connectionMode:F,translateExtent:ye,connectOnClick:nt,defaultEdgeOptions:at,fitView:et,fitViewOptions:tt,onNodesDelete:E,onEdgesDelete:D,onNodeDragStart:C,onNodeDrag:w,onNodeDragStop:T,onSelectionDrag:A,onSelectionDragStart:k,onSelectionDragStop:j,noPanClassName:$e,nodeOrigin:V,rfId:G,autoPanOnConnect:ct,autoPanOnNodeDrag:lt,onError:ft,connectionRadius:ut,isValidConnection:dt,nodeDragThreshold:ht}),H.createElement(Eb,{onSelectionChange:O}),Ie,H.createElement(Hv,{proOptions:it,position:rt}),H.createElement(Lb,{rfId:G,disableKeyboardA11y:W})))});BS.displayName=`ReactFlow`;var VS=({id:e,x:t,y:n,width:r,height:i,style:a,color:o,strokeColor:s,strokeWidth:c,className:l,borderRadius:u,shapeRendering:d,onClick:f,selected:p})=>{let{background:m,backgroundColor:h}=a||{},g=o||m||h;return H.createElement(`rect`,{className:Vf([`react-flow__minimap-node`,{selected:p},l]),x:t,y:n,rx:u,ry:u,width:r,height:i,fill:g,stroke:s,strokeWidth:c,shapeRendering:d,onClick:f?t=>f(t,e):void 0})};VS.displayName=`MiniMapNode`;var HS=(0,H.memo)(VS),US=e=>e.nodeOrigin,WS=e=>e.getNodes().filter(e=>!e.hidden&&e.width&&e.height),GS=e=>e instanceof Function?e:()=>e;function KS({nodeStrokeColor:e=`transparent`,nodeColor:t=`#e2e2e2`,nodeClassName:n=``,nodeBorderRadius:r=5,nodeStrokeWidth:i=2,nodeComponent:a=HS,onClick:o}){let s=X(WS,tp),c=X(US),l=GS(t),u=GS(e),d=GS(n),f=typeof window>`u`||window.chrome?`crispEdges`:`geometricPrecision`;return H.createElement(H.Fragment,null,s.map(e=>{let{x:t,y:n}=qy(e,c).positionAbsolute;return H.createElement(a,{key:e.id,x:t,y:n,width:e.width,height:e.height,style:e.style,selected:e.selected,className:d(e),color:l(e),borderRadius:r,strokeColor:u(e),strokeWidth:i,shapeRendering:f,onClick:o,id:e.id})}))}var qS=(0,H.memo)(KS),JS=200,YS=150,XS=e=>{let t=e.getNodes(),n={x:-e.transform[0]/e.transform[2],y:-e.transform[1]/e.transform[2],width:e.width/e.transform[2],height:e.height/e.transform[2]};return{viewBB:n,boundingRect:t.length>0?ey(Jy(t,e.nodeOrigin),n):n,rfId:e.rfId}},ZS=`react-flow__minimap-desc`;function QS({style:e,className:t,nodeStrokeColor:n=`transparent`,nodeColor:r=`#e2e2e2`,nodeClassName:i=``,nodeBorderRadius:a=5,nodeStrokeWidth:o=2,nodeComponent:s,maskColor:c=`rgb(240, 240, 240, 0.6)`,maskStrokeColor:l=`none`,maskStrokeWidth:u=1,position:d=`bottom-right`,onClick:f,onNodeClick:p,pannable:m=!1,zoomable:h=!1,ariaLabel:g=`React Flow mini map`,inversePan:_=!1,zoomStep:v=10,offsetScale:y=5}){let b=zv(),x=(0,H.useRef)(null),{boundingRect:S,viewBB:C,rfId:w}=X(XS,tp),T=e?.width??JS,E=e?.height??YS,D=S.width/T,O=S.height/E,k=Math.max(D,O),A=k*T,j=k*E,M=y*k,N=S.x-(A-S.width)/2-M,P=S.y-(j-S.height)/2-M,F=A+M*2,I=j+M*2,L=`${ZS}-${w}`,R=(0,H.useRef)(0);R.current=k,(0,H.useEffect)(()=>{if(x.current){let e=ch(x.current),t=Pv().on(`zoom`,m?e=>{let{transform:t,d3Selection:n,d3Zoom:r,translateExtent:i,width:a,height:o}=b.getState();if(e.sourceEvent.type!==`mousemove`||!n||!r)return;let s=R.current*Math.max(1,t[2])*(_?-1:1),c={x:t[0]-e.sourceEvent.movementX*s,y:t[1]-e.sourceEvent.movementY*s},l=[[0,0],[a,o]],u=wv.translate(c.x,c.y).scale(t[2]),d=r.constrain()(u,l,i);r.transform(n,d)}:null).on(`zoom.wheel`,h?e=>{let{transform:t,d3Selection:n,d3Zoom:r}=b.getState();if(e.sourceEvent.type!==`wheel`||!n||!r)return;let i=-e.sourceEvent.deltaY*(e.sourceEvent.deltaMode===1?.05:e.sourceEvent.deltaMode?1:.002)*v,a=t[2]*2**i;r.scaleTo(n,a)}:null);return e.call(t),()=>{e.on(`zoom`,null)}}},[m,h,_,v]);let ee=f?e=>{let t=uh(e);f(e,{x:t[0],y:t[1]})}:void 0,te=p?(e,t)=>{let n=b.getState().nodeInternals.get(t);p(e,n)}:void 0;return H.createElement(Vv,{position:d,style:e,className:Vf([`react-flow__minimap`,t]),"data-testid":`rf__minimap`},H.createElement(`svg`,{width:T,height:E,viewBox:`${N} ${P} ${F} ${I}`,role:`img`,"aria-labelledby":L,ref:x,onClick:ee},g&&H.createElement(`title`,{id:L},g),H.createElement(qS,{onClick:te,nodeColor:r,nodeStrokeColor:n,nodeBorderRadius:a,nodeClassName:i,nodeStrokeWidth:o,nodeComponent:s}),H.createElement(`path`,{className:`react-flow__minimap-mask`,d:`M${N-M},${P-M}h${F+M*2}v${I+M*2}h${-F-M*2}z
        M${C.x},${C.y}h${C.width}v${C.height}h${-C.width}z`,fill:c,fillRule:`evenodd`,stroke:l,strokeWidth:u,pointerEvents:`none`})))}QS.displayName=`MiniMap`;var $S=(0,H.memo)(QS);function eC(){return H.createElement(`svg`,{xmlns:`http://www.w3.org/2000/svg`,viewBox:`0 0 32 32`},H.createElement(`path`,{d:`M32 18.133H18.133V32h-4.266V18.133H0v-4.266h13.867V0h4.266v13.867H32z`}))}function tC(){return H.createElement(`svg`,{xmlns:`http://www.w3.org/2000/svg`,viewBox:`0 0 32 5`},H.createElement(`path`,{d:`M0 0h32v4.2H0z`}))}function nC(){return H.createElement(`svg`,{xmlns:`http://www.w3.org/2000/svg`,viewBox:`0 0 32 30`},H.createElement(`path`,{d:`M3.692 4.63c0-.53.4-.938.939-.938h5.215V0H4.708C2.13 0 0 2.054 0 4.63v5.216h3.692V4.631zM27.354 0h-5.2v3.692h5.17c.53 0 .984.4.984.939v5.215H32V4.631A4.624 4.624 0 0027.354 0zm.954 24.83c0 .532-.4.94-.939.94h-5.215v3.768h5.215c2.577 0 4.631-2.13 4.631-4.707v-5.139h-3.692v5.139zm-23.677.94c-.531 0-.939-.4-.939-.94v-5.138H0v5.139c0 2.577 2.13 4.707 4.708 4.707h5.138V25.77H4.631z`}))}function rC(){return H.createElement(`svg`,{xmlns:`http://www.w3.org/2000/svg`,viewBox:`0 0 25 32`},H.createElement(`path`,{d:`M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0 8 0 4.571 3.429 4.571 7.619v3.048H3.048A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047zm4.724-13.866H7.467V7.619c0-2.59 2.133-4.724 4.723-4.724 2.591 0 4.724 2.133 4.724 4.724v3.048z`}))}function iC(){return H.createElement(`svg`,{xmlns:`http://www.w3.org/2000/svg`,viewBox:`0 0 25 32`},H.createElement(`path`,{d:`M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0c-4.114 1.828-1.37 2.133.305 2.438 1.676.305 4.42 2.59 4.42 5.181v3.048H3.047A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047z`}))}var aC=({children:e,className:t,...n})=>H.createElement(`button`,{type:`button`,className:Vf([`react-flow__controls-button`,t]),...n},e);aC.displayName=`ControlButton`;var oC=e=>({isInteractive:e.nodesDraggable||e.nodesConnectable||e.elementsSelectable,minZoomReached:e.transform[2]<=e.minZoom,maxZoomReached:e.transform[2]>=e.maxZoom}),sC=({style:e,showZoom:t=!0,showFitView:n=!0,showInteractive:r=!0,fitViewOptions:i,onZoomIn:a,onZoomOut:o,onFitView:s,onInteractiveChange:c,className:l,children:u,position:d=`bottom-left`})=>{let f=zv(),[p,m]=(0,H.useState)(!1),{isInteractive:h,minZoomReached:g,maxZoomReached:_}=X(oC,tp),{zoomIn:v,zoomOut:y,fitView:b}=Qb();if((0,H.useEffect)(()=>{m(!0)},[]),!p)return null;let x=()=>{v(),a?.()},S=()=>{y(),o?.()},C=()=>{b(i),s?.()},w=()=>{f.setState({nodesDraggable:!h,nodesConnectable:!h,elementsSelectable:!h}),c?.(!h)};return H.createElement(Vv,{className:Vf([`react-flow__controls`,l]),position:d,style:e,"data-testid":`rf__controls`},t&&H.createElement(H.Fragment,null,H.createElement(aC,{onClick:x,className:`react-flow__controls-zoomin`,title:`zoom in`,"aria-label":`zoom in`,disabled:_},H.createElement(eC,null)),H.createElement(aC,{onClick:S,className:`react-flow__controls-zoomout`,title:`zoom out`,"aria-label":`zoom out`,disabled:g},H.createElement(tC,null))),n&&H.createElement(aC,{className:`react-flow__controls-fitview`,onClick:C,title:`fit view`,"aria-label":`fit view`},H.createElement(nC,null)),r&&H.createElement(aC,{className:`react-flow__controls-interactive`,onClick:w,title:`toggle interactivity`,"aria-label":`toggle interactivity`},h?H.createElement(iC,null):H.createElement(rC,null)),u)};sC.displayName=`Controls`;var cC=(0,H.memo)(sC),lC;(function(e){e.Lines=`lines`,e.Dots=`dots`,e.Cross=`cross`})(lC||={});function uC({color:e,dimensions:t,lineWidth:n}){return H.createElement(`path`,{stroke:e,strokeWidth:n,d:`M${t[0]/2} 0 V${t[1]} M0 ${t[1]/2} H${t[0]}`})}function dC({color:e,radius:t}){return H.createElement(`circle`,{cx:t,cy:t,r:t,fill:e})}var fC={[lC.Dots]:`#91919a`,[lC.Lines]:`#eee`,[lC.Cross]:`#e2e2e2`},pC={[lC.Dots]:1,[lC.Lines]:1,[lC.Cross]:6},mC=e=>({transform:e.transform,patternId:`pattern-${e.rfId}`});function hC({id:e,variant:t=lC.Dots,gap:n=20,size:r,lineWidth:i=1,offset:a=2,color:o,style:s,className:c}){let l=(0,H.useRef)(null),{transform:u,patternId:d}=X(mC,tp),f=o||fC[t],p=r||pC[t],m=t===lC.Dots,h=t===lC.Cross,g=Array.isArray(n)?n:[n,n],_=[g[0]*u[2]||1,g[1]*u[2]||1],v=p*u[2],y=h?[v,v]:_,b=m?[v/a,v/a]:[y[0]/a,y[1]/a];return H.createElement(`svg`,{className:Vf([`react-flow__background`,c]),style:{...s,position:`absolute`,width:`100%`,height:`100%`,top:0,left:0},ref:l,"data-testid":`rf__background`},H.createElement(`pattern`,{id:d+e,x:u[0]%_[0],y:u[1]%_[1],width:_[0],height:_[1],patternUnits:`userSpaceOnUse`,patternTransform:`translate(-${b[0]},-${b[1]})`},m?H.createElement(dC,{color:f,radius:v/a}):H.createElement(uC,{dimensions:y,color:f,lineWidth:i})),H.createElement(`rect`,{x:`0`,y:`0`,width:`100%`,height:`100%`,fill:`url(#${d+e})`}))}hC.displayName=`Background`;var gC=(0,H.memo)(hC);function _C({nodes:e,edges:t}){let n=(0,H.useMemo)(()=>t.map(e=>({...e,animated:e.data?.active===!0,style:e.data?.active===!1?{stroke:`#ccc`,strokeDasharray:`5,5`}:{stroke:`#333`}})),[t]);return(0,U.jsx)(`div`,{style:{width:`100%`,height:`100%`},children:(0,U.jsxs)(BS,{nodes:e,edges:n,fitView:!0,children:[(0,U.jsx)(gC,{}),(0,U.jsx)(cC,{}),(0,U.jsx)($S,{})]})})}function vC({nodes:e,edges:t}){return(0,U.jsxs)(p,{sx:{height:`100%`,p:2,display:`flex`,flexDirection:`column`},children:[(0,U.jsx)(a,{variant:`h6`,gutterBottom:!0,children:`生成フローチャート`}),(0,U.jsx)(MS,{children:(0,U.jsx)(_C,{nodes:e,edges:t})})]})}var yC=vC,bC=x((0,U.jsx)(`path`,{d:`M9.19 6.35c-2.04 2.29-3.44 5.58-3.57 5.89L2 10.69l4.05-4.05c.47-.47 1.15-.68 1.81-.55zM11.17 17s3.74-1.55 5.89-3.7c5.4-5.4 4.5-9.62 4.21-10.57-.95-.3-5.17-1.19-10.57 4.21C8.55 9.09 7 12.83 7 12.83zm6.48-2.19c-2.29 2.04-5.58 3.44-5.89 3.57L13.31 22l4.05-4.05c.47-.47.68-1.15.55-1.81zM9 18c0 .83-.34 1.58-.88 2.12C6.94 21.3 2 22 2 22s.7-4.94 1.88-6.12C4.42 15.34 5.17 15 6 15c1.66 0 3 1.34 3 3m4-9c0-1.1.9-2 2-2s2 .9 2 2-.9 2-2 2-2-.9-2-2`}),`RocketLaunch`);function xC({isActive:e,chatHistory:t,nodes:n,edges:r,onSendMessage:i,isWaitingForUserInput:o,isWaitingForAiResponse:s,onSave:c}){return e?(0,U.jsxs)(z,{sx:{height:`100%`,display:`flex`,gap:2},children:[(0,U.jsx)(z,{sx:{flex:`1 1 40%`,minWidth:400},children:(0,U.jsx)(Bf,{chatHistory:t,onSendMessage:i,isWaitingForUserInput:o,isWaitingForAiResponse:s})}),(0,U.jsxs)(z,{sx:{flex:`1 1 60%`,minWidth:500,display:`flex`,flexDirection:`column`,gap:2},children:[(0,U.jsx)(z,{sx:{flexGrow:1},children:(0,U.jsx)(yC,{nodes:n,edges:r})}),(0,U.jsx)(z,{sx:{textAlign:`right`},children:(0,U.jsx)(u,{variant:`contained`,onClick:c,disabled:n.length===0,children:`フローとして保存`})})]})]}):(0,U.jsxs)(p,{sx:{height:`100%`,display:`flex`,flexDirection:`column`,alignItems:`center`,justifyContent:`center`,p:3,gap:2,backgroundColor:`action.hover`},children:[(0,U.jsx)(bC,{sx:{fontSize:60,color:`text.secondary`}}),(0,U.jsx)(a,{variant:`h6`,color:`text.secondary`,children:`AIフロー設計を開始`}),(0,U.jsxs)(a,{color:`text.secondary`,align:`center`,children:[`左のパネルから「AIで新しいフローを設計」ボタンを押し、`,(0,U.jsx)(`br`,{}),`起点となる業務フェーズを選択してください。`]})]})}var SC=xC;function CC({open:e,onClose:n,phases:r,onSelect:i}){return(0,U.jsxs)(M,{open:e,onClose:n,children:[(0,U.jsx)(O,{children:`起点フェーズの選択`}),(0,U.jsxs)(D,{children:[(0,U.jsx)(a,{gutterBottom:!0,children:`これから作成するフローが、どの業務フェーズに主に関連しているかを選択してください。`}),(0,U.jsx)(m,{children:r.map(e=>(0,U.jsx)(t,{onClick:()=>i(e.id),children:(0,U.jsx)(F,{primary:e.name})},e.id))})]}),(0,U.jsx)(A,{children:(0,U.jsx)(u,{onClick:n,children:`キャンセル`})})]})}function wC(){let e=se(),[t,n]=(0,H.useState)(!1),[r,i]=(0,H.useState)(`knowledge`),{library:a}=Ne(e=>e.knowledge),[o,s]=(0,H.useState)([]),[c,l]=(0,H.useState)([]),[d,f]=(0,H.useState)([]),[p,m]=(0,H.useState)(!1),[h,g]=(0,H.useState)(!1),[_,v]=(0,H.useState)(!1),[x,S]=(0,H.useState)(``),[C,w]=(0,H.useState)(!1),[T,k]=(0,H.useState)(null),j=T!==null;(0,H.useEffect)(()=>{if(T&&o.length===0){let e=a.find(e=>e.id===T)?.name||`選択されたフェーズ`;s([{sender:`ai`,text:`こんにちは！「${e}」に関する業務フローを設計しますね。どのようなフローを作成しますか？`}]),l([]),f([]),m(!0),g(!1)}},[T,o.length,a]);let N=(0,H.useCallback)(e=>{for(let t of a){let n=(t.knowledges||[]).find(t=>t.id===e);if(n)return{knowledge:n,phaseId:t.id,phaseName:t.name};for(let n of t.subPhases||[]){let r=(n.knowledges||[]).find(t=>t.id===e);if(r)return{knowledge:r,phaseId:t.id,phaseName:t.name}}}return null},[a]),P=e=>{let t=a.find(e=>e.id===T);return`あなたは優秀な業務コンサルタントです。ユーザーの指示に基づき、提示された知識ライブラリの項目だけを使って対話的に業務フローを構築します。

# 知識ライブラリ (全フェーズ)
${JSON.stringify(a,null,2)}

# あなたの思考プロセス (このセクションを厳密に守ってください)
1.  **ユーザー指示の解釈**: ユーザーが何をしたいか分析する。どの知識項目(knowledgeId)について言及しているか特定する。
2.  **逸脱チェック**:
    a.  追加または言及された知識項目のIDを基に、それが属するフェーズを知識ライブラリから特定する。
    b.  現在の起点フェーズは「${t?.name}」(ID: ${t?.id}) である。
    c.  特定したタスクのフェーズは、起点フェーズと一致するか？
    d.  一致しない場合、これは「逸脱」である。応答には **必ず [WARNING] 接頭辞を付ける必要がある** と結論付ける。
3.  **アクションプラン**: 思考プロセスに基づき、フローチャートを更新するためのJSONアクション（ADD, DELETE, UPDATE）を計画する。
4.  **応答メッセージ作成**: 思考プロセスに基づき、ユーザーへの返答メッセージを作成する。逸脱チェックで警告が必要と判断した場合、必ずメッセージの先頭に [WARNING] を付ける。

# 逸脱に関する【最重要】ルール
- **逸脱の定義**: あなたが提案、またはユーザーの指示で追加するタスクが、思考プロセスで確認した結果、起点フェーズである「${t?.name}」に属していない場合は、すべて「逸脱」とみなします。例外はありません。
- **警告の義務**: あなたの提案が「逸脱」の定義に当てはまる場合、思考プロセスに従い、**必ず応答メッセージの先頭に [WARNING] という接頭辞を付けてください。**

# フローチャートのレイアウトに関するルール
- フローは上から下へ流れるように構築する。
- 新しいノードを追加する場合、接続元のノードよりもY座標が必ず大きくなるように position を設定する (例: y: 元のy + 80)。
- ノードが重ならないようにX座標を調整する。

# 現在のフローの状態
- ノード: ${JSON.stringify(c,null,2)}
- エッジ: ${JSON.stringify(d,null,2)}
- ユーザーの最新の指示: "${e}"

# 出力JSONフォーマット (思考プロセスに基づき、以下の形式で出力してください)
[
  {
    "action": "ADD" | "DELETE" | "UPDATE",
    "newNode": { "knowledgeId": "k-001", "position": { "x": 250, "y": 50 } },
    "newEdge": { "source": "k-001", "target": "k-002" },
    "deleteNodeId": "k-007",
    "updateEdge": { "source": "k-006", "target": "k-008" },
    "aiResponse": {
      "text": "ユーザーへの返答メッセージ",
      "options": [ { "label": "選択肢テキスト", "value": "choice_value" } ]
    }
  }
]
`},F=async e=>{let t={sender:`user`,text:e};s(e=>[...e,t]),m(!1),g(!0);try{let t=new E;if(!t.isAvailable)throw Error(`Gemini APIキーまたはモデルIDが設定されていません。`);let n=P(e),r=(await t.generateContent(n)).replace(/```json/g,``).replace(/```/g,``).trim(),i=JSON.parse(r),a=null;i.forEach(e=>{let{action:t,newNode:n,newEdge:r,deleteNodeId:i,updateEdge:o,aiResponse:s}=e;if(t===`DELETE`&&i&&(l(e=>e.filter(e=>e.id!==i)),f(e=>e.filter(e=>e.source!==i&&e.target!==i))),t===`UPDATE`&&o&&f(e=>e.map(e=>e.source===o.source||e.target===o.target?{...e,target:o.target}:e)),t===`ADD`){if(n&&n.knowledgeId){let e=N(n.knowledgeId);e&&l(t=>[...t,{id:e.knowledge.id,position:n.position,data:{label:e.knowledge.text}}])}r&&r.source&&r.target&&f(e=>[...e,{id:`e-${r.source}-${r.target}-${B()}`,source:r.source,target:r.target,animated:!0}])}s&&(a={sender:`ai`,...s})}),a&&s(e=>[...e,a])}catch(e){console.error(`AI response handling failed:`,e);let t={sender:`ai`,text:`エラーが発生しました: ${e.message}`};s(e=>[...e,t])}finally{m(!0),g(!1)}},I=()=>{if(!x.trim()){alert(`フロー名を入力してください。`);return}let t=c.map(e=>{let t=N(e.id),n=t?t.knowledge:null;return{id:B(),text:n?.text||`不明なタスク`,details:n?.details||``,refId:n?.id,type:n?.type||`task`,options:n?.options||[],completed:!1,memo:``}}),n={id:`flow-${B()}`,name:x,description:`AIチャット設計機能で作成されました。`,tasks:t};e(de(n)),alert(`新しいフロー「${x}」を保存しました。`),v(!1),S(``)},L=(e,t)=>{t!==null&&i(t)},R=()=>{w(!0)},ee=e=>{k(e),s([]),l([]),f([]),w(!1)};return(0,U.jsxs)(z,{sx:{display:`flex`,flexDirection:`column`,height:`100vh`,bgcolor:`background.default`},children:[(0,U.jsx)(z,{sx:{p:`0 24px`},children:(0,U.jsx)(b,{isLocked:!1})}),(0,U.jsx)(z,{sx:{display:`flex`,justifyContent:`center`,p:`0 24px 16px`},children:(0,U.jsxs)(ut,{value:r,exclusive:!0,onChange:L,"aria-label":`designer mode`,children:[(0,U.jsxs)(ot,{value:`knowledge`,"aria-label":`knowledge editing mode`,children:[(0,U.jsx)(gf,{sx:{mr:1}}),`知識編集`]}),(0,U.jsxs)(ot,{value:`flow-management`,"aria-label":`flow management mode`,children:[(0,U.jsx)(_f,{sx:{mr:1}}),`フロー編集`]}),(0,U.jsxs)(ot,{value:`rule-editing`,"aria-label":`rule editing mode`,children:[(0,U.jsx)(vf,{sx:{mr:1}}),`ルール編集`]})]})}),r===`knowledge`&&(0,U.jsx)(cr,{backend:hf,children:(0,U.jsxs)(z,{sx:{flexGrow:1,p:`0 24px 24px 24px`,display:`flex`,gap:2,minHeight:0},children:[(0,U.jsx)(z,{sx:{flex:`0 1 320px`,minWidth:280},children:(0,U.jsx)(ni,{})}),(0,U.jsx)(z,{sx:{flex:`1 1 40%`,minWidth:300},children:(0,U.jsx)(oi,{onOpenAiModal:()=>n(!0)})}),(0,U.jsx)(z,{sx:{flex:`1 1 60%`,minWidth:400},children:(0,U.jsx)(li,{})})]})}),r===`flow-management`&&(0,U.jsx)(cr,{backend:hf,children:(0,U.jsxs)(z,{sx:{flexGrow:1,p:`0 24px 24px 24px`,display:`flex`,gap:2,minHeight:0},children:[(0,U.jsx)(z,{sx:{flex:`0 1 400px`,minWidth:320},children:(0,U.jsx)(Mf,{onStartAiDesign:R})}),(0,U.jsx)(z,{sx:{flex:`1 1 60%`,minWidth:500},children:(0,U.jsx)(SC,{isActive:j,chatHistory:o,nodes:c,edges:d,onSendMessage:F,isWaitingForUserInput:p,isWaitingForAiResponse:h,onSave:()=>v(!0)})})]})}),r===`rule-editing`&&(0,U.jsx)(z,{sx:{flexGrow:1,p:`0 24px 24px 24px`,minHeight:0},children:(0,U.jsx)(Cf,{})}),(0,U.jsx)(zd,{open:t,onClose:()=>n(!1)}),(0,U.jsxs)(M,{open:_,onClose:()=>v(!1),children:[(0,U.jsx)(O,{children:`新しいフローとして保存`}),(0,U.jsx)(D,{children:(0,U.jsx)(y,{autoFocus:!0,margin:`dense`,label:`フロー名`,type:`text`,fullWidth:!0,variant:`standard`,value:x,onChange:e=>S(e.target.value)})}),(0,U.jsxs)(A,{children:[(0,U.jsx)(u,{onClick:()=>v(!1),children:`キャンセル`}),(0,U.jsx)(u,{onClick:I,children:`保存`})]})]}),(0,U.jsx)(CC,{open:C,onClose:()=>w(!1),phases:a.filter(e=>e.subPhases.length>0||e.knowledges&&e.knowledges.length>0),onSelect:ee})]})}var TC=wC;export{TC as default};