<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>インタラクティブ・メッシュ化＆法線計算ツール</title>
    <style>
        body { margin: 0; font-family: sans-serif; }
        canvas { display: block; }
        #ui { position: absolute; top: 10px; left: 10px; z-index: 10; background: rgba(0,0,0,0.7); padding: 10px; color: white; border-radius: 5px; max-width: 300px; font-size: 14px; }
        input[type="range"] { vertical-align: middle; width: 120px;}
        label { display: inline-block; width: 130px; }
        h4 { margin-top: 15px; margin-bottom: 5px; }
        button { width: 100%; padding: 8px; margin-bottom: 10px; }
        button:disabled { background: #555; color: #999; }
    </style>
</head>
<body>
    <div id="ui">
        <h3>インタラクティブ・ツール</h3>
        <p style="font-size: 12px;">見たい場所にカメラを近づけて、各ボタンを押してください。</p>
        
        <hr>
        <h4>ステップ1：法線計算</h4>
        <button id="calculateNormalsButton">法線ベクトルを計算</button>
        <div>
            <label for="kValue">近傍点の数 (k):</label>
            <input type="range" id="kValue" min="3" max="50" value="20">
            <span id="kValueSpan">20</span>
        </div>
         <div>
            <label for="normalLength">法線表示長:</label>
            <input type="range" id="normalLength" min="0.1" max="10" value="2.5" step="0.1">
            <span id="normalLengthSpan">2.5</span>
        </div>
        
        <hr>
        <h4>ステップ2：ポアソン法メッシュ化</h4>
        <p style-="font-size: 12px;">事前にステップ1の法線計算が必要です。</p>
        <button id="poissonReconButton">本物のポアソン法でメッシュ化</button>
        <div>
            <label for="poissonDepth">オクツリー深度:</label>
            <input type="range" id="poissonDepth" min="5" max="10" value="8">
            <span id="poissonDepthSpan">8</span>
        </div>
        <div>
            <label for="poissonSamples">Samples/Node:</label>
            <input type="range" id="poissonSamples" min="1.0" max="30.0" value="1.0" step="0.5">
            <span id="poissonSamplesSpan">1.0</span>
        </div>
        <div>
            <label for="poissonScale">スケール係数:</label>
            <input type="range" id="poissonScale" min="1.0" max="1.5" value="1.1" step="0.01">
            <span id="poissonScaleSpan">1.1</span>
        </div>


        <hr>
        <div id="status" style="margin-top: 5px;">まず点群を読み込んでください...</div>
    </div>

    <script type="importmap">{ "imports": { "three": "https://cdn.jsdelivr.net/npm/three@0.164.1/build/three.module.js", "three/addons/": "https://cdn.jsdelivr.net/npm/three@0.164.1/examples/jsm/" } }</script>
    <script type="module" src="main.js"></script>
</body>
</html>